<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hpstr: processors/src/SimpZBiOptimizationProcessor.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hpstr
   </div>
   <div id="projectbrief">The Heavy Photon Search Toolkit for Reconstruction (hpstr) provides an interface to physics data from the HPS experiment saved in the LCIO format and converts it into an ROOT based format.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4ac0cf52b60bedb296701740c5b274e6.html">processors</a></li><li class="navelem"><a class="el" href="dir_f51cfae32239c0a2b15b7972d5cbb270.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SimpZBiOptimizationProcessor.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="SimpZBiOptimizationProcessor_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SimpZBiOptimizationProcessor_8h.html">SimpZBiOptimizationProcessor.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#ad6d310aa59d62027cf6d383fe87cf5f9">    7</a></span>&#160;<a class="code" href="classSimpZBiOptimizationProcessor.html#ad6d310aa59d62027cf6d383fe87cf5f9">SimpZBiOptimizationProcessor::SimpZBiOptimizationProcessor</a>(<span class="keyword">const</span> std::string&amp; name, <a class="code" href="classProcess.html">Process</a>&amp; process) </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    : <a class="code" href="classProcessor.html">Processor</a>(name,process) {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimizationProcessor] Constructor()&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;}</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#abfd55164b50d9022f72c47def5b9d378">   12</a></span>&#160;<a class="code" href="classSimpZBiOptimizationProcessor.html#abfd55164b50d9022f72c47def5b9d378">SimpZBiOptimizationProcessor::~SimpZBiOptimizationProcessor</a>(){}</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a28936b5e7dad5cac4572c2e47464519e">   14</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a28936b5e7dad5cac4572c2e47464519e">SimpZBiOptimizationProcessor::configure</a>(<span class="keyword">const</span> <a class="code" href="classParameterSet.html">ParameterSet</a>&amp; <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>) {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimizationProcessor] configure()&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordflow">try</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="comment">//Basic config</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getInteger(<span class="stringliteral">&quot;debug&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac6922f4d6dc9a356c2d0debea6bbd3ac">max_iteration_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getInteger(<span class="stringliteral">&quot;max_iteration&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#ac6922f4d6dc9a356c2d0debea6bbd3ac">max_iteration_</a>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a82a5ab7d19b7efc405000d51884d1e42">year_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getInteger(<span class="stringliteral">&quot;year&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#a82a5ab7d19b7efc405000d51884d1e42">year_</a>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#aa248deec58b67ef14faaa8087971e5f1">cuts_cfgFile_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;cuts_cfgFile&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#aa248deec58b67ef14faaa8087971e5f1">cuts_cfgFile_</a>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a5bf2d69e69ecf1823e89035105473dc4">outFileName_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;outFileName&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#a5bf2d69e69ecf1823e89035105473dc4">outFileName_</a>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a32090166ec7f47f8e0d14ade88428e98">cutVariables_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getVString(<span class="stringliteral">&quot;cutVariables&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a32090166ec7f47f8e0d14ade88428e98">cutVariables_</a>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ab5a708fd4312459a5d0742422759f4fa">min_ztail_events_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getDouble(<span class="stringliteral">&quot;ztail_events&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#ab5a708fd4312459a5d0742422759f4fa">min_ztail_events_</a>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ae87886ccab8983b4838ee892fa4c210b">scan_zcut_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getInteger(<span class="stringliteral">&quot;scan_zcut&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#ae87886ccab8983b4838ee892fa4c210b">scan_zcut_</a>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#adb1b8473d77d4172c13e742844431f64">step_size_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getDouble(<span class="stringliteral">&quot;step_size&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#adb1b8473d77d4172c13e742844431f64">step_size_</a>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a506b1e98594ce7268efc8551dd54dd61">eq_cfgFile_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;eq_cfgFile&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a506b1e98594ce7268efc8551dd54dd61">eq_cfgFile_</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <span class="comment">//Background</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ad8a64f94c00543cfde1e12e264da2fe0">bkgVtxAnaFilename_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;bkgVtxAnaFilename&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#ad8a64f94c00543cfde1e12e264da2fe0">bkgVtxAnaFilename_</a>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a5e954bf07ab1dac5ff7249cebb094545">bkgVtxAnaTreename_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;bkgVtxAnaTreename&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#a5e954bf07ab1dac5ff7249cebb094545">bkgVtxAnaTreename_</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a8079093abe734825b55fcd9dc4dae32a">background_sf_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getDouble(<span class="stringliteral">&quot;background_sf&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#a8079093abe734825b55fcd9dc4dae32a">background_sf_</a>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="comment">//MC Signal</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a15bf37530b47266a0fb5550fb2c88e4e">variableHistCfgFilename_</a> = </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;variableHistCfgFilename&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#a15bf37530b47266a0fb5550fb2c88e4e">variableHistCfgFilename_</a>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a1a29d28b4ccc338b9704942daaebcd6a">signalVtxAnaFilename_</a> = </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;signalVtxAnaFilename&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a1a29d28b4ccc338b9704942daaebcd6a">signalVtxAnaFilename_</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a436b3ef210248ba342a89f10c9aa8b85">signalVtxAnaTreename_</a> = </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;signalVtxAnaTreename&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#a436b3ef210248ba342a89f10c9aa8b85">signalVtxAnaTreename_</a>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a171c1df7d8feb12db465a1fc755cc614">signalVtxMCSelection_</a> = </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;signalVtxMCSelection&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#a171c1df7d8feb12db465a1fc755cc614">signalVtxMCSelection_</a>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ae93f9b7cf124010367eeb7c94fa507c8">signalMCAnaFilename_</a> =</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;signalMCAnaFilename&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#ae93f9b7cf124010367eeb7c94fa507c8">signalMCAnaFilename_</a>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ace5518f052257b18d5fa89e271d18d0f">signal_pdgid_</a> =</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;signal_pdgid&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#ace5518f052257b18d5fa89e271d18d0f">signal_pdgid_</a>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#af8cf29d3d98b60a30ad1441665e1d22e">signal_sf_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getDouble(<span class="stringliteral">&quot;signal_sf&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#af8cf29d3d98b60a30ad1441665e1d22e">signal_sf_</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a436e1589148888d95fb9a2d1b34d09f3">signal_mass_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getDouble(<span class="stringliteral">&quot;signal_mass&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#a436e1589148888d95fb9a2d1b34d09f3">signal_mass_</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ab23bbfae6194a28cace72f874a461d92">mass_window_nsigma_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getDouble(<span class="stringliteral">&quot;mass_window_nsigma&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#ab23bbfae6194a28cace72f874a461d92">mass_window_nsigma_</a>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a1185bf9f80b6a16684fad9dec253bb97">logEps2_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getDouble(<span class="stringliteral">&quot;logEps2&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#a1185bf9f80b6a16684fad9dec253bb97">logEps2_</a>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="comment">//Expected Signal Calculation</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#aa5ccc69ab0b3fe24b4bcc920c703fbc2">radFrac_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getDouble(<span class="stringliteral">&quot;radFrac&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#aa5ccc69ab0b3fe24b4bcc920c703fbc2">radFrac_</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a9784b8ec5cfe672496b1ef31973cfbad">radAcc_</a>  = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getDouble(<span class="stringliteral">&quot;radAcc&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a9784b8ec5cfe672496b1ef31973cfbad">radAcc_</a>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#abbd9e048651de8fcd4020e5d03504fa5">bkgControlRegionFilename_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;bkgControlRegionFilename&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#abbd9e048651de8fcd4020e5d03504fa5">bkgControlRegionFilename_</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#aee57f0c2237e29a1579d7b8bef83a083">bkgControlRegionTreename_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getString(<span class="stringliteral">&quot;bkgControlRegionTreename&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#aee57f0c2237e29a1579d7b8bef83a083">bkgControlRegionTreename_</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a8faef2f19bcc75ff9144a8b453b47f6d">dNdm_sf_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getDouble(<span class="stringliteral">&quot;dNdm_sf&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a8faef2f19bcc75ff9144a8b453b47f6d">dNdm_sf_</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="comment">// New Variables //</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a3878c7905bab66dc93e8b7fb78ce82d1">new_variables_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getVString(<span class="stringliteral">&quot;add_new_variables&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a3878c7905bab66dc93e8b7fb78ce82d1">new_variables_</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a179ff262182aa5a0e2dd800a8f5b1252">new_variable_params_</a> = <a class="code" href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">parameters</a>.getVDouble(<span class="stringliteral">&quot;new_variable_params&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a179ff262182aa5a0e2dd800a8f5b1252">new_variable_params_</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">catch</span> (std::runtime_error&amp; error)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        std::cout &lt;&lt; error.what() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//USE JSON FILE TO LOAD IN NEW VARIABLES AND VARIABLE CONFIGURATIONS</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#abca87f02b9f2b4f64f3fdc89bb19a8df">   72</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#abca87f02b9f2b4f64f3fdc89bb19a8df">SimpZBiOptimizationProcessor::addNewVariables</a>(<a class="code" href="classSimpAnaTTree.html">SimpAnaTTree</a>* MTT, std::string variable, <span class="keywordtype">double</span> param){</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimizationProcessor]::addNewVariable &quot;</span> &lt;&lt; variable &lt;&lt; <span class="stringliteral">&quot; with param &quot;</span> &lt;&lt; param &lt;&lt; std::endl;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_ele_zalpha&quot;</span>)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#af90b71211720da23ba31839696711df5">addVariable_unc_vtx_ele_zalpha</a>(param);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_pos_zalpha&quot;</span>)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#a20ec2f6d9613eea61813b6990a55f14f">addVariable_unc_vtx_pos_zalpha</a>(param);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_zalpha_max&quot;</span>)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#a4eb93d6fd05fa70212d84b64e3d643af">addVariable_unc_vtx_zalpha_max</a>(param);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_zalpha_min&quot;</span>)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#ae311034a97a87207df0c05454fa65611">addVariable_unc_vtx_zalpha_min</a>(param);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_ele_iso_z0err&quot;</span>)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#a49733965e63f799eb184f9633b2dc95a">addVariable_unc_vtx_ele_iso_z0err</a>();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_pos_iso_z0err&quot;</span>)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#aa4755add627dc1238159181320cfa05c">addVariable_unc_vtx_pos_iso_z0err</a>();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_ele_z0_z0err&quot;</span>)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#a901ec6e3cf4bdb97b6f278f14a44cb39">addVariable_unc_vtx_ele_z0_z0err</a>();</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_pos_z0_z0err&quot;</span>)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#afe53c4f505de4a21ab484cdacedcba53">addVariable_unc_vtx_pos_z0_z0err</a>();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_ele_isolation_cut&quot;</span>)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#aaf705bf77c39587413965b88c6f7bf43">addVariable_unc_vtx_ele_isolation_cut</a>();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_pos_isolation_cut&quot;</span>)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#a4c3e926be46b1de321930ffc2ce249be">addVariable_unc_vtx_pos_isolation_cut</a>();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_ele_z0tanlambda&quot;</span>)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#af0485e2808affe748593907995f62a0a">addVariable_unc_vtx_ele_z0tanlambda</a>();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_pos_z0tanlambda&quot;</span>)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#a8ad87e6c5766122743a6e95898e3cfec">addVariable_unc_vtx_pos_z0tanlambda</a>();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_ele_z0tanlambda_right&quot;</span>)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#aa5c91f060dd3885b94274dbacabdda50">addVariable_unc_vtx_ele_z0tanlambda_right</a>(param);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_pos_z0tanlambda_right&quot;</span>)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#a24e8fef4da40fc1225503d83516e227c">addVariable_unc_vtx_pos_z0tanlambda_right</a>(param);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_ele_z0tanlambda_left&quot;</span>)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#a6aa09f4d5abc140506bb017851c81d06">addVariable_unc_vtx_ele_z0tanlambda_left</a>(param);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_pos_z0tanlambda_left&quot;</span>)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#a65953f4dab0887a65cfc68a5c83c0829">addVariable_unc_vtx_pos_z0tanlambda_left</a>(param);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span>(variable == <span class="stringliteral">&quot;unc_vtx_abs_delta_z0tanlambda&quot;</span>)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        MTT-&gt;<a class="code" href="classSimpAnaTTree.html#ac42f15abcf060833c7b5fde13c162427">addVariable_unc_vtx_abs_delta_z0tanlambda</a>();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">//if(variable == &quot;unc_vtx_proj_significance&quot;)</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">//    MTT-&gt;addVariable_unc_vtx_proj_significance();</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">//else</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">//    std::cout &lt;&lt; &quot;[SimpZBiOptimization]::ERROR::NEW VARIABLE &quot; &lt;&lt; variable &lt;&lt; &quot; IS NOT DEFINED IN SimpAnaTTree.cxx&quot;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">//        &lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a222ffe169dde2cbf566830b296adc5ab">  126</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a222ffe169dde2cbf566830b296adc5ab">SimpZBiOptimizationProcessor::fillEventHistograms</a>(std::shared_ptr&lt;ZBiHistos&gt; histos, <a class="code" href="classSimpAnaTTree.html">SimpAnaTTree</a>* MTT){</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">//histos-&gt;Fill histograms for each variable defined in tree</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    std::vector&lt;std::string&gt; variables = MTT-&gt;<a class="code" href="classMutableTTree.html#a4f8583d3b7c681559a50353e2cd67968">getAllVariables</a>();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">for</span>(std::vector&lt;std::string&gt;::iterator it=variables.begin(); it != variables.end(); it++) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        std::string var = *it;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        histos-&gt;Fill1DHisto(var+<span class="stringliteral">&quot;_h&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(var));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">//Impact Parameter</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;z0_v_recon_z_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_z0&quot;</span>));</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;z0_v_recon_z_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_z0&quot;</span>));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">//Inv mass</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;vtx_InvM_vtx_z_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_mass&quot;</span>)*1000.0, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">//track z0</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;ele_track_z0_v_pos_track_z0_hh&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_z0&quot;</span>), </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_z0&quot;</span>));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">//Zalpha</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span>(MTT-&gt;<a class="code" href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">variableExists</a>(<span class="stringliteral">&quot;unc_vtx_ele_zalpha&quot;</span>)){</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;z0_v_unc_vtx_zalpha_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_zalpha&quot;</span>),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_z0&quot;</span>));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span>(MTT-&gt;<a class="code" href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">variableExists</a>(<span class="stringliteral">&quot;unc_vtx_pos_zalpha&quot;</span>)){</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;z0_v_unc_vtx_zalpha_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_zalpha&quot;</span>),</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_z0&quot;</span>));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span>(MTT-&gt;<a class="code" href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">variableExists</a>(<span class="stringliteral">&quot;unc_vtx_zalpha_max&quot;</span>)){</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_unc_vtx_zalpha_max_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_zalpha_max&quot;</span>),</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">//v0 projection</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span>(MTT-&gt;<a class="code" href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">variableExists</a>(<span class="stringliteral">&quot;unc_vtx_proj_x&quot;</span>)){</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;unc_vtx_proj_x_v_unc_vtx_proj_y_hh&quot;</span>, </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_proj_x&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_proj_y&quot;</span>));</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span>(MTT-&gt;<a class="code" href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">variableExists</a>(<span class="stringliteral">&quot;unc_vtx_proj_x_sig&quot;</span>)){</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;unc_vtx_proj_x_y_significance_hh&quot;</span>, </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_proj_x_sig&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_proj_y_sig&quot;</span>));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">if</span>(MTT-&gt;<a class="code" href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">variableExists</a>(<span class="stringliteral">&quot;unc_vtx_proj_sig&quot;</span>)){</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_proj_sig_hh&quot;</span>, </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_proj_sig&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">//Vertex Errors</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span>(MTT-&gt;<a class="code" href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">variableExists</a>(<span class="stringliteral">&quot;unc_vtx_cxx&quot;</span>)){</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_cxx_hh&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_cxx&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_cyy_hh&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_cyy&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_czz_hh&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_czz&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_czx_hh&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_czx&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_czy_hh&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_czy&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_cyx_hh&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_cyx&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">//Z0TanLambda</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_z0tanlambda_hh&quot;</span>, </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_z0&quot;</span>)/MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_tanLambda&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_z0tanlambda_hh&quot;</span>,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_z0&quot;</span>)/MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_tanLambda&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span>(MTT-&gt;<a class="code" href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">variableExists</a>(<span class="stringliteral">&quot;unc_vtx_deltaZ&quot;</span>)){</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_unc_vtx_deltaZ_hh&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_deltaZ&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">//z0 error</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_Z0err_hh&quot;</span>, </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_z0Err&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_Z0err_hh&quot;</span>, </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_z0Err&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//track time</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_track_t_hh&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_t&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_track_t_hh&quot;</span>, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_t&quot;</span>),MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">//Track parameters</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_ele_track_d0_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_d0&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_pos_track_d0_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_d0&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_ele_track_phi0_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_phi0&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_pos_track_phi0_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_phi0&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_ele_track_px_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_px&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_pos_track_px_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_px&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_ele_track_py_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_py&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_pos_track_py_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_py&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_ele_track_pz_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_pz&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_pos_track_pz_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_pz&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_ele_track_nhits_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_nhits&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;recon_z_v_pos_track_nhits_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_nhits&quot;</span>), MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">//track params vs params</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;ele_tanlambda_vs_phi0_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_phi0&quot;</span>),</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_tanLambda&quot;</span>));</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;pos_tanlambda_vs_phi0_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_phi0&quot;</span>),</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_tanLambda&quot;</span>));</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;ele_cluster_energy_v_track_p_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_p&quot;</span>),</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_clust_E&quot;</span>));</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;pos_cluster_energy_v_track_p_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_p&quot;</span>),</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_clust_E&quot;</span>));</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;ele_z0_vs_tanlambda_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_tanLambda&quot;</span>),</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_z0&quot;</span>));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    histos-&gt;Fill2DHisto(<span class="stringliteral">&quot;pos_z0_vs_tanlambda_hh&quot;</span>,MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_tanLambda&quot;</span>),</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_z0&quot;</span>));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a2c45220d6b9f66a6547795231bcc7828">  229</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a2c45220d6b9f66a6547795231bcc7828">SimpZBiOptimizationProcessor::countControlRegionBackgroundRate</a>(std::string <a class="code" href="namespaceconfig_1_1anaTrackHits__cfg.html#a284eaa73fc00d296c01f7af1d7b36ad6">inFilename</a>, std::string tree_name, </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="namespaceconfig_1_1simp__zbi__config.html#a5acc9840ebad7cf498e568185d30badc">m_Ap</a>, <span class="keywordtype">double</span> Mbin, <span class="keywordtype">double</span> dNdm_sf){</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordtype">double</span> dNdm = 0.0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    TFile inFile(<a class="code" href="namespaceconfig_1_1anaTrackHits__cfg.html#a284eaa73fc00d296c01f7af1d7b36ad6">inFilename</a>.c_str(), <span class="stringliteral">&quot;READ&quot;</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    TTree* tree = (TTree*)inFile.Get((tree_name+<span class="stringliteral">&quot;/&quot;</span>+tree_name+<span class="stringliteral">&quot;_tree&quot;</span>).c_str());</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">double</span> mass;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Counting: Ap mass is &quot;</span> &lt;&lt; <a class="code" href="namespaceconfig_1_1simp__zbi__config.html#a5acc9840ebad7cf498e568185d30badc">m_Ap</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    tree-&gt;SetBranchAddress(<span class="stringliteral">&quot;unc_vtx_mass&quot;</span>, &amp;mass);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;N entries: &quot;</span> &lt;&lt; tree-&gt;GetEntries() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e=0; e &lt; tree-&gt;GetEntries(); e++){</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        tree-&gt;GetEntry(e);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span>(mass*1000.0 &gt; <a class="code" href="namespaceconfig_1_1simp__zbi__config.html#a5acc9840ebad7cf498e568185d30badc">m_Ap</a> + (Mbin/2)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">if</span>(mass*1000.0 &lt; <a class="code" href="namespaceconfig_1_1simp__zbi__config.html#a5acc9840ebad7cf498e568185d30badc">m_Ap</a> - (Mbin/2)) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        dNdm = dNdm + 1.0;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    dNdm = dNdm/Mbin;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    dNdm = dNdm * dNdm_sf;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Background Rate in CR: &quot;</span> &lt;&lt; dNdm &lt;&lt; std::endl;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    inFile.Close();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">return</span> dNdm;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a94540e3f2addf6fb83cff5204c75dc52">  252</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a302363129fdcaea35ea923d7a674f196">SimpZBiOptimizationProcessor::initialize</a>(std::string <a class="code" href="namespaceconfig_1_1anaTrackHits__cfg.html#a284eaa73fc00d296c01f7af1d7b36ad6">inFilename</a>, std::string <a class="code" href="namespaceconfig_1_1anaTrackHits__cfg.html#a920b99d304bd717f4197afc33496f978">outFilename</a>){</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimizationProcessor] Initialize &quot;</span> &lt;&lt; <a class="code" href="namespaceconfig_1_1anaTrackHits__cfg.html#a284eaa73fc00d296c01f7af1d7b36ad6">inFilename</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">//Load Simp Equations</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ad5f8f268208e6faa808723fa680f5a7f">simpEqs_</a> = <span class="keyword">new</span> <a class="code" href="classSimpEquations.html">SimpEquations</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a82a5ab7d19b7efc405000d51884d1e42">year_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a506b1e98594ce7268efc8551dd54dd61">eq_cfgFile_</a>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#aa5ebedab715596f9cc1529bab0b9209e">massResolution_</a> = <a class="code" href="classSimpZBiOptimizationProcessor.html#ad5f8f268208e6faa808723fa680f5a7f">simpEqs_</a>-&gt;<a class="code" href="classSimpEquations.html#ae61345adc053e0f73d17d907b341de95">massResolution</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a436e1589148888d95fb9a2d1b34d09f3">signal_mass_</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">//Define Mass window</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ad6b8b2cbeed86c3fa2425467a2eef5fa">lowMass_</a> = <a class="code" href="classSimpZBiOptimizationProcessor.html#a436e1589148888d95fb9a2d1b34d09f3">signal_mass_</a> - <a class="code" href="classSimpZBiOptimizationProcessor.html#ab23bbfae6194a28cace72f874a461d92">mass_window_nsigma_</a>*<a class="code" href="classSimpZBiOptimizationProcessor.html#aa5ebedab715596f9cc1529bab0b9209e">massResolution_</a>/2.0;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#adc82ce333c65afb1a08e72cf329a3ad3">highMass_</a> = <a class="code" href="classSimpZBiOptimizationProcessor.html#a436e1589148888d95fb9a2d1b34d09f3">signal_mass_</a> + <a class="code" href="classSimpZBiOptimizationProcessor.html#ab23bbfae6194a28cace72f874a461d92">mass_window_nsigma_</a>*<a class="code" href="classSimpZBiOptimizationProcessor.html#aa5ebedab715596f9cc1529bab0b9209e">massResolution_</a>/2.0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Mass Window: &quot;</span> &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#ad6b8b2cbeed86c3fa2425467a2eef5fa">lowMass_</a> &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#adc82ce333c65afb1a08e72cf329a3ad3">highMass_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">//Initialize output file</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Output File: &quot;</span> &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#a5bf2d69e69ecf1823e89035105473dc4">outFileName_</a>.c_str() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a> = <span class="keyword">new</span> TFile(<a class="code" href="classSimpZBiOptimizationProcessor.html#a5bf2d69e69ecf1823e89035105473dc4">outFileName_</a>.c_str(),<span class="stringliteral">&quot;RECREATE&quot;</span>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">//Get the signal pretrigger simulated vertex z distribution</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Getting MC Signal pre-trigger vertex z distribution from file &quot;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#ae93f9b7cf124010367eeb7c94fa507c8">signalMCAnaFilename_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a2d0f7e5040c8afbb25bc6e5f7e55fd83">getSignalMCAnaVtxZ_h</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#ae93f9b7cf124010367eeb7c94fa507c8">signalMCAnaFilename_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#ace5518f052257b18d5fa89e271d18d0f">signal_pdgid_</a>); </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>-&gt;cd();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#adefbf2faf781dbb0f77a9170b1dc353b">signalSimZ_h_</a>-&gt;Write();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">//Read signal ana vertex tuple, and convert to mutable tuple</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Reading Signal AnaVertex Tuple from file &quot;</span> </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#a1a29d28b4ccc338b9704942daaebcd6a">signalVtxAnaFilename_</a>.c_str() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    TFile* signalVtxAnaFile = <span class="keyword">new</span> TFile(<a class="code" href="classSimpZBiOptimizationProcessor.html#a1a29d28b4ccc338b9704942daaebcd6a">signalVtxAnaFilename_</a>.c_str(),<span class="stringliteral">&quot;READ&quot;</span>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a> = <span class="keyword">new</span> <a class="code" href="classSimpAnaTTree.html">SimpAnaTTree</a>(signalVtxAnaFile,(<a class="code" href="classSimpZBiOptimizationProcessor.html#a436b3ef210248ba342a89f10c9aa8b85">signalVtxAnaTreename_</a>+<span class="stringliteral">&quot;/&quot;</span>+<a class="code" href="classSimpZBiOptimizationProcessor.html#a436b3ef210248ba342a89f10c9aa8b85">signalVtxAnaTreename_</a>+<span class="stringliteral">&quot;_tree&quot;</span>).c_str());</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a125ca3dc2bb650b998b2f8092c234013">defineMassWindow</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#ad6b8b2cbeed86c3fa2425467a2eef5fa">lowMass_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#adc82ce333c65afb1a08e72cf329a3ad3">highMass_</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">//Get Simp Mean Truth Energy</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Get Mean Truth Energy&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    TH1F* signalEnergy_h = (TH1F*)signalVtxAnaFile-&gt;Get((<a class="code" href="classSimpZBiOptimizationProcessor.html#a171c1df7d8feb12db465a1fc755cc614">signalVtxMCSelection_</a>+<span class="stringliteral">&quot;/&quot;</span>+<a class="code" href="classSimpZBiOptimizationProcessor.html#a171c1df7d8feb12db465a1fc755cc614">signalVtxMCSelection_</a>+<span class="stringliteral">&quot;_mc&quot;</span>+<a class="code" href="classSimpZBiOptimizationProcessor.html#ace5518f052257b18d5fa89e271d18d0f">signal_pdgid_</a>+<span class="stringliteral">&quot;Energy_h&quot;</span>).c_str());</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Got the histo &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">if</span>(signalEnergy_h == <span class="keyword">nullptr</span>) std::cout &lt;&lt; <span class="stringliteral">&quot;HISTO IS NULL&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a0e062316cf8cec8f26c814782870a67d">E_Vd_</a> = (double)signalEnergy_h-&gt;GetMean();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Mean Energy is &quot;</span> &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#a0e062316cf8cec8f26c814782870a67d">E_Vd_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">//Read background ana vertex tuple, and convert to mutable tuple</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Reading Background AnaVertex Tuple from file &quot;</span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#a1a29d28b4ccc338b9704942daaebcd6a">signalVtxAnaFilename_</a>.c_str() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    TFile* bkgVtxAnaFile = <span class="keyword">new</span> TFile(<a class="code" href="classSimpZBiOptimizationProcessor.html#ad8a64f94c00543cfde1e12e264da2fe0">bkgVtxAnaFilename_</a>.c_str(),<span class="stringliteral">&quot;READ&quot;</span>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a> = <span class="keyword">new</span> <a class="code" href="classSimpAnaTTree.html">SimpAnaTTree</a>(bkgVtxAnaFile, (<a class="code" href="classSimpZBiOptimizationProcessor.html#a5e954bf07ab1dac5ff7249cebb094545">bkgVtxAnaTreename_</a>+<span class="stringliteral">&quot;/&quot;</span>+<a class="code" href="classSimpZBiOptimizationProcessor.html#a5e954bf07ab1dac5ff7249cebb094545">bkgVtxAnaTreename_</a>+<span class="stringliteral">&quot;_tree&quot;</span>).c_str());</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a125ca3dc2bb650b998b2f8092c234013">defineMassWindow</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#ad6b8b2cbeed86c3fa2425467a2eef5fa">lowMass_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#adc82ce333c65afb1a08e72cf329a3ad3">highMass_</a>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">//Add new variables, as defined in SimpAnaTTree.cxx, from the processor configuration script</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">for</span>(std::vector&lt;std::string&gt;::iterator it = <a class="code" href="classSimpZBiOptimizationProcessor.html#a3878c7905bab66dc93e8b7fb78ce82d1">new_variables_</a>.begin(); it != <a class="code" href="classSimpZBiOptimizationProcessor.html#a3878c7905bab66dc93e8b7fb78ce82d1">new_variables_</a>.end(); it++){</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordtype">int</span> param_idx = std::distance(<a class="code" href="classSimpZBiOptimizationProcessor.html#a3878c7905bab66dc93e8b7fb78ce82d1">new_variables_</a>.begin(), it);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Attempting to add new variable &quot;</span> &lt;&lt; *it &lt;&lt; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="stringliteral">&quot; with parameter &quot;</span> &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#a179ff262182aa5a0e2dd800a8f5b1252">new_variable_params_</a>.at(param_idx) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="comment">//signalMTT_-&gt;addVariable(*it, new_variable_params_.at(param_idx));</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">//bkgMTT_-&gt;addVariable(*it, new_variable_params_.at(param_idx));</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#abca87f02b9f2b4f64f3fdc89bb19a8df">addNewVariables</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>, *it, <a class="code" href="classSimpZBiOptimizationProcessor.html#a179ff262182aa5a0e2dd800a8f5b1252">new_variable_params_</a>.at(param_idx));</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#abca87f02b9f2b4f64f3fdc89bb19a8df">addNewVariables</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>, *it, <a class="code" href="classSimpZBiOptimizationProcessor.html#a179ff262182aa5a0e2dd800a8f5b1252">new_variable_params_</a>.at(param_idx));</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">//Finalize Initialization of New Mutable Tuples</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Finalizing Initialization of New Mutable Tuples&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a1fdaae294df486df6058ca78bbfbe084">shiftVariable</a>(<span class="stringliteral">&quot;unc_vtx_ele_track_z0&quot;</span>, -0.07);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a1fdaae294df486df6058ca78bbfbe084">shiftVariable</a>(<span class="stringliteral">&quot;unc_vtx_pos_track_z0&quot;</span>, -0.07);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#af5105c0eef86140ad8203af2bf159d57">Fill</a>();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#af5105c0eef86140ad8203af2bf159d57">Fill</a>();</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">//Initialize Persistent Cut Selector. These cuts are applied to all events.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">//Persistent Cut values are updated each iteration with the value of the best performing Test Cut in</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">//that iteration.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Initializing Set of Persistent Cuts&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a> = <span class="keyword">new</span> <a class="code" href="classIterativeCutSelector.html">IterativeCutSelector</a>(<span class="stringliteral">&quot;persistentCuts&quot;</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#aa248deec58b67ef14faaa8087971e5f1">cuts_cfgFile_</a>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classBaseSelector.html#ab966ed3e4e621296cd6ee56809a86c50">LoadSelection</a>();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#abf243bc1d985e33c2c3ed6aa6f2b575b">persistentCutsPtr_</a> = <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a1afaa4a415f64f97b2e8dc35a6db5075">getPointerToCuts</a>();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Persistent Cuts: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#ac5ab4b717572a809d14a50d6ed2d2ecc">printCuts</a>();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">//initalize Test Cuts</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Initializing Set of Test Cuts&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a> = <span class="keyword">new</span> <a class="code" href="classIterativeCutSelector.html">IterativeCutSelector</a>(<span class="stringliteral">&quot;testCuts&quot;</span>,<a class="code" href="classSimpZBiOptimizationProcessor.html#aa248deec58b67ef14faaa8087971e5f1">cuts_cfgFile_</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classBaseSelector.html#ab966ed3e4e621296cd6ee56809a86c50">LoadSelection</a>();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a> = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a1afaa4a415f64f97b2e8dc35a6db5075">getPointerToCuts</a>();</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a8add4a2dd5bda5964b49a08fe7021b71">filterCuts</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a32090166ec7f47f8e0d14ade88428e98">cutVariables_</a>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Test Cuts: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#ac5ab4b717572a809d14a50d6ed2d2ecc">printCuts</a>();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">//Initialize signal histograms</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Initializing Signal Variable Histograms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>= std::make_shared&lt;ZBiHistos&gt;(<span class="stringliteral">&quot;signal&quot;</span>);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>-&gt;debugMode(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>-&gt;loadHistoConfig(<a class="code" href="classSimpZBiOptimizationProcessor.html#a15bf37530b47266a0fb5550fb2c88e4e">variableHistCfgFilename_</a>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>-&gt;DefineHistos();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Initializing Background Variable Histograms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a> = std::make_shared&lt;ZBiHistos&gt;(<span class="stringliteral">&quot;background&quot;</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a>-&gt;debugMode(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a>-&gt;loadHistoConfig(<a class="code" href="classSimpZBiOptimizationProcessor.html#a15bf37530b47266a0fb5550fb2c88e4e">variableHistCfgFilename_</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a>-&gt;DefineHistos();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">//Initialize Test Cut histograms</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Initializing Test Cut Variable Histograms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a> = std::make_shared&lt;ZBiHistos&gt;(<span class="stringliteral">&quot;testCutHistos&quot;</span>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;debugMode(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;DefineHistos();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">//Add Test Cut Analysis Histograms necessary for calculating background and signal</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Initializing Test Cut Analysis Histograms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a9dd204b9bcfb929a721ed80dce297423">cut_iter_</a> it=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;begin(); it!=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;end(); it++){</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        std::string name = it-&gt;first;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="comment">//Used to select true z vertex distribution given a cut in unc_vtx_z</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;addHisto2d(<span class="stringliteral">&quot;unc_vtx_z_vs_true_vtx_z_&quot;</span>+name+<span class="stringliteral">&quot;_hh&quot;</span>,<span class="stringliteral">&quot;unc z_{vtx} [mm]&quot;</span>,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            1500, -50.0, 100.0,<span class="stringliteral">&quot;true z_{vtx} [mm]&quot;</span>,200,-50.3,149.7);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">//signalSelZ models signal selection efficiency</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;addHisto1d(<span class="stringliteral">&quot;signal_SelZ_&quot;</span>+name+<span class="stringliteral">&quot;_h&quot;</span>,<span class="stringliteral">&quot;true z_{vtx} [mm]&quot;</span>,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                200, -50.3, 149.7);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">//background_zVtx provides basis for background model, used to estimate nbackground in signal region</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;addHisto1d(<span class="stringliteral">&quot;background_zVtx_&quot;</span>+name+<span class="stringliteral">&quot;_h&quot;</span>,<span class="stringliteral">&quot;unc z_{vtx} [mm]&quot;</span>,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                150, -50.0, 100.0);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">//Initialize processor histograms that summarize iterative results</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Initializing Itearitve Result Histograms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a> = std::make_shared&lt;ZBiHistos&gt;(<span class="stringliteral">&quot;zbi_processor&quot;</span>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;defineZBiCutflowProcessorHistograms();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">//Fill Initial Signal histograms</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Filling initial signal histograms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e=0; e &lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a2e639546d7f534c99014390732155c08">GetEntries</a>(); e++){</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a0a5f325ea724cf5ae8b763d388fcc126">GetEntry</a>(e);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a222ffe169dde2cbf566830b296adc5ab">fillEventHistograms</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Filling initial background histograms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">//Fill Initial Background Histograms</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e=0; e &lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a2e639546d7f534c99014390732155c08">GetEntries</a>(); e++){</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a0a5f325ea724cf5ae8b763d388fcc126">GetEntry</a>(e);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a222ffe169dde2cbf566830b296adc5ab">fillEventHistograms</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">//Count background rate in the Control Region (used to calculate total A&#39; Rate)</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespaceconfig_1_1simp__zbi__config.html#a5acc9840ebad7cf498e568185d30badc">m_Ap</a> = <a class="code" href="classSimpZBiOptimizationProcessor.html#ad5f8f268208e6faa808723fa680f5a7f">simpEqs_</a>-&gt;<a class="code" href="classSimpEquations.html#a501e2d5e367a5be02a79dc35a8e9abd3">getAprimeMassFromVectorMass</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a436e1589148888d95fb9a2d1b34d09f3">signal_mass_</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a602747f34e77a5d169f343951c4c95bd">dNdm_</a> = <a class="code" href="classSimpZBiOptimizationProcessor.html#a2c45220d6b9f66a6547795231bcc7828">countControlRegionBackgroundRate</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#abbd9e048651de8fcd4020e5d03504fa5">bkgControlRegionFilename_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#aee57f0c2237e29a1579d7b8bef83a083">bkgControlRegionTreename_</a>, <a class="code" href="namespaceconfig_1_1simp__zbi__config.html#a5acc9840ebad7cf498e568185d30badc">m_Ap</a>, 30.0, <a class="code" href="classSimpZBiOptimizationProcessor.html#a8faef2f19bcc75ff9144a8b453b47f6d">dNdm_sf_</a>);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">//Write initial variable histograms for signal and background</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Writing Initial Histograms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>-&gt;writeHistos(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>,<span class="stringliteral">&quot;initial_signal&quot;</span>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a>-&gt;writeHistos(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>,<span class="stringliteral">&quot;initial_background&quot;</span>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#af268a62c13246b74b5428a296cdf714a">  398</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#af268a62c13246b74b5428a296cdf714a">SimpZBiOptimizationProcessor::process</a>(){</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimizationProcessor]::process()&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">//step_size defines n% of signal distribution to cut in a given variable</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;step_size_ &quot;</span> &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#adb1b8473d77d4172c13e742844431f64">step_size_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">double</span> cutFraction = <a class="code" href="classSimpZBiOptimizationProcessor.html#adb1b8473d77d4172c13e742844431f64">step_size_</a>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#ac6922f4d6dc9a356c2d0debea6bbd3ac">max_iteration_</a> &gt; (<span class="keywordtype">int</span>)1.0/cutFraction)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac6922f4d6dc9a356c2d0debea6bbd3ac">max_iteration_</a> = (<a class="code" href="namespaceconfig_1_1anaBhTuple__cfg.html#a61569f2965b7a369eb10b6d75d410d11">int</a>)1.0/cutFraction;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;max iteration: &quot;</span> &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#ac6922f4d6dc9a356c2d0debea6bbd3ac">max_iteration_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">//Iteratively cut n% of the signal distribution for a given Test Cut variable</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iteration = 0; iteration &lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#ac6922f4d6dc9a356c2d0debea6bbd3ac">max_iteration_</a>+1; iteration ++){</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordtype">double</span> cutSignal = (double)iteration*<a class="code" href="classSimpZBiOptimizationProcessor.html#adb1b8473d77d4172c13e742844431f64">step_size_</a>*100.0;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        cutSignal = <a class="code" href="classSimpZBiOptimizationProcessor.html#a56143e92286edc69212b9d152046c69f">round</a>(cutSignal);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;## ITERATION &quot;</span> &lt;&lt; iteration &lt;&lt; <span class="stringliteral">&quot; ##&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="comment">//Reset histograms at the start of each iteration</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="comment">//Histograms will change with each iteration. </span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Resetting Histograms&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>-&gt;resetHistograms1d();</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>-&gt;resetHistograms2d();</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a>-&gt;resetHistograms1d();</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a>-&gt;resetHistograms2d();</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;resetHistograms1d();</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;resetHistograms2d();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="comment">//At the start of each iteration, save the persistent cut values</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a9dd204b9bcfb929a721ed80dce297423">cut_iter_</a> it=<a class="code" href="classSimpZBiOptimizationProcessor.html#abf243bc1d985e33c2c3ed6aa6f2b575b">persistentCutsPtr_</a>-&gt;begin(); it!=<a class="code" href="classSimpZBiOptimizationProcessor.html#abf243bc1d985e33c2c3ed6aa6f2b575b">persistentCutsPtr_</a>-&gt;end(); it++){</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            std::string cutname = it-&gt;first;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordtype">double</span> cutvalue = <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classBaseSelector.html#a13e19f5cf3e88d8ae453670a845e39d1">getCut</a>(cutname);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>){</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Saving persistent cut: &quot;</span> &lt;&lt; cutname &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; cutvalue &lt;&lt; std::endl;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordtype">int</span> cutid = <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a8bef646486a02ac25ff11e87c965cf81">getCutID</a>(cutname);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill2DHisto(<span class="stringliteral">&quot;persistent_cuts_hh&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    (<span class="keywordtype">double</span>)cutid,cutvalue);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;set2DHistoYlabel(<span class="stringliteral">&quot;persistent_cuts_hh&quot;</span>,cutid,cutname);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="comment">//Fill signal variable distributions</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e=0;  e &lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a2e639546d7f534c99014390732155c08">GetEntries</a>(); e++){</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a0a5f325ea724cf5ae8b763d388fcc126">GetEntry</a>(e);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="comment">//Apply current set of persistent cuts to all events</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a7961dcc96c87a199626f34142123d268">failPersistentCuts</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>))</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="comment">//Fill Signal variable distributions</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#a222ffe169dde2cbf566830b296adc5ab">fillEventHistograms</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">if</span>(iteration == <a class="code" href="classSimpZBiOptimizationProcessor.html#ac6922f4d6dc9a356c2d0debea6bbd3ac">max_iteration_</a>){</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="comment">//Write iteration histos</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>-&gt;writeHistos(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>,<span class="stringliteral">&quot;signal_pct_sig_cut_&quot;</span>+std::to_string(cutSignal));</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a>-&gt;writeHistos(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>,<span class="stringliteral">&quot;background_pct_sig_cut_&quot;</span>+std::to_string(cutSignal));</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="comment">//Initialize Signal Integrals</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">if</span>(iteration == 0){</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="comment">//Integrate each signal variable distribution.</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="comment">//When iterating Test Cuts, we reference these intial integrals, cutting n% of the original distribution.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimization]::Integrating initial Signal distributions&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a9dd204b9bcfb929a721ed80dce297423">cut_iter_</a> it=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;begin(); it!=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;end(); it++){</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                std::string cutname = it-&gt;first;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                std::string var = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a74e1be83f732d77738f35a8cbf38d30c">getCutVar</a>(cutname);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <a class="code" href="classSimpZBiOptimizationProcessor.html#ac713bd14fb00c4d79599ff8e0f4788d9">initialIntegrals_</a>[var] = <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>-&gt;integrateHistogram1D(<span class="stringliteral">&quot;signal_&quot;</span>+var+<span class="stringliteral">&quot;_h&quot;</span>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;Initial Integral for &quot;</span> &lt;&lt; var &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#ac713bd14fb00c4d79599ff8e0f4788d9">initialIntegrals_</a>[var] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="comment">//Loop over each Test Cut. Cut n% of signal distribution in Test Cut variable</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;Looping over Signal Test Cuts&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a9dd204b9bcfb929a721ed80dce297423">cut_iter_</a> it=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;begin(); it!=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;end(); it++){</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            std::string cutname = it-&gt;first;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            std::string cutvar = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a74e1be83f732d77738f35a8cbf38d30c">getCutVar</a>(cutname);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordtype">bool</span> isCutGT = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a113a5942ae474d0e578225b7d11ef6e3">isCutGreaterThan</a>(cutname);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordtype">double</span> cutvalue = <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>-&gt;cutFractionOfSignalVariable(cutvar, isCutGT, </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    iteration*cutFraction, <a class="code" href="classSimpZBiOptimizationProcessor.html#ac713bd14fb00c4d79599ff8e0f4788d9">initialIntegrals_</a>[cutvar]);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#ac12e9d2ee0b72aef4a5d9e64dff7fac1">setCutValue</a>(cutname, cutvalue);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>){</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Test Cut &quot;</span> &lt;&lt; cutname &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classBaseSelector.html#a13e19f5cf3e88d8ae453670a845e39d1">getCut</a>(cutname) &lt;&lt;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                    <span class="stringliteral">&quot; cuts &quot;</span> &lt;&lt; cutSignal &lt;&lt; <span class="stringliteral">&quot;% of signal distribution in this variable &quot;</span> &lt;&lt; std::endl; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="comment">//Fill Background Histograms corresponding to each Test Cut</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;Filling Background Variables for each Test Cut&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e=0;  e &lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a2e639546d7f534c99014390732155c08">GetEntries</a>(); e++){</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a0a5f325ea724cf5ae8b763d388fcc126">GetEntry</a>(e);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="comment">//Apply persistent cuts</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a7961dcc96c87a199626f34142123d268">failPersistentCuts</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>))</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#a222ffe169dde2cbf566830b296adc5ab">fillEventHistograms</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="comment">//Loop over each Test Cut</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a9dd204b9bcfb929a721ed80dce297423">cut_iter_</a> it=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;begin(); it!=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;end(); it++){</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;               std::string cutname = it-&gt;first;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;               std::string cutvar = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a74e1be83f732d77738f35a8cbf38d30c">getCutVar</a>(cutname);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;               <span class="comment">//apply Test Cut</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;               <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a2e5b59fcbe59cc43c06ddac3c5834ab8">failTestCut</a>(cutname, <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>))</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                   <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="comment">//If event passes Test Cut, fill vertex z distribution. </span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <span class="comment">//This distribution is used to build the Background Model corresponding to each Test Cut</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;Fill1DHisto(<span class="stringliteral">&quot;background_zVtx_&quot;</span>+cutname+<span class="stringliteral">&quot;_h&quot;</span>,</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        <a class="code" href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">bkgMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>),<a class="code" href="classSimpZBiOptimizationProcessor.html#a8079093abe734825b55fcd9dc4dae32a">background_sf_</a>);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="comment">//For each Test Cut, build relationship between Signal truth z_vtx, and reconstructed z_vtx</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">//This is used to get the truth Signal Selection Efficiency F(z), given a Zcut in reconstructed z_vtx</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;Build Signal truth z vs recon z&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e=0;  e &lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a2e639546d7f534c99014390732155c08">GetEntries</a>(); e++){</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a0a5f325ea724cf5ae8b763d388fcc126">GetEntry</a>(e);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="comment">//Apply persistent cuts</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a7961dcc96c87a199626f34142123d268">failPersistentCuts</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>))</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="comment">//Loop over each Test Cut and plot unc_vtx_z vs true_vtx_z</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a9dd204b9bcfb929a721ed80dce297423">cut_iter_</a> it=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;begin(); it!=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;end(); it++){</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                std::string cutname = it-&gt;first;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                std::string cutvar = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a74e1be83f732d77738f35a8cbf38d30c">getCutVar</a>(cutname);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="keywordtype">double</span> cutvalue = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classBaseSelector.html#a13e19f5cf3e88d8ae453670a845e39d1">getCut</a>(cutname);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                <span class="comment">//Apply Test Cut</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keywordflow">if</span>(!<a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#afff63780bb263ad8733f6bc51d7ff637">passCutGTorLT</a>(cutname, <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(cutvar)))</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;Fill2DHisto(<span class="stringliteral">&quot;unc_vtx_z_vs_true_vtx_z_&quot;</span>+cutname+<span class="stringliteral">&quot;_hh&quot;</span>,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        <a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;unc_vtx_z&quot;</span>),<a class="code" href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">signalMTT_</a>-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(<span class="stringliteral">&quot;vd_true_vtx_z&quot;</span>),1.0);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="comment">//Calcuate the Binomial Significance ZBi corresponding to each Test Cut</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="comment">//Test Cut with maximum ZBi after cutting n% of signal distribution in a given variable is selected</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment">//Test Cut value is added to list of Persistent Cuts, and is applied to all events in following iterations.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="comment">//Create Directory for this iteration</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        std::string iteration_subdir = <span class="stringliteral">&quot;testCuts_pct_sig_cut_&quot;</span>+std::to_string(cutSignal);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        TDirectory* dir{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        std::cout&lt;&lt;iteration_subdir.c_str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">if</span> (!iteration_subdir.empty()) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            dir = <a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>-&gt;mkdir(iteration_subdir.c_str(),<span class="stringliteral">&quot;&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordtype">double</span> best_zbi = -9999.9;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordtype">double</span> best_zcut = -9999.9;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keywordtype">double</span> best_nsig = -9999.9;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordtype">double</span> best_nbkg = -9999.9;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        std::string best_cutname;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordtype">double</span> best_cutvalue;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="comment">//Loop over Test Cuts</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;Calculate ZBi for each Test Cut &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a9dd204b9bcfb929a721ed80dce297423">cut_iter_</a> it=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;begin(); it!=<a class="code" href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">testCutsPtr_</a>-&gt;end(); it++){</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            std::string cutname = it-&gt;first;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="keywordtype">double</span> cutvalue = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classBaseSelector.html#a13e19f5cf3e88d8ae453670a845e39d1">getCut</a>(cutname);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keywordtype">int</span> cutid = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a8bef646486a02ac25ff11e87c965cf81">getCutID</a>(cutname);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>){</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Calculating ZBi for Test Cut &quot;</span> &lt;&lt; cutname &lt;&lt; std::endl;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Test Cut ID: &quot;</span> &lt;&lt; cutid &lt;&lt; <span class="stringliteral">&quot; | Test Cut Value: &quot;</span> &lt;&lt; cutvalue &lt;&lt; std::endl;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="comment">//Build Background Model, used to estimate nbkg in Signal Region</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;Build Background Model&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="keywordtype">double</span> start_fit = 500.0*<a class="code" href="classSimpZBiOptimizationProcessor.html#a8079093abe734825b55fcd9dc4dae32a">background_sf_</a>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            TF1* bkg_model = (TF1*)<a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;fitExponentialTail(<span class="stringliteral">&quot;background_zVtx_&quot;</span>+cutname, start_fit); </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="comment">//TF1* bkg_model = (TF1*)testCutHistos_-&gt;fitExponentialPlusConst(&quot;background_zVtx_&quot;+cutname, start_fit); </span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;END Build Background Model&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="comment">//Get signal unc_vtx_z vs true_vtx_z</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            TH2F* vtx_z_hh = (TH2F*)<a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;get2dHisto(<span class="stringliteral">&quot;testCutHistos_unc_vtx_z_vs_true_vtx_z_&quot;</span>+cutname+<span class="stringliteral">&quot;_hh&quot;</span>);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="comment">//CD to output file to save resulting plots</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>-&gt;cd();</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="comment">//Graphs track the performance of a Test Cut as a function of Zcut position</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            TGraph* zcutscan_zbi_g = <span class="keyword">new</span> TGraph();</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            zcutscan_zbi_g-&gt;SetName((<span class="stringliteral">&quot;zcut_vs_zbi_&quot;</span>+cutname+<span class="stringliteral">&quot;_g&quot;</span>).c_str());</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            zcutscan_zbi_g-&gt;SetTitle((<span class="stringliteral">&quot;zcut_vs_zbi_&quot;</span>+cutname+<span class="stringliteral">&quot;_g;zcut [mm];zbi&quot;</span>).c_str());</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            zcutscan_zbi_g-&gt;SetMarkerStyle(8);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            zcutscan_zbi_g-&gt;SetMarkerSize(2.0);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            zcutscan_zbi_g-&gt;SetMarkerColor(2);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            TGraph* zcutscan_nsig_g = <span class="keyword">new</span> TGraph();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            zcutscan_nsig_g-&gt;SetName((<span class="stringliteral">&quot;zcut_vs_nsig_&quot;</span>+cutname+<span class="stringliteral">&quot;_g&quot;</span>).c_str());</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            zcutscan_nsig_g-&gt;SetTitle((<span class="stringliteral">&quot;zcut_vs_nsig_&quot;</span>+cutname+<span class="stringliteral">&quot;_g;zcut [mm];nsig&quot;</span>).c_str());</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            zcutscan_nsig_g-&gt;SetMarkerStyle(23);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            zcutscan_nsig_g-&gt;SetMarkerSize(2.0);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            zcutscan_nsig_g-&gt;SetMarkerColor(57);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            TGraph* zcutscan_nbkg_g = <span class="keyword">new</span> TGraph();</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            zcutscan_nbkg_g-&gt;SetName((<span class="stringliteral">&quot;zcut_vs_nbkg_&quot;</span>+cutname+<span class="stringliteral">&quot;_g&quot;</span>).c_str());</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            zcutscan_nbkg_g-&gt;SetTitle((<span class="stringliteral">&quot;zcut_vs_nbkg_&quot;</span>+cutname+<span class="stringliteral">&quot;_g;zcut [mm];nbkg&quot;</span>).c_str());</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            zcutscan_nbkg_g-&gt;SetMarkerStyle(45);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            zcutscan_nbkg_g-&gt;SetMarkerSize(2.0);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            zcutscan_nbkg_g-&gt;SetMarkerColor(49);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            TGraph* nbkg_zbi_g = <span class="keyword">new</span> TGraph();</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            nbkg_zbi_g-&gt;SetName((<span class="stringliteral">&quot;nbkg_vs_zbi_&quot;</span>+cutname+<span class="stringliteral">&quot;_g&quot;</span>).c_str());</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            nbkg_zbi_g-&gt;SetTitle((<span class="stringliteral">&quot;nbkg_vs_zbi_&quot;</span>+cutname+<span class="stringliteral">&quot;_g;nbkg;zbi&quot;</span>).c_str());</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            TGraph* nsig_zbi_g = <span class="keyword">new</span> TGraph();</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            nsig_zbi_g-&gt;SetName((<span class="stringliteral">&quot;nsig_vs_zbi_&quot;</span>+cutname+<span class="stringliteral">&quot;_g&quot;</span>).c_str());</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            nsig_zbi_g-&gt;SetTitle((<span class="stringliteral">&quot;nsig_vs_zbi_&quot;</span>+cutname+<span class="stringliteral">&quot;_g;nsig;zbi&quot;</span>).c_str());</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            TH2F* nsig_zcut_hh = <span class="keyword">new</span> TH2F((<span class="stringliteral">&quot;nsig_v_zcut_zbi_&quot;</span>+cutname+<span class="stringliteral">&quot;_hh&quot;</span>).c_str(),</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                    (<span class="stringliteral">&quot;nsig_v_zcut_zbi_&quot;</span>+cutname+<span class="stringliteral">&quot;_hh; zcut [mm]; Nbkg&quot;</span>).c_str(),</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                    200,-50.3,149.7,3000,0.0,300.0);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            TH2F* nbkg_zcut_hh = <span class="keyword">new</span> TH2F((<span class="stringliteral">&quot;nbkg_v_zcut_zbi_&quot;</span>+cutname+<span class="stringliteral">&quot;_hh&quot;</span>).c_str(),</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    (<span class="stringliteral">&quot;nbkg_v_zcut_zbi_&quot;</span>+cutname+<span class="stringliteral">&quot;_hh; zcut [mm]; Nbkg&quot;</span>).c_str(),</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    200,-50.3,149.7,3000,0.0,300.0);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="comment">//Find maximum position of Zcut --&gt; ZBi calculation requires non-zero background</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <span class="comment">//Start the Zcut position at the target</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keywordtype">double</span> zcut_step = 0.1;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            TH1F* bkg_zVtx_h = (TH1F*)<a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;get1dHisto(<span class="stringliteral">&quot;testCutHistos_background_zVtx_&quot;</span>+cutname+<span class="stringliteral">&quot;_h&quot;</span>);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordtype">double</span> max_zcut = bkg_model-&gt;GetXmin();</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordtype">double</span> endIntegral = bkg_zVtx_h-&gt;GetBinLowEdge(bkg_zVtx_h-&gt;FindLastBinAbove(0.0)) + bkg_zVtx_h-&gt;GetBinWidth(1);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="comment">//double endIntegral = 100.0</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keywordtype">double</span> testIntegral = bkg_model-&gt;Integral(max_zcut, endIntegral);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;Background between &quot;</span> &lt;&lt; max_zcut &lt;&lt; <span class="stringliteral">&quot;and end of histo is &quot;</span> &lt;&lt; testIntegral &lt;&lt; std::endl;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">while</span>(testIntegral &gt; <a class="code" href="classSimpZBiOptimizationProcessor.html#ab5a708fd4312459a5d0742422759f4fa">min_ztail_events_</a>){</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                max_zcut = max_zcut+zcut_step;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                testIntegral = bkg_model-&gt;Integral(max_zcut, endIntegral);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <span class="keywordflow">if</span>(testIntegral &lt; <a class="code" href="classSimpZBiOptimizationProcessor.html#ab5a708fd4312459a5d0742422759f4fa">min_ztail_events_</a>){</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    max_zcut = max_zcut-zcut_step;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    testIntegral = bkg_model-&gt;Integral(max_zcut, endIntegral);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;Maximum Zcut: &quot;</span> &lt;&lt; max_zcut &lt;&lt; <span class="stringliteral">&quot; gives &quot;</span> &lt;&lt; testIntegral &lt;&lt; <span class="stringliteral">&quot; background events&quot;</span>  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="comment">//If configuration does not specify scanning Zcut values, use single Zcut position at maximum position.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordtype">double</span> min_zcut = bkg_model-&gt;GetXmin();</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="keywordflow">if</span>(!<a class="code" href="classSimpZBiOptimizationProcessor.html#ae87886ccab8983b4838ee892fa4c210b">scan_zcut_</a>)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                min_zcut = max_zcut;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Minimum Zcut position: &quot;</span> &lt;&lt; min_zcut &lt;&lt; std::endl;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="comment">//Get the signal vtx z selection efficiency *before* zcut is applied</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;Get signal vtx z selection efficiency before Zcut&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            TH1F* true_vtx_NoZ_h = (TH1F*)vtx_z_hh-&gt;ProjectionY((cutname+<span class="stringliteral">&quot;_&quot;</span>+<span class="stringliteral">&quot;true_vtx_z_projy&quot;</span>).c_str(),1,vtx_z_hh-&gt;GetXaxis()-&gt;GetNbins(),<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="comment">//Convert the truth vertex z distribution beyond Zcut into the appropriately binned Selection.</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="comment">//Binning must match Signal pre-trigger distribution, in order to take Efficiency between them. </span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            TH1F* signalSelNoZ_h = </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                (TH1F*)<a class="code" href="classSimpZBiOptimizationProcessor.html#adefbf2faf781dbb0f77a9170b1dc353b">signalSimZ_h_</a>-&gt;Clone((<span class="stringliteral">&quot;testCutHistos_signal_SelNoZ_&quot;</span>+cutname+<span class="stringliteral">&quot;_h&quot;</span>).c_str());</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;201; i++){</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                signalSelNoZ_h-&gt;SetBinContent(i,true_vtx_NoZ_h-&gt;GetBinContent(i));</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            TEfficiency* effCalcNoZ_h = <span class="keyword">new</span> TEfficiency(*signalSelNoZ_h, *<a class="code" href="classSimpZBiOptimizationProcessor.html#adefbf2faf781dbb0f77a9170b1dc353b">signalSimZ_h_</a>);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>-&gt;cd((<span class="stringliteral">&quot;testCuts_pct_sig_cut_&quot;</span>+std::to_string(cutSignal)).c_str());</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            signalSelNoZ_h-&gt;Write();</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            effCalcNoZ_h-&gt;Write();</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keyword">delete</span> effCalcNoZ_h;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <span class="comment">//Scan Zcut position and calculate ZBi</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordtype">double</span> best_scan_zbi = -999.9;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="keywordtype">double</span> best_scan_zcut;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="keywordtype">double</span> best_scan_nsig;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keywordtype">double</span> best_scan_nbkg;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;Scanning zcut position&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">double</span> zcut = min_zcut; zcut &lt; (max_zcut+zcut_step); zcut = zcut+zcut_step){</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <span class="keywordtype">double</span> Nbkg = bkg_model-&gt;Integral(zcut,endIntegral);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                <span class="comment">//std::cout &lt;&lt; &quot;zcut: &quot; &lt;&lt; zcut &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                <span class="comment">//std::cout &lt;&lt; &quot;Nbkg: &quot; &lt;&lt; Nbkg &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <span class="comment">//Get the Signal truth vertex z distribution beyond the reconstructed vertex Zcut</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                TH1F* true_vtx_z_h = (TH1F*)vtx_z_hh-&gt;ProjectionY((std::to_string(zcut)+<span class="stringliteral">&quot;_&quot;</span>+cutname+<span class="stringliteral">&quot;_&quot;</span>+<span class="stringliteral">&quot;true_vtx_z_projy&quot;</span>).c_str(),vtx_z_hh-&gt;GetXaxis()-&gt;FindBin(zcut)+1,vtx_z_hh-&gt;GetXaxis()-&gt;GetNbins(),<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                <span class="comment">//Convert the truth vertex z distribution beyond Zcut into the appropriately binned Selection.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="comment">//Binning must match Signal pre-trigger distribution, in order to take Efficiency between them. </span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                TH1F* signalSelZ_h = </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    (TH1F*)<a class="code" href="classSimpZBiOptimizationProcessor.html#adefbf2faf781dbb0f77a9170b1dc353b">signalSimZ_h_</a>-&gt;Clone((<span class="stringliteral">&quot;testCutHistos_signal_SelZ_&quot;</span>+cutname+<span class="stringliteral">&quot;_h&quot;</span>).c_str());</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;201; i++){</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    signalSelZ_h-&gt;SetBinContent(i,true_vtx_z_h-&gt;GetBinContent(i));</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                <span class="comment">//Get Signal Selection Efficiency, as a function of truth vertex Z, F(z)</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <span class="comment">//if(debug_) std::cout &lt;&lt; &quot;Get Signal Selection Efficiency&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                TEfficiency* effCalc_h = <span class="keyword">new</span> TEfficiency(*signalSelZ_h, *<a class="code" href="classSimpZBiOptimizationProcessor.html#adefbf2faf781dbb0f77a9170b1dc353b">signalSimZ_h_</a>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <span class="comment">//if(zcut == min_zcut){</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <span class="comment">//    outFile_-&gt;cd((&quot;testCuts_pct_sig_cut_&quot;+std::to_string(cutSignal)).c_str());</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                <span class="comment">//    effCalc_h-&gt;Write();</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                <span class="comment">//}</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                <span class="keywordtype">double</span> eps2 = std::pow(10, <a class="code" href="classSimpZBiOptimizationProcessor.html#a1185bf9f80b6a16684fad9dec253bb97">logEps2_</a>);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keywordtype">double</span> eps = std::sqrt(eps2);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                <span class="comment">//Calculate expected signal for Neutral Dark Vector &quot;rho&quot;</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                <span class="keywordtype">double</span> nSigRho = <a class="code" href="classSimpZBiOptimizationProcessor.html#ad5f8f268208e6faa808723fa680f5a7f">simpEqs_</a>-&gt;<a class="code" href="classSimpEquations.html#a14037703ca07591f98071e4df3a78334">expectedSignalCalculation</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a436e1589148888d95fb9a2d1b34d09f3">signal_mass_</a>, </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                        eps, <span class="keyword">true</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a0e062316cf8cec8f26c814782870a67d">E_Vd_</a>, effCalc_h, <a class="code" href="classSimpZBiOptimizationProcessor.html#a602747f34e77a5d169f343951c4c95bd">dNdm_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#aa5ccc69ab0b3fe24b4bcc920c703fbc2">radFrac_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a9784b8ec5cfe672496b1ef31973cfbad">radAcc_</a>, -4.3, zcut);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="comment">//Calculate expected signal for Neutral Dark Vector &quot;rho&quot;</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                <span class="keywordtype">double</span> nSigPhi = <a class="code" href="classSimpZBiOptimizationProcessor.html#ad5f8f268208e6faa808723fa680f5a7f">simpEqs_</a>-&gt;<a class="code" href="classSimpEquations.html#a14037703ca07591f98071e4df3a78334">expectedSignalCalculation</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a436e1589148888d95fb9a2d1b34d09f3">signal_mass_</a>, </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                        eps, <span class="keyword">false</span>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a0e062316cf8cec8f26c814782870a67d">E_Vd_</a>, effCalc_h, <a class="code" href="classSimpZBiOptimizationProcessor.html#a602747f34e77a5d169f343951c4c95bd">dNdm_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#aa5ccc69ab0b3fe24b4bcc920c703fbc2">radFrac_</a>, <a class="code" href="classSimpZBiOptimizationProcessor.html#a9784b8ec5cfe672496b1ef31973cfbad">radAcc_</a>, -4.3, zcut);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                <span class="comment">/*</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">                //Calculate expected signal for Neutral Dark Vector &quot;rho&quot;</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">                double nSigRho = background_sf_*simpEqs_-&gt;expectedSignalCalculation(signal_mass_, </span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">                        eps, true, false, E_Vd_, effCalc_h, -4.3, zcut);</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">                //Calculate expected signal for Neutral Dark Vector &quot;phi&quot;</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">                double nSigPhi = background_sf_*simpEqs_-&gt;expectedSignalCalculation(signal_mass_, </span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">                        eps, false, true, E_Vd_, effCalc_h, -4.3, zcut);</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">                */</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                <span class="keywordtype">double</span> Nsig = nSigRho + nSigPhi;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                <span class="comment">//if(debug_){</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <span class="comment">//    std::cout &lt;&lt; &quot;nSigRho: &quot; &lt;&lt; nSigRho &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="comment">//    std::cout &lt;&lt; &quot;nSigPhi: &quot; &lt;&lt; nSigPhi &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                <span class="comment">//    std::cout &lt;&lt; &quot;Nsig: &quot; &lt;&lt; Nsig &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                <span class="comment">//}</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                Nsig = Nsig*<a class="code" href="classSimpZBiOptimizationProcessor.html#af8cf29d3d98b60a30ad1441665e1d22e">signal_sf_</a>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                <span class="comment">//if(debug_) std::cout &lt;&lt; &quot;Nsig after scale factor: &quot; &lt;&lt; Nsig &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="comment">//CLEAR POINTERS</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="keyword">delete</span> effCalc_h;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="comment">//Round Nsig, Nbkg, and then ZBi later</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                Nsig = <a class="code" href="classSimpZBiOptimizationProcessor.html#a56143e92286edc69212b9d152046c69f">round</a>(Nsig);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                Nbkg = <a class="code" href="classSimpZBiOptimizationProcessor.html#a56143e92286edc69212b9d152046c69f">round</a>(Nbkg);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                <span class="comment">//Calculate ZBi for this Test Cut using this zcut value</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="keywordtype">double</span> n_on = Nsig + Nbkg;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <span class="keywordtype">double</span> tau = 1.0;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="keywordtype">double</span> n_off = Nbkg;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="keywordtype">double</span> ZBi = <a class="code" href="classSimpZBiOptimizationProcessor.html#a1021f48239f7a78d10cbbc118336e0ab">calculateZBi</a>(n_on, n_off, tau);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;ZBi before rounding: &quot;</span> &lt;&lt; ZBi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                ZBi = <a class="code" href="classSimpZBiOptimizationProcessor.html#a56143e92286edc69212b9d152046c69f">round</a>(ZBi);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="comment">/*</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">                std::cout &lt;&lt; &quot;[SimpZBiOptimization]::Iteration Results:&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">                std::cout &lt;&lt; &quot;Zcut = &quot; &lt;&lt; zcut &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">                std::cout &lt;&lt; &quot;Nsig = &quot; &lt;&lt; Nsig &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">                std::cout &lt;&lt; &quot;n_bkg: &quot; &lt;&lt; Nbkg &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">                std::cout &lt;&lt; &quot;n_on: &quot; &lt;&lt; n_on &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">                std::cout &lt;&lt; &quot;n_off: &quot; &lt;&lt; n_off &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">                std::cout &lt;&lt; &quot;ZBi: &quot; &lt;&lt; ZBi &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">                */</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="comment">//Update Test Cut with best scan values</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <span class="keywordflow">if</span>(ZBi &gt; best_scan_zbi){</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                    best_scan_zbi = ZBi;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                    best_scan_zcut = zcut;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                    best_scan_nsig = Nsig;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                    best_scan_nbkg = Nbkg;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                <span class="comment">//Fill TGraphs</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                zcutscan_zbi_g-&gt;SetPoint(zcutscan_zbi_g-&gt;GetN(),zcut, ZBi);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                zcutscan_nbkg_g-&gt;SetPoint(zcutscan_nbkg_g-&gt;GetN(),zcut, Nbkg);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                zcutscan_nsig_g-&gt;SetPoint(zcutscan_nsig_g-&gt;GetN(),zcut, Nsig);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                nbkg_zbi_g-&gt;SetPoint(nbkg_zbi_g-&gt;GetN(),Nbkg, ZBi);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                nsig_zbi_g-&gt;SetPoint(nsig_zbi_g-&gt;GetN(),Nsig, ZBi);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                nsig_zcut_hh-&gt;Fill(zcut,Nsig,ZBi);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                nbkg_zcut_hh-&gt;Fill(zcut,Nbkg,ZBi);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="comment">//Write graph of zcut vs zbi for the Test Cut</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#aaec7b91c34866d747994e7d3bcf65b0c">writeGraph</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>, <span class="stringliteral">&quot;testCuts_pct_sig_cut_&quot;</span>+std::to_string(cutSignal), </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    zcutscan_zbi_g);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#aaec7b91c34866d747994e7d3bcf65b0c">writeGraph</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>, <span class="stringliteral">&quot;testCuts_pct_sig_cut_&quot;</span>+std::to_string(cutSignal), </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                    zcutscan_nbkg_g);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#aaec7b91c34866d747994e7d3bcf65b0c">writeGraph</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>, <span class="stringliteral">&quot;testCuts_pct_sig_cut_&quot;</span>+std::to_string(cutSignal), </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    zcutscan_nsig_g);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="comment">//delete TGraph pointers</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keyword">delete</span> zcutscan_zbi_g;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="keyword">delete</span> zcutscan_nsig_g;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <span class="keyword">delete</span> zcutscan_nbkg_g;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <span class="keyword">delete</span> nbkg_zbi_g;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="keyword">delete</span> nsig_zbi_g;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keyword">delete</span> nsig_zcut_hh;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keyword">delete</span> nbkg_zcut_hh;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;           <span class="comment">//Fill Summary Histograms Test Cuts at best zcutscan value</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;           <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill2DHisto(<span class="stringliteral">&quot;test_cuts_values_hh&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, (<span class="keywordtype">double</span>)cutid,cutvalue);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;           <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;set2DHistoYlabel(<span class="stringliteral">&quot;test_cuts_values_hh&quot;</span>,cutid,cutname);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;           <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill2DHisto(<span class="stringliteral">&quot;test_cuts_ZBi_hh&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, (<span class="keywordtype">double</span>)cutid,best_scan_zbi);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;           <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;set2DHistoYlabel(<span class="stringliteral">&quot;test_cuts_ZBi_hh&quot;</span>,cutid,cutname);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;           <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill2DHisto(<span class="stringliteral">&quot;test_cuts_zcut_hh&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, (<span class="keywordtype">double</span>)cutid,best_scan_zcut);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;           <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;set2DHistoYlabel(<span class="stringliteral">&quot;test_cuts_zcut_hh&quot;</span>,cutid,cutname);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;           <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill2DHisto(<span class="stringliteral">&quot;test_cuts_nsig_hh&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, (<span class="keywordtype">double</span>)cutid,best_scan_nsig);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;           <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;set2DHistoYlabel(<span class="stringliteral">&quot;test_cuts_nsig_hh&quot;</span>,cutid,cutname);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;           <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill2DHisto(<span class="stringliteral">&quot;test_cuts_nbkg_hh&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, (<span class="keywordtype">double</span>)cutid,best_scan_nbkg);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;           <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;set2DHistoYlabel(<span class="stringliteral">&quot;test_cuts_nbkg_hh&quot;</span>,cutid,cutname);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="comment">//Check if the best cutscan zbi for this Test Cut is the best overall ZBi for all Test Cuts</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">if</span>(best_scan_zbi &gt; best_zbi){</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                best_zbi = best_scan_zbi;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                best_cutname = cutname;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                best_cutvalue = cutvalue;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                best_zcut = best_scan_zcut;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                best_nsig = best_scan_nsig;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                best_nbkg = best_scan_nbkg;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        } <span class="comment">//END LOOP OVER TEST CUTS</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>){</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Iteration &quot;</span> &lt;&lt; iteration &lt;&lt; <span class="stringliteral">&quot; Best Test Cut is &quot;</span> &lt;&lt; best_cutname </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; best_cutvalue &lt;&lt; <span class="stringliteral">&quot; with ZBi=&quot;</span> &lt;&lt; best_zbi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Update persistent cuts list with this best test cut...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;[Persistent Cuts] Before update:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#ac5ab4b717572a809d14a50d6ed2d2ecc">printCuts</a>();</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="comment">//Find best Test Cut for iteration. Add Test Cut value to Persistent Cuts list</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill2DHisto(<span class="stringliteral">&quot;best_test_cut_ZBi_hh&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, best_zbi, </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                (<span class="keywordtype">double</span>)<a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a8bef646486a02ac25ff11e87c965cf81">getCutID</a>(best_cutname));</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill1DHisto(<span class="stringliteral">&quot;best_test_cut_ZBi_h&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, best_zbi);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill1DHisto(<span class="stringliteral">&quot;best_test_cut_zcut_h&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, best_zcut);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill1DHisto(<span class="stringliteral">&quot;best_test_cut_nsig_h&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, best_nsig);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill1DHisto(<span class="stringliteral">&quot;best_test_cut_nbkg_h&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, best_nbkg);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;Fill1DHisto(<span class="stringliteral">&quot;best_test_cut_id_h&quot;</span>,(<span class="keywordtype">double</span>)cutSignal, </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                (<span class="keywordtype">double</span>)<a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a8bef646486a02ac25ff11e87c965cf81">getCutID</a>(best_cutname));</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#ac12e9d2ee0b72aef4a5d9e64dff7fac1">setCutValue</a>(best_cutname, best_cutvalue);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>){</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;[Persistent Cuts] After update:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#ac5ab4b717572a809d14a50d6ed2d2ecc">printCuts</a>();</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="comment">//Write iteration histos</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">signalHistos_</a>-&gt;writeHistos(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>,<span class="stringliteral">&quot;signal_pct_sig_cut_&quot;</span>+std::to_string(cutSignal));</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">bkgHistos_</a>-&gt;writeHistos(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>,<span class="stringliteral">&quot;background_pct_sig_cut_&quot;</span>+std::to_string(cutSignal));</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;writeHistos(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>, <span class="stringliteral">&quot;testCuts_pct_sig_cut_&quot;</span>+std::to_string(cutSignal));</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;}</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a32d626626eee0bc4ade146973f6abb1c">  843</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a32d626626eee0bc4ade146973f6abb1c">SimpZBiOptimizationProcessor::finalize</a>() {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[SimpZBiOptimizationProcessor] finalize()&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">debug_</a>){</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;FINAL LIST OF PERSISTENT CUTS &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#ac5ab4b717572a809d14a50d6ed2d2ecc">printCuts</a>();</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">processorHistos_</a>-&gt;saveHistos(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">testCutHistos_</a>-&gt;writeGraphs(<a class="code" href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">outFile_</a>,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;}</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a1021f48239f7a78d10cbbc118336e0ab">  855</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a1021f48239f7a78d10cbbc118336e0ab">SimpZBiOptimizationProcessor::calculateZBi</a>(<span class="keywordtype">double</span> n_on, <span class="keywordtype">double</span> n_off, <span class="keywordtype">double</span> tau){</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordtype">double</span> P_Bi = TMath::BetaIncomplete(1./(1.+tau),n_on,n_off+1);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;P_Bi: &quot;</span> &lt;&lt; P_Bi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordtype">double</span> Z_Bi = std::pow(2,0.5)*TMath::ErfInverse(1-2*P_Bi);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Z_Bi: &quot;</span> &lt;&lt; Z_Bi &lt;&lt; std::endl;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">return</span> Z_Bi;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;}</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a7961dcc96c87a199626f34142123d268">  863</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a7961dcc96c87a199626f34142123d268">SimpZBiOptimizationProcessor::failPersistentCuts</a>(<a class="code" href="classSimpAnaTTree.html">SimpAnaTTree</a>* MTT){</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordtype">bool</span> failCuts = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">for</span>(<a class="code" href="classSimpZBiOptimizationProcessor.html#a9dd204b9bcfb929a721ed80dce297423">cut_iter_</a> it=<a class="code" href="classSimpZBiOptimizationProcessor.html#abf243bc1d985e33c2c3ed6aa6f2b575b">persistentCutsPtr_</a>-&gt;begin(); it!=<a class="code" href="classSimpZBiOptimizationProcessor.html#abf243bc1d985e33c2c3ed6aa6f2b575b">persistentCutsPtr_</a>-&gt;end(); it++){</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        std::string cutname = it-&gt;first;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        std::string cutvar = <a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a74e1be83f732d77738f35a8cbf38d30c">getCutVar</a>(cutname);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="comment">//If no value inside the tuple exists for this cut, do not apply the cut.</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keywordflow">if</span>(!MTT-&gt;<a class="code" href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">variableExists</a>(cutvar))</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">persistentCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#afff63780bb263ad8733f6bc51d7ff637">passCutGTorLT</a>(cutname, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(cutvar))){ </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            failCuts = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">return</span> failCuts;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;}</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a2e5b59fcbe59cc43c06ddac3c5834ab8">  880</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a2e5b59fcbe59cc43c06ddac3c5834ab8">SimpZBiOptimizationProcessor::failTestCut</a>(std::string cutname, <a class="code" href="classSimpAnaTTree.html">SimpAnaTTree</a>* MTT){</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    std::string cutvar = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#a74e1be83f732d77738f35a8cbf38d30c">getCutVar</a>(cutname);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordtype">double</span> cutvalue = <a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classBaseSelector.html#a13e19f5cf3e88d8ae453670a845e39d1">getCut</a>(cutname);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="comment">//If cut variable is not found in the list of tuples, do not apply cut</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">if</span>(!MTT-&gt;<a class="code" href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">variableExists</a>(cutvar))</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">testCutsSelector_</a>-&gt;<a class="code" href="classIterativeCutSelector.html#afff63780bb263ad8733f6bc51d7ff637">passCutGTorLT</a>(cutname, MTT-&gt;<a class="code" href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">getValue</a>(cutvar)))</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;}</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a2d0f7e5040c8afbb25bc6e5f7e55fd83">  893</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a2d0f7e5040c8afbb25bc6e5f7e55fd83">SimpZBiOptimizationProcessor::getSignalMCAnaVtxZ_h</a>(std::string signalMCAnaFilename, </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        std::string signal_pdgid){</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">//Read pre-trigger Signal MCAna vertex z distribution</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <a class="code" href="classSimpZBiOptimizationProcessor.html#adefbf2faf781dbb0f77a9170b1dc353b">signalSimZ_h_</a> = <span class="keyword">new</span> TH1F(<span class="stringliteral">&quot;signal_SimZ_h_&quot;</span>,<span class="stringliteral">&quot;signal_SimZ;true z_{vtx} [mm];events&quot;</span>, 200, -50.3, 149.7);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    TFile* signalMCAnaFile = <span class="keyword">new</span> TFile(<a class="code" href="classSimpZBiOptimizationProcessor.html#ae93f9b7cf124010367eeb7c94fa507c8">signalMCAnaFilename_</a>.c_str(), <span class="stringliteral">&quot;READ&quot;</span>);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    TH1F* mcAnaSimZ_h = (TH1F*)signalMCAnaFile-&gt;Get((<span class="stringliteral">&quot;mcAna/mcAna_mc&quot;</span>+signal_pdgid+<span class="stringliteral">&quot;Z_h&quot;</span>).c_str()); </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; 201; i++){</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <a class="code" href="classSimpZBiOptimizationProcessor.html#adefbf2faf781dbb0f77a9170b1dc353b">signalSimZ_h_</a>-&gt;SetBinContent(i,mcAnaSimZ_h-&gt;GetBinContent(i));</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    signalMCAnaFile-&gt;Close();</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keyword">delete</span> signalMCAnaFile;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;}</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a82c0722e46c2db9b92f0a76f6a32c26e">  906</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a82c0722e46c2db9b92f0a76f6a32c26e">SimpZBiOptimizationProcessor::writeTH1F</a>(TFile* outF, std::string folder, TH1F* h){</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">if</span> (outF) outF-&gt;cd();</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    TDirectory* dir{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    std::cout&lt;&lt;folder.c_str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">if</span> (!folder.empty()) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        dir = outF-&gt;mkdir(folder.c_str(),<span class="stringliteral">&quot;&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        dir-&gt;cd();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    h-&gt;Write();</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;}</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#aaec7b91c34866d747994e7d3bcf65b0c">  917</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#aaec7b91c34866d747994e7d3bcf65b0c">SimpZBiOptimizationProcessor::writeGraph</a>(TFile* outF, std::string folder, TGraph* g){</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span> (outF) outF-&gt;cd();</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    TDirectory* dir{<span class="keyword">nullptr</span>};</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    std::cout&lt;&lt;folder.c_str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span> (!folder.empty()) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        dir = outF-&gt;mkdir(folder.c_str(),<span class="stringliteral">&quot;&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        dir-&gt;cd();</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    g-&gt;Write();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;}</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno"><a class="line" href="classSimpZBiOptimizationProcessor.html#a56143e92286edc69212b9d152046c69f">  928</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classSimpZBiOptimizationProcessor.html#a56143e92286edc69212b9d152046c69f">SimpZBiOptimizationProcessor::round</a>(<span class="keywordtype">double</span> var){</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">//float value = (int)(var * 100 + .5);</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">//return (double)value / 100;</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">return</span> var;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;}</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno"><a class="line" href="SimpZBiOptimizationProcessor_8cxx.html#a91e96777f465e29af8ff01a0882c5a97">  934</a></span>&#160;<a class="code" href="SimpZBiOptimizationProcessor_8cxx.html#a91e96777f465e29af8ff01a0882c5a97">DECLARE_PROCESSOR</a>(<a class="code" href="classSimpZBiOptimizationProcessor.html">SimpZBiOptimizationProcessor</a>);</div>
<div class="ttc" id="aSimpZBiOptimizationProcessor_8cxx_html_a91e96777f465e29af8ff01a0882c5a97"><div class="ttname"><a href="SimpZBiOptimizationProcessor_8cxx.html#a91e96777f465e29af8ff01a0882c5a97">DECLARE_PROCESSOR</a></div><div class="ttdeci">DECLARE_PROCESSOR(SimpZBiOptimizationProcessor)</div></div>
<div class="ttc" id="aSimpZBiOptimizationProcessor_8h_html"><div class="ttname"><a href="SimpZBiOptimizationProcessor_8h.html">SimpZBiOptimizationProcessor.h</a></div></div>
<div class="ttc" id="aclassBaseSelector_html_a13e19f5cf3e88d8ae453670a845e39d1"><div class="ttname"><a href="classBaseSelector.html#a13e19f5cf3e88d8ae453670a845e39d1">BaseSelector::getCut</a></div><div class="ttdeci">float getCut(const std::string &amp;cutname)</div><div class="ttdoc">Get cut values ?</div><div class="ttdef"><b>Definition:</b> <a href="BaseSelector_8h_source.html#l00068">BaseSelector.h:68</a></div></div>
<div class="ttc" id="aclassBaseSelector_html_ab966ed3e4e621296cd6ee56809a86c50"><div class="ttname"><a href="classBaseSelector.html#ab966ed3e4e621296cd6ee56809a86c50">BaseSelector::LoadSelection</a></div><div class="ttdeci">bool LoadSelection()</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="BaseSelector_8cxx_source.html#l00036">BaseSelector.cxx:36</a></div></div>
<div class="ttc" id="aclassIterativeCutSelector_html"><div class="ttname"><a href="classIterativeCutSelector.html">IterativeCutSelector</a></div><div class="ttdoc">brief description</div><div class="ttdef"><b>Definition:</b> <a href="IterativeCutSelector_8h_source.html#l00021">IterativeCutSelector.h:21</a></div></div>
<div class="ttc" id="aclassIterativeCutSelector_html_a113a5942ae474d0e578225b7d11ef6e3"><div class="ttname"><a href="classIterativeCutSelector.html#a113a5942ae474d0e578225b7d11ef6e3">IterativeCutSelector::isCutGreaterThan</a></div><div class="ttdeci">bool isCutGreaterThan(std::string cutname)</div><div class="ttdoc">is cut of type 'greater than'</div><div class="ttdef"><b>Definition:</b> <a href="IterativeCutSelector_8cxx_source.html#l00017">IterativeCutSelector.cxx:17</a></div></div>
<div class="ttc" id="aclassIterativeCutSelector_html_a1afaa4a415f64f97b2e8dc35a6db5075"><div class="ttname"><a href="classIterativeCutSelector.html#a1afaa4a415f64f97b2e8dc35a6db5075">IterativeCutSelector::getPointerToCuts</a></div><div class="ttdeci">std::map&lt; std::string, std::pair&lt; double, int &gt; &gt; * getPointerToCuts()</div><div class="ttdoc">get pointer to the base class cuts</div><div class="ttdef"><b>Definition:</b> <a href="IterativeCutSelector_8h_source.html#l00093">IterativeCutSelector.h:93</a></div></div>
<div class="ttc" id="aclassIterativeCutSelector_html_a74e1be83f732d77738f35a8cbf38d30c"><div class="ttname"><a href="classIterativeCutSelector.html#a74e1be83f732d77738f35a8cbf38d30c">IterativeCutSelector::getCutVar</a></div><div class="ttdeci">std::string getCutVar(std::string cutname)</div><div class="ttdoc">get cut variable from name</div><div class="ttdef"><b>Definition:</b> <a href="IterativeCutSelector_8cxx_source.html#l00025">IterativeCutSelector.cxx:25</a></div></div>
<div class="ttc" id="aclassIterativeCutSelector_html_a8add4a2dd5bda5964b49a08fe7021b71"><div class="ttname"><a href="classIterativeCutSelector.html#a8add4a2dd5bda5964b49a08fe7021b71">IterativeCutSelector::filterCuts</a></div><div class="ttdeci">void filterCuts(std::vector&lt; std::string &gt; cut_variable_list)</div><div class="ttdoc">remove cuts that aren't specified in the list of cut variables</div><div class="ttdef"><b>Definition:</b> <a href="IterativeCutSelector_8cxx_source.html#l00086">IterativeCutSelector.cxx:86</a></div></div>
<div class="ttc" id="aclassIterativeCutSelector_html_a8bef646486a02ac25ff11e87c965cf81"><div class="ttname"><a href="classIterativeCutSelector.html#a8bef646486a02ac25ff11e87c965cf81">IterativeCutSelector::getCutID</a></div><div class="ttdeci">int getCutID(std::string cutname)</div><div class="ttdoc">get cut ID</div><div class="ttdef"><b>Definition:</b> <a href="IterativeCutSelector_8h_source.html#l00079">IterativeCutSelector.h:79</a></div></div>
<div class="ttc" id="aclassIterativeCutSelector_html_ac12e9d2ee0b72aef4a5d9e64dff7fac1"><div class="ttname"><a href="classIterativeCutSelector.html#ac12e9d2ee0b72aef4a5d9e64dff7fac1">IterativeCutSelector::setCutValue</a></div><div class="ttdeci">void setCutValue(std::string cutname, double value)</div><div class="ttdoc">set cut value</div><div class="ttdef"><b>Definition:</b> <a href="IterativeCutSelector_8cxx_source.html#l00044">IterativeCutSelector.cxx:44</a></div></div>
<div class="ttc" id="aclassIterativeCutSelector_html_ac5ab4b717572a809d14a50d6ed2d2ecc"><div class="ttname"><a href="classIterativeCutSelector.html#ac5ab4b717572a809d14a50d6ed2d2ecc">IterativeCutSelector::printCuts</a></div><div class="ttdeci">void printCuts()</div><div class="ttdoc">prints cuts and values</div><div class="ttdef"><b>Definition:</b> <a href="IterativeCutSelector_8cxx_source.html#l00081">IterativeCutSelector.cxx:81</a></div></div>
<div class="ttc" id="aclassIterativeCutSelector_html_afff63780bb263ad8733f6bc51d7ff637"><div class="ttname"><a href="classIterativeCutSelector.html#afff63780bb263ad8733f6bc51d7ff637">IterativeCutSelector::passCutGTorLT</a></div><div class="ttdeci">bool passCutGTorLT(std::string cutname, double val)</div><div class="ttdoc">does value pass cut</div><div class="ttdef"><b>Definition:</b> <a href="IterativeCutSelector_8cxx_source.html#l00055">IterativeCutSelector.cxx:55</a></div></div>
<div class="ttc" id="aclassMutableTTree_html_a0a5f325ea724cf5ae8b763d388fcc126"><div class="ttname"><a href="classMutableTTree.html#a0a5f325ea724cf5ae8b763d388fcc126">MutableTTree::GetEntry</a></div><div class="ttdeci">void GetEntry(int entry)</div><div class="ttdoc">get tree entry</div><div class="ttdef"><b>Definition:</b> <a href="MutableTTree_8h_source.html#l00031">MutableTTree.h:31</a></div></div>
<div class="ttc" id="aclassMutableTTree_html_a125ca3dc2bb650b998b2f8092c234013"><div class="ttname"><a href="classMutableTTree.html#a125ca3dc2bb650b998b2f8092c234013">MutableTTree::defineMassWindow</a></div><div class="ttdeci">void defineMassWindow(double lowMass, double highMass)</div><div class="ttdoc">Set the mass window within which to read the input ttree.</div><div class="ttdef"><b>Definition:</b> <a href="MutableTTree_8cxx_source.html#l00031">MutableTTree.cxx:31</a></div></div>
<div class="ttc" id="aclassMutableTTree_html_a1836a2386c3af919676f8435053672b1"><div class="ttname"><a href="classMutableTTree.html#a1836a2386c3af919676f8435053672b1">MutableTTree::getValue</a></div><div class="ttdeci">double getValue(std::string branch_name)</div><div class="ttdoc">Get the value of a flat tuple variable.</div><div class="ttdef"><b>Definition:</b> <a href="MutableTTree_8cxx_source.html#l00013">MutableTTree.cxx:13</a></div></div>
<div class="ttc" id="aclassMutableTTree_html_a1fdaae294df486df6058ca78bbfbe084"><div class="ttname"><a href="classMutableTTree.html#a1fdaae294df486df6058ca78bbfbe084">MutableTTree::shiftVariable</a></div><div class="ttdeci">void shiftVariable(std::string variable, double shift)</div><div class="ttdoc">Apply any corrections to specified variable.</div><div class="ttdef"><b>Definition:</b> <a href="MutableTTree_8cxx_source.html#l00081">MutableTTree.cxx:81</a></div></div>
<div class="ttc" id="aclassMutableTTree_html_a2e639546d7f534c99014390732155c08"><div class="ttname"><a href="classMutableTTree.html#a2e639546d7f534c99014390732155c08">MutableTTree::GetEntries</a></div><div class="ttdeci">int GetEntries()</div><div class="ttdoc">return number of entries in tree</div><div class="ttdef"><b>Definition:</b> <a href="MutableTTree_8h_source.html#l00025">MutableTTree.h:25</a></div></div>
<div class="ttc" id="aclassMutableTTree_html_a4f8583d3b7c681559a50353e2cd67968"><div class="ttname"><a href="classMutableTTree.html#a4f8583d3b7c681559a50353e2cd67968">MutableTTree::getAllVariables</a></div><div class="ttdeci">std::vector&lt; std::string &gt; getAllVariables()</div><div class="ttdoc">Get list of all variables defined in ttree.</div><div class="ttdef"><b>Definition:</b> <a href="MutableTTree_8cxx_source.html#l00043">MutableTTree.cxx:43</a></div></div>
<div class="ttc" id="aclassMutableTTree_html_ad4c39a1f92a6ddf05d1fb65bc7a43443"><div class="ttname"><a href="classMutableTTree.html#ad4c39a1f92a6ddf05d1fb65bc7a43443">MutableTTree::variableExists</a></div><div class="ttdeci">bool variableExists(std::string variable)</div><div class="ttdoc">Check if a variable exists in the ttree.</div><div class="ttdef"><b>Definition:</b> <a href="MutableTTree_8cxx_source.html#l00036">MutableTTree.cxx:36</a></div></div>
<div class="ttc" id="aclassMutableTTree_html_af5105c0eef86140ad8203af2bf159d57"><div class="ttname"><a href="classMutableTTree.html#af5105c0eef86140ad8203af2bf159d57">MutableTTree::Fill</a></div><div class="ttdeci">void Fill()</div><div class="ttdoc">Fill ttree with new variables included.</div><div class="ttdef"><b>Definition:</b> <a href="MutableTTree_8cxx_source.html#l00052">MutableTTree.cxx:52</a></div></div>
<div class="ttc" id="aclassParameterSet_html"><div class="ttname"><a href="classParameterSet.html">ParameterSet</a></div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="ParameterSet_8h_source.html#l00022">ParameterSet.h:22</a></div></div>
<div class="ttc" id="aclassProcess_html"><div class="ttname"><a href="classProcess.html">Process</a></div><div class="ttdef"><b>Definition:</b> <a href="Process_8h_source.html#l00029">Process.h:29</a></div></div>
<div class="ttc" id="aclassProcessor_html"><div class="ttname"><a href="classProcessor.html">Processor</a></div><div class="ttdoc">Base class for all event processing components.</div><div class="ttdef"><b>Definition:</b> <a href="Processor_8h_source.html#l00034">Processor.h:34</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html"><div class="ttname"><a href="classSimpAnaTTree.html">SimpAnaTTree</a></div><div class="ttdoc">Read in flat TTree and create new cut variables for SIMP analysis.</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8h_source.html#l00017">SimpAnaTTree.h:17</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_a20ec2f6d9613eea61813b6990a55f14f"><div class="ttname"><a href="classSimpAnaTTree.html#a20ec2f6d9613eea61813b6990a55f14f">SimpAnaTTree::addVariable_unc_vtx_pos_zalpha</a></div><div class="ttdeci">void addVariable_unc_vtx_pos_zalpha(double slope)</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00125">SimpAnaTTree.cxx:125</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_a24e8fef4da40fc1225503d83516e227c"><div class="ttname"><a href="classSimpAnaTTree.html#a24e8fef4da40fc1225503d83516e227c">SimpAnaTTree::addVariable_unc_vtx_pos_z0tanlambda_right</a></div><div class="ttdeci">void addVariable_unc_vtx_pos_z0tanlambda_right(double slope)</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00320">SimpAnaTTree.cxx:320</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_a49733965e63f799eb184f9633b2dc95a"><div class="ttname"><a href="classSimpAnaTTree.html#a49733965e63f799eb184f9633b2dc95a">SimpAnaTTree::addVariable_unc_vtx_ele_iso_z0err</a></div><div class="ttdeci">void addVariable_unc_vtx_ele_iso_z0err()</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00204">SimpAnaTTree.cxx:204</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_a4c3e926be46b1de321930ffc2ce249be"><div class="ttname"><a href="classSimpAnaTTree.html#a4c3e926be46b1de321930ffc2ce249be">SimpAnaTTree::addVariable_unc_vtx_pos_isolation_cut</a></div><div class="ttdeci">void addVariable_unc_vtx_pos_isolation_cut()</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00270">SimpAnaTTree.cxx:270</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_a4eb93d6fd05fa70212d84b64e3d643af"><div class="ttname"><a href="classSimpAnaTTree.html#a4eb93d6fd05fa70212d84b64e3d643af">SimpAnaTTree::addVariable_unc_vtx_zalpha_max</a></div><div class="ttdeci">void addVariable_unc_vtx_zalpha_max(double slope)</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00144">SimpAnaTTree.cxx:144</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_a65953f4dab0887a65cfc68a5c83c0829"><div class="ttname"><a href="classSimpAnaTTree.html#a65953f4dab0887a65cfc68a5c83c0829">SimpAnaTTree::addVariable_unc_vtx_pos_z0tanlambda_left</a></div><div class="ttdeci">void addVariable_unc_vtx_pos_z0tanlambda_left(double slope)</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00344">SimpAnaTTree.cxx:344</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_a6aa09f4d5abc140506bb017851c81d06"><div class="ttname"><a href="classSimpAnaTTree.html#a6aa09f4d5abc140506bb017851c81d06">SimpAnaTTree::addVariable_unc_vtx_ele_z0tanlambda_left</a></div><div class="ttdeci">void addVariable_unc_vtx_ele_z0tanlambda_left(double slope)</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00332">SimpAnaTTree.cxx:332</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_a8ad87e6c5766122743a6e95898e3cfec"><div class="ttname"><a href="classSimpAnaTTree.html#a8ad87e6c5766122743a6e95898e3cfec">SimpAnaTTree::addVariable_unc_vtx_pos_z0tanlambda</a></div><div class="ttdeci">void addVariable_unc_vtx_pos_z0tanlambda()</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00296">SimpAnaTTree.cxx:296</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_a901ec6e3cf4bdb97b6f278f14a44cb39"><div class="ttname"><a href="classSimpAnaTTree.html#a901ec6e3cf4bdb97b6f278f14a44cb39">SimpAnaTTree::addVariable_unc_vtx_ele_z0_z0err</a></div><div class="ttdeci">void addVariable_unc_vtx_ele_z0_z0err()</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00230">SimpAnaTTree.cxx:230</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_aa4755add627dc1238159181320cfa05c"><div class="ttname"><a href="classSimpAnaTTree.html#aa4755add627dc1238159181320cfa05c">SimpAnaTTree::addVariable_unc_vtx_pos_iso_z0err</a></div><div class="ttdeci">void addVariable_unc_vtx_pos_iso_z0err()</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00217">SimpAnaTTree.cxx:217</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_aa5c91f060dd3885b94274dbacabdda50"><div class="ttname"><a href="classSimpAnaTTree.html#aa5c91f060dd3885b94274dbacabdda50">SimpAnaTTree::addVariable_unc_vtx_ele_z0tanlambda_right</a></div><div class="ttdeci">void addVariable_unc_vtx_ele_z0tanlambda_right(double slope)</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00308">SimpAnaTTree.cxx:308</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_aaf705bf77c39587413965b88c6f7bf43"><div class="ttname"><a href="classSimpAnaTTree.html#aaf705bf77c39587413965b88c6f7bf43">SimpAnaTTree::addVariable_unc_vtx_ele_isolation_cut</a></div><div class="ttdeci">void addVariable_unc_vtx_ele_isolation_cut()</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00256">SimpAnaTTree.cxx:256</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_ac42f15abcf060833c7b5fde13c162427"><div class="ttname"><a href="classSimpAnaTTree.html#ac42f15abcf060833c7b5fde13c162427">SimpAnaTTree::addVariable_unc_vtx_abs_delta_z0tanlambda</a></div><div class="ttdeci">void addVariable_unc_vtx_abs_delta_z0tanlambda()</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00356">SimpAnaTTree.cxx:356</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_ae311034a97a87207df0c05454fa65611"><div class="ttname"><a href="classSimpAnaTTree.html#ae311034a97a87207df0c05454fa65611">SimpAnaTTree::addVariable_unc_vtx_zalpha_min</a></div><div class="ttdeci">void addVariable_unc_vtx_zalpha_min(double slope)</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00174">SimpAnaTTree.cxx:174</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_af0485e2808affe748593907995f62a0a"><div class="ttname"><a href="classSimpAnaTTree.html#af0485e2808affe748593907995f62a0a">SimpAnaTTree::addVariable_unc_vtx_ele_z0tanlambda</a></div><div class="ttdeci">void addVariable_unc_vtx_ele_z0tanlambda()</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00284">SimpAnaTTree.cxx:284</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_af90b71211720da23ba31839696711df5"><div class="ttname"><a href="classSimpAnaTTree.html#af90b71211720da23ba31839696711df5">SimpAnaTTree::addVariable_unc_vtx_ele_zalpha</a></div><div class="ttdeci">void addVariable_unc_vtx_ele_zalpha(double slope)</div><div class="ttdoc">New Variables.</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00106">SimpAnaTTree.cxx:106</a></div></div>
<div class="ttc" id="aclassSimpAnaTTree_html_afe53c4f505de4a21ab484cdacedcba53"><div class="ttname"><a href="classSimpAnaTTree.html#afe53c4f505de4a21ab484cdacedcba53">SimpAnaTTree::addVariable_unc_vtx_pos_z0_z0err</a></div><div class="ttdeci">void addVariable_unc_vtx_pos_z0_z0err()</div><div class="ttdef"><b>Definition:</b> <a href="SimpAnaTTree_8cxx_source.html#l00243">SimpAnaTTree.cxx:243</a></div></div>
<div class="ttc" id="aclassSimpEquations_html"><div class="ttname"><a href="classSimpEquations.html">SimpEquations</a></div><div class="ttdoc">All SIMP Equations for calculating expected signal.</div><div class="ttdef"><b>Definition:</b> <a href="SimpEquations_8h_source.html#l00013">SimpEquations.h:13</a></div></div>
<div class="ttc" id="aclassSimpEquations_html_a14037703ca07591f98071e4df3a78334"><div class="ttname"><a href="classSimpEquations.html#a14037703ca07591f98071e4df3a78334">SimpEquations::expectedSignalCalculation</a></div><div class="ttdeci">double expectedSignalCalculation(double m_V, double eps, bool rho, double E_V, TEfficiency *effCalc_h, double target_pos, double zcut)</div><div class="ttdef"><b>Definition:</b> <a href="SimpEquations_8cxx_source.html#l00240">SimpEquations.cxx:240</a></div></div>
<div class="ttc" id="aclassSimpEquations_html_a501e2d5e367a5be02a79dc35a8e9abd3"><div class="ttname"><a href="classSimpEquations.html#a501e2d5e367a5be02a79dc35a8e9abd3">SimpEquations::getAprimeMassFromVectorMass</a></div><div class="ttdeci">double getAprimeMassFromVectorMass(double m_V)</div><div class="ttdef"><b>Definition:</b> <a href="SimpEquations_8h_source.html#l00076">SimpEquations.h:76</a></div></div>
<div class="ttc" id="aclassSimpEquations_html_ae61345adc053e0f73d17d907b341de95"><div class="ttname"><a href="classSimpEquations.html#ae61345adc053e0f73d17d907b341de95">SimpEquations::massResolution</a></div><div class="ttdeci">double massResolution(double m_V)</div><div class="ttdef"><b>Definition:</b> <a href="SimpEquations_8cxx_source.html#l00339">SimpEquations.cxx:339</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html">SimpZBiOptimizationProcessor</a></div><div class="ttdoc">Cutflow optimization tool for SIMPS.</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00031">SimpZBiOptimizationProcessor.h:31</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a01f0a33e01feb4d97a76445fefde494a"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a01f0a33e01feb4d97a76445fefde494a">SimpZBiOptimizationProcessor::persistentCutsSelector_</a></div><div class="ttdeci">IterativeCutSelector * persistentCutsSelector_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00172">SimpZBiOptimizationProcessor.h:172</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a0e062316cf8cec8f26c814782870a67d"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a0e062316cf8cec8f26c814782870a67d">SimpZBiOptimizationProcessor::E_Vd_</a></div><div class="ttdeci">double E_Vd_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00157">SimpZBiOptimizationProcessor.h:157</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a1021f48239f7a78d10cbbc118336e0ab"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a1021f48239f7a78d10cbbc118336e0ab">SimpZBiOptimizationProcessor::calculateZBi</a></div><div class="ttdeci">double calculateZBi(double n_on, double n_off, double tau)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00855">SimpZBiOptimizationProcessor.cxx:855</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a1185bf9f80b6a16684fad9dec253bb97"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a1185bf9f80b6a16684fad9dec253bb97">SimpZBiOptimizationProcessor::logEps2_</a></div><div class="ttdeci">double logEps2_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00154">SimpZBiOptimizationProcessor.h:154</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a15bf37530b47266a0fb5550fb2c88e4e"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a15bf37530b47266a0fb5550fb2c88e4e">SimpZBiOptimizationProcessor::variableHistCfgFilename_</a></div><div class="ttdeci">std::string variableHistCfgFilename_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00144">SimpZBiOptimizationProcessor.h:144</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a171c1df7d8feb12db465a1fc755cc614"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a171c1df7d8feb12db465a1fc755cc614">SimpZBiOptimizationProcessor::signalVtxMCSelection_</a></div><div class="ttdeci">std::string signalVtxMCSelection_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00147">SimpZBiOptimizationProcessor.h:147</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a174d7e034f9a94c6d3d7300d72ba4d1d"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a174d7e034f9a94c6d3d7300d72ba4d1d">SimpZBiOptimizationProcessor::debug_</a></div><div class="ttdeci">int debug_</div><div class="ttdoc">//&lt;! description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00123">SimpZBiOptimizationProcessor.h:123</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a179ff262182aa5a0e2dd800a8f5b1252"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a179ff262182aa5a0e2dd800a8f5b1252">SimpZBiOptimizationProcessor::new_variable_params_</a></div><div class="ttdeci">std::vector&lt; double &gt; new_variable_params_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00130">SimpZBiOptimizationProcessor.h:130</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a1a29d28b4ccc338b9704942daaebcd6a"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a1a29d28b4ccc338b9704942daaebcd6a">SimpZBiOptimizationProcessor::signalVtxAnaFilename_</a></div><div class="ttdeci">std::string signalVtxAnaFilename_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00145">SimpZBiOptimizationProcessor.h:145</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a1ce8ae610e17bd2b6a31b6b20867c863"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a1ce8ae610e17bd2b6a31b6b20867c863">SimpZBiOptimizationProcessor::bkgHistos_</a></div><div class="ttdeci">std::shared_ptr&lt; ZBiHistos &gt; bkgHistos_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00161">SimpZBiOptimizationProcessor.h:161</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a222ffe169dde2cbf566830b296adc5ab"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a222ffe169dde2cbf566830b296adc5ab">SimpZBiOptimizationProcessor::fillEventHistograms</a></div><div class="ttdeci">void fillEventHistograms(std::shared_ptr&lt; ZBiHistos &gt; histos, SimpAnaTTree *MTT)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00126">SimpZBiOptimizationProcessor.cxx:126</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a28936b5e7dad5cac4572c2e47464519e"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a28936b5e7dad5cac4572c2e47464519e">SimpZBiOptimizationProcessor::configure</a></div><div class="ttdeci">virtual void configure(const ParameterSet &amp;parameters)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00014">SimpZBiOptimizationProcessor.cxx:14</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a2c45220d6b9f66a6547795231bcc7828"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a2c45220d6b9f66a6547795231bcc7828">SimpZBiOptimizationProcessor::countControlRegionBackgroundRate</a></div><div class="ttdeci">double countControlRegionBackgroundRate(std::string inFilename, std::string tree_name, double m_Ap, double Mbin=30.0, double dNdm_sf=1.0)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00229">SimpZBiOptimizationProcessor.cxx:229</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a2d0f7e5040c8afbb25bc6e5f7e55fd83"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a2d0f7e5040c8afbb25bc6e5f7e55fd83">SimpZBiOptimizationProcessor::getSignalMCAnaVtxZ_h</a></div><div class="ttdeci">void getSignalMCAnaVtxZ_h(std::string signalMCAnaFilename, std::string signal_pdgid)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00893">SimpZBiOptimizationProcessor.cxx:893</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a2e5b59fcbe59cc43c06ddac3c5834ab8"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a2e5b59fcbe59cc43c06ddac3c5834ab8">SimpZBiOptimizationProcessor::failTestCut</a></div><div class="ttdeci">bool failTestCut(std::string cutname, SimpAnaTTree *MTT)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00880">SimpZBiOptimizationProcessor.cxx:880</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a302363129fdcaea35ea923d7a674f196"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a302363129fdcaea35ea923d7a674f196">SimpZBiOptimizationProcessor::initialize</a></div><div class="ttdeci">virtual void initialize(TTree *tree)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00047">SimpZBiOptimizationProcessor.h:47</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a32090166ec7f47f8e0d14ade88428e98"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a32090166ec7f47f8e0d14ade88428e98">SimpZBiOptimizationProcessor::cutVariables_</a></div><div class="ttdeci">std::vector&lt; std::string &gt; cutVariables_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00128">SimpZBiOptimizationProcessor.h:128</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a321310250a061890cdbf7c6d908b9255"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a321310250a061890cdbf7c6d908b9255">SimpZBiOptimizationProcessor::outFile_</a></div><div class="ttdeci">TFile * outFile_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00127">SimpZBiOptimizationProcessor.h:127</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a32d626626eee0bc4ade146973f6abb1c"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a32d626626eee0bc4ade146973f6abb1c">SimpZBiOptimizationProcessor::finalize</a></div><div class="ttdeci">virtual void finalize()</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00843">SimpZBiOptimizationProcessor.cxx:843</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a3878c7905bab66dc93e8b7fb78ce82d1"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a3878c7905bab66dc93e8b7fb78ce82d1">SimpZBiOptimizationProcessor::new_variables_</a></div><div class="ttdeci">std::vector&lt; std::string &gt; new_variables_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00129">SimpZBiOptimizationProcessor.h:129</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a40fb1b0197c5518558d2267c54079ef0"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a40fb1b0197c5518558d2267c54079ef0">SimpZBiOptimizationProcessor::bkgMTT_</a></div><div class="ttdeci">SimpAnaTTree * bkgMTT_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00139">SimpZBiOptimizationProcessor.h:139</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a436b3ef210248ba342a89f10c9aa8b85"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a436b3ef210248ba342a89f10c9aa8b85">SimpZBiOptimizationProcessor::signalVtxAnaTreename_</a></div><div class="ttdeci">std::string signalVtxAnaTreename_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00146">SimpZBiOptimizationProcessor.h:146</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a436e1589148888d95fb9a2d1b34d09f3"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a436e1589148888d95fb9a2d1b34d09f3">SimpZBiOptimizationProcessor::signal_mass_</a></div><div class="ttdeci">double signal_mass_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00153">SimpZBiOptimizationProcessor.h:153</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a506b1e98594ce7268efc8551dd54dd61"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a506b1e98594ce7268efc8551dd54dd61">SimpZBiOptimizationProcessor::eq_cfgFile_</a></div><div class="ttdeci">std::string eq_cfgFile_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00131">SimpZBiOptimizationProcessor.h:131</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a56143e92286edc69212b9d152046c69f"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a56143e92286edc69212b9d152046c69f">SimpZBiOptimizationProcessor::round</a></div><div class="ttdeci">double round(double var)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00928">SimpZBiOptimizationProcessor.cxx:928</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a5bf2d69e69ecf1823e89035105473dc4"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a5bf2d69e69ecf1823e89035105473dc4">SimpZBiOptimizationProcessor::outFileName_</a></div><div class="ttdeci">std::string outFileName_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00126">SimpZBiOptimizationProcessor.h:126</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a5e954bf07ab1dac5ff7249cebb094545"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a5e954bf07ab1dac5ff7249cebb094545">SimpZBiOptimizationProcessor::bkgVtxAnaTreename_</a></div><div class="ttdeci">std::string bkgVtxAnaTreename_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00138">SimpZBiOptimizationProcessor.h:138</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a602747f34e77a5d169f343951c4c95bd"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a602747f34e77a5d169f343951c4c95bd">SimpZBiOptimizationProcessor::dNdm_</a></div><div class="ttdeci">double dNdm_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00186">SimpZBiOptimizationProcessor.h:186</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a7961dcc96c87a199626f34142123d268"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a7961dcc96c87a199626f34142123d268">SimpZBiOptimizationProcessor::failPersistentCuts</a></div><div class="ttdeci">bool failPersistentCuts(SimpAnaTTree *MTT)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00863">SimpZBiOptimizationProcessor.cxx:863</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a8079093abe734825b55fcd9dc4dae32a"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a8079093abe734825b55fcd9dc4dae32a">SimpZBiOptimizationProcessor::background_sf_</a></div><div class="ttdeci">double background_sf_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00141">SimpZBiOptimizationProcessor.h:141</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a82a5ab7d19b7efc405000d51884d1e42"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a82a5ab7d19b7efc405000d51884d1e42">SimpZBiOptimizationProcessor::year_</a></div><div class="ttdeci">int year_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00124">SimpZBiOptimizationProcessor.h:124</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a82c0722e46c2db9b92f0a76f6a32c26e"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a82c0722e46c2db9b92f0a76f6a32c26e">SimpZBiOptimizationProcessor::writeTH1F</a></div><div class="ttdeci">void writeTH1F(TFile *outF, std::string folder, TH1F *h)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00906">SimpZBiOptimizationProcessor.cxx:906</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a8faef2f19bcc75ff9144a8b453b47f6d"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a8faef2f19bcc75ff9144a8b453b47f6d">SimpZBiOptimizationProcessor::dNdm_sf_</a></div><div class="ttdeci">double dNdm_sf_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00187">SimpZBiOptimizationProcessor.h:187</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a9784b8ec5cfe672496b1ef31973cfbad"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a9784b8ec5cfe672496b1ef31973cfbad">SimpZBiOptimizationProcessor::radAcc_</a></div><div class="ttdeci">double radAcc_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00185">SimpZBiOptimizationProcessor.h:185</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_a9dd204b9bcfb929a721ed80dce297423"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#a9dd204b9bcfb929a721ed80dce297423">SimpZBiOptimizationProcessor::cut_iter_</a></div><div class="ttdeci">std::map&lt; std::string, std::pair&lt; double, int &gt; &gt;::iterator cut_iter_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00166">SimpZBiOptimizationProcessor.h:166</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_aa248deec58b67ef14faaa8087971e5f1"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#aa248deec58b67ef14faaa8087971e5f1">SimpZBiOptimizationProcessor::cuts_cfgFile_</a></div><div class="ttdeci">std::string cuts_cfgFile_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00125">SimpZBiOptimizationProcessor.h:125</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_aa5ccc69ab0b3fe24b4bcc920c703fbc2"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#aa5ccc69ab0b3fe24b4bcc920c703fbc2">SimpZBiOptimizationProcessor::radFrac_</a></div><div class="ttdeci">double radFrac_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00184">SimpZBiOptimizationProcessor.h:184</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_aa5ebedab715596f9cc1529bab0b9209e"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#aa5ebedab715596f9cc1529bab0b9209e">SimpZBiOptimizationProcessor::massResolution_</a></div><div class="ttdeci">double massResolution_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00155">SimpZBiOptimizationProcessor.h:155</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_aaec7b91c34866d747994e7d3bcf65b0c"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#aaec7b91c34866d747994e7d3bcf65b0c">SimpZBiOptimizationProcessor::writeGraph</a></div><div class="ttdeci">void writeGraph(TFile *outF, std::string folder, TGraph *g)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00917">SimpZBiOptimizationProcessor.cxx:917</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ab23bbfae6194a28cace72f874a461d92"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ab23bbfae6194a28cace72f874a461d92">SimpZBiOptimizationProcessor::mass_window_nsigma_</a></div><div class="ttdeci">double mass_window_nsigma_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00156">SimpZBiOptimizationProcessor.h:156</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ab3175da1cd774b5d136e5b4c9810db75"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ab3175da1cd774b5d136e5b4c9810db75">SimpZBiOptimizationProcessor::testCutsPtr_</a></div><div class="ttdeci">std::map&lt; std::string, std::pair&lt; double, int &gt; &gt; * testCutsPtr_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00171">SimpZBiOptimizationProcessor.h:171</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ab5a708fd4312459a5d0742422759f4fa"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ab5a708fd4312459a5d0742422759f4fa">SimpZBiOptimizationProcessor::min_ztail_events_</a></div><div class="ttdeci">double min_ztail_events_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00140">SimpZBiOptimizationProcessor.h:140</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_abbd9e048651de8fcd4020e5d03504fa5"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#abbd9e048651de8fcd4020e5d03504fa5">SimpZBiOptimizationProcessor::bkgControlRegionFilename_</a></div><div class="ttdeci">std::string bkgControlRegionFilename_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00188">SimpZBiOptimizationProcessor.h:188</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_abc94c70e45327cc430d6c61491953cf5"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#abc94c70e45327cc430d6c61491953cf5">SimpZBiOptimizationProcessor::processorHistos_</a></div><div class="ttdeci">std::shared_ptr&lt; ZBiHistos &gt; processorHistos_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00163">SimpZBiOptimizationProcessor.h:163</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_abca87f02b9f2b4f64f3fdc89bb19a8df"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#abca87f02b9f2b4f64f3fdc89bb19a8df">SimpZBiOptimizationProcessor::addNewVariables</a></div><div class="ttdeci">void addNewVariables(SimpAnaTTree *MTT, std::string variable, double param)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00072">SimpZBiOptimizationProcessor.cxx:72</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_abf243bc1d985e33c2c3ed6aa6f2b575b"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#abf243bc1d985e33c2c3ed6aa6f2b575b">SimpZBiOptimizationProcessor::persistentCutsPtr_</a></div><div class="ttdeci">std::map&lt; std::string, std::pair&lt; double, int &gt; &gt; * persistentCutsPtr_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00173">SimpZBiOptimizationProcessor.h:173</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_abfd55164b50d9022f72c47def5b9d378"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#abfd55164b50d9022f72c47def5b9d378">SimpZBiOptimizationProcessor::~SimpZBiOptimizationProcessor</a></div><div class="ttdeci">~SimpZBiOptimizationProcessor()</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00012">SimpZBiOptimizationProcessor.cxx:12</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ac652ff2b7c1d4d08fdd703da91396f0a"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ac652ff2b7c1d4d08fdd703da91396f0a">SimpZBiOptimizationProcessor::signalHistos_</a></div><div class="ttdeci">std::shared_ptr&lt; ZBiHistos &gt; signalHistos_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00160">SimpZBiOptimizationProcessor.h:160</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ac6922f4d6dc9a356c2d0debea6bbd3ac"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ac6922f4d6dc9a356c2d0debea6bbd3ac">SimpZBiOptimizationProcessor::max_iteration_</a></div><div class="ttdeci">int max_iteration_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00134">SimpZBiOptimizationProcessor.h:134</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ac713bd14fb00c4d79599ff8e0f4788d9"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ac713bd14fb00c4d79599ff8e0f4788d9">SimpZBiOptimizationProcessor::initialIntegrals_</a></div><div class="ttdeci">std::map&lt; std::string, double &gt; initialIntegrals_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00167">SimpZBiOptimizationProcessor.h:167</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ac76d1c6b5fe07d0972a978dc423dfccb"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ac76d1c6b5fe07d0972a978dc423dfccb">SimpZBiOptimizationProcessor::testCutHistos_</a></div><div class="ttdeci">std::shared_ptr&lt; ZBiHistos &gt; testCutHistos_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00162">SimpZBiOptimizationProcessor.h:162</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ace5518f052257b18d5fa89e271d18d0f"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ace5518f052257b18d5fa89e271d18d0f">SimpZBiOptimizationProcessor::signal_pdgid_</a></div><div class="ttdeci">std::string signal_pdgid_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00149">SimpZBiOptimizationProcessor.h:149</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ad5f8f268208e6faa808723fa680f5a7f"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ad5f8f268208e6faa808723fa680f5a7f">SimpZBiOptimizationProcessor::simpEqs_</a></div><div class="ttdeci">SimpEquations * simpEqs_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00181">SimpZBiOptimizationProcessor.h:181</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ad6b8b2cbeed86c3fa2425467a2eef5fa"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ad6b8b2cbeed86c3fa2425467a2eef5fa">SimpZBiOptimizationProcessor::lowMass_</a></div><div class="ttdeci">double lowMass_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00193">SimpZBiOptimizationProcessor.h:193</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ad6d310aa59d62027cf6d383fe87cf5f9"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ad6d310aa59d62027cf6d383fe87cf5f9">SimpZBiOptimizationProcessor::SimpZBiOptimizationProcessor</a></div><div class="ttdeci">SimpZBiOptimizationProcessor(const std::string &amp;name, Process &amp;process)</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00007">SimpZBiOptimizationProcessor.cxx:7</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ad8a64f94c00543cfde1e12e264da2fe0"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ad8a64f94c00543cfde1e12e264da2fe0">SimpZBiOptimizationProcessor::bkgVtxAnaFilename_</a></div><div class="ttdeci">std::string bkgVtxAnaFilename_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00137">SimpZBiOptimizationProcessor.h:137</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_adb1b8473d77d4172c13e742844431f64"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#adb1b8473d77d4172c13e742844431f64">SimpZBiOptimizationProcessor::step_size_</a></div><div class="ttdeci">double step_size_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00133">SimpZBiOptimizationProcessor.h:133</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_adc82ce333c65afb1a08e72cf329a3ad3"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#adc82ce333c65afb1a08e72cf329a3ad3">SimpZBiOptimizationProcessor::highMass_</a></div><div class="ttdeci">double highMass_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00192">SimpZBiOptimizationProcessor.h:192</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_adefbf2faf781dbb0f77a9170b1dc353b"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#adefbf2faf781dbb0f77a9170b1dc353b">SimpZBiOptimizationProcessor::signalSimZ_h_</a></div><div class="ttdeci">TH1F * signalSimZ_h_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00150">SimpZBiOptimizationProcessor.h:150</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ae87886ccab8983b4838ee892fa4c210b"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ae87886ccab8983b4838ee892fa4c210b">SimpZBiOptimizationProcessor::scan_zcut_</a></div><div class="ttdeci">bool scan_zcut_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00132">SimpZBiOptimizationProcessor.h:132</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_ae93f9b7cf124010367eeb7c94fa507c8"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#ae93f9b7cf124010367eeb7c94fa507c8">SimpZBiOptimizationProcessor::signalMCAnaFilename_</a></div><div class="ttdeci">std::string signalMCAnaFilename_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00148">SimpZBiOptimizationProcessor.h:148</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_aeaa62a153d6926128114519c9346ac97"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#aeaa62a153d6926128114519c9346ac97">SimpZBiOptimizationProcessor::signalMTT_</a></div><div class="ttdeci">SimpAnaTTree * signalMTT_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00151">SimpZBiOptimizationProcessor.h:151</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_aee57f0c2237e29a1579d7b8bef83a083"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#aee57f0c2237e29a1579d7b8bef83a083">SimpZBiOptimizationProcessor::bkgControlRegionTreename_</a></div><div class="ttdeci">std::string bkgControlRegionTreename_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00189">SimpZBiOptimizationProcessor.h:189</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_af268a62c13246b74b5428a296cdf714a"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#af268a62c13246b74b5428a296cdf714a">SimpZBiOptimizationProcessor::process</a></div><div class="ttdeci">virtual bool process()</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8cxx_source.html#l00398">SimpZBiOptimizationProcessor.cxx:398</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_af8cf29d3d98b60a30ad1441665e1d22e"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#af8cf29d3d98b60a30ad1441665e1d22e">SimpZBiOptimizationProcessor::signal_sf_</a></div><div class="ttdeci">double signal_sf_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00152">SimpZBiOptimizationProcessor.h:152</a></div></div>
<div class="ttc" id="aclassSimpZBiOptimizationProcessor_html_af9b9a8ab8e0a2f2f0333c1e73167f348"><div class="ttname"><a href="classSimpZBiOptimizationProcessor.html#af9b9a8ab8e0a2f2f0333c1e73167f348">SimpZBiOptimizationProcessor::testCutsSelector_</a></div><div class="ttdeci">IterativeCutSelector * testCutsSelector_</div><div class="ttdef"><b>Definition:</b> <a href="SimpZBiOptimizationProcessor_8h_source.html#l00170">SimpZBiOptimizationProcessor.h:170</a></div></div>
<div class="ttc" id="anamespaceconfig_1_1anaBhTuple__cfg_html_a61569f2965b7a369eb10b6d75d410d11"><div class="ttname"><a href="namespaceconfig_1_1anaBhTuple__cfg.html#a61569f2965b7a369eb10b6d75d410d11">config.anaBhTuple_cfg.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="anaBhTuple__cfg_8py_source.html#l00006">anaBhTuple_cfg.py:6</a></div></div>
<div class="ttc" id="anamespaceconfig_1_1anaKalSimpTuple__cfg_html_ad827090038061f4a04a789ab61df8c1d"><div class="ttname"><a href="namespaceconfig_1_1anaKalSimpTuple__cfg.html#ad827090038061f4a04a789ab61df8c1d">config.anaKalSimpTuple_cfg.parameters</a></div><div class="ttdeci">parameters</div><div class="ttdef"><b>Definition:</b> <a href="anaKalSimpTuple__cfg_8py_source.html#l00085">anaKalSimpTuple_cfg.py:85</a></div></div>
<div class="ttc" id="anamespaceconfig_1_1anaTrackHits__cfg_html_a284eaa73fc00d296c01f7af1d7b36ad6"><div class="ttname"><a href="namespaceconfig_1_1anaTrackHits__cfg.html#a284eaa73fc00d296c01f7af1d7b36ad6">config.anaTrackHits_cfg.inFilename</a></div><div class="ttdeci">inFilename</div><div class="ttdef"><b>Definition:</b> <a href="anaTrackHits__cfg_8py_source.html#l00009">anaTrackHits_cfg.py:9</a></div></div>
<div class="ttc" id="anamespaceconfig_1_1anaTrackHits__cfg_html_a920b99d304bd717f4197afc33496f978"><div class="ttname"><a href="namespaceconfig_1_1anaTrackHits__cfg.html#a920b99d304bd717f4197afc33496f978">config.anaTrackHits_cfg.outFilename</a></div><div class="ttdeci">outFilename</div><div class="ttdef"><b>Definition:</b> <a href="anaTrackHits__cfg_8py_source.html#l00010">anaTrackHits_cfg.py:10</a></div></div>
<div class="ttc" id="anamespaceconfig_1_1simp__zbi__config_html_a5acc9840ebad7cf498e568185d30badc"><div class="ttname"><a href="namespaceconfig_1_1simp__zbi__config.html#a5acc9840ebad7cf498e568185d30badc">config.simp_zbi_config.m_Ap</a></div><div class="ttdeci">m_Ap</div><div class="ttdef"><b>Definition:</b> <a href="simp__zbi__config_8py_source.html#l00109">simp_zbi_config.py:109</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
