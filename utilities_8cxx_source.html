<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hpstr: processors/src/utilities.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">hpstr
   </div>
   <div id="projectbrief">The Heavy Photon Search Toolkit for Reconstruction (hpstr) provides an interface to physics data from the HPS experiment saved in the LCIO format and converts it into an ROOT based format.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4ac0cf52b60bedb296701740c5b274e6.html">processors</a></li><li class="navelem"><a class="el" href="dir_f51cfae32239c0a2b15b7972d5cbb270.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">utilities.cxx</div></div>
</div><!--header-->
<div class="contents">
<a href="utilities_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &quot;<a class="code" href="utilities_8h.html">utilities.h</a>&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">/*</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">   void utils::buildTrackCollection(std::vector&lt;Track*&gt;&amp; tracks, </span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">   Event* event,</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">   const char* LCTrackCollection)</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">   {</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"></span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">   EVENT::LCCollection* lc_tracks event-&gt;getLCCollection(LCTrackCollection);</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"></span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"></span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">   }</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"></span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">*/</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="foldopen" id="foldopen00018" data-start="{" data-end="}">
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno"><a class="line" href="namespaceutils.html#a3fa61a8f1fe762d57473f3193181a256">   18</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="namespaceutils.html#a3fa61a8f1fe762d57473f3193181a256">utils::hasCollection</a>(EVENT::LCEvent* lc_event,<span class="keyword">const</span> std::string&amp; collection) {</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    <span class="keywordflow">if</span> (!lc_event || collection.empty())</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    <span class="keyword">auto</span> evColls = lc_event-&gt;getCollectionNames();</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    <span class="keyword">auto</span> it = std::find(evColls-&gt;begin(),evColls-&gt;end(), collection);</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>    <span class="keywordflow">if</span> (it!=evColls-&gt;end()) </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>}</div>
</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="foldopen" id="foldopen00031" data-start="{" data-end="}">
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="namespaceutils.html#a38245351b04f5e711d627819b932fbd4">   31</a></span><a class="code hl_class" href="classVertex.html">Vertex</a>* <a class="code hl_function" href="namespaceutils.html#a38245351b04f5e711d627819b932fbd4">utils::buildVertex</a>(EVENT::Vertex* lc_vertex) { </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    <span class="keywordflow">if</span> (!lc_vertex) </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    <span class="comment">//TODO move the static cast outside?</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    <a class="code hl_class" href="classVertex.html">Vertex</a>* vertex = <span class="keyword">new</span> <a class="code hl_class" href="classVertex.html">Vertex</a>();</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    vertex-&gt;<a class="code hl_function" href="classVertex.html#add635266c1cc210bb98622624a1e873f">setChi2</a>         (lc_vertex-&gt;getChi2());</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    vertex-&gt;<a class="code hl_function" href="classVertex.html#aa5fdb14072b54286239e89d73a49c073">setProbability</a>  (lc_vertex-&gt;getProbability());</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    vertex-&gt;<a class="code hl_function" href="classVertex.html#a5f000855db408e735c6bc7ac6c39289c">setID</a>           (lc_vertex-&gt;id());</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    vertex-&gt;<a class="code hl_function" href="classVertex.html#a9d98a59d4453e8b71e36dff35da0ea8d">setType</a>         (lc_vertex-&gt;getAlgorithmType());</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    vertex-&gt;<a class="code hl_function" href="classVertex.html#a38718cd3b3eaea72e89eed3915035c95">setVtxParameters</a>((std::vector&lt;float&gt;)lc_vertex-&gt;getParameters());</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span> </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    <span class="comment">//TODO Rotate the covariance matrix!</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    vertex-&gt;<a class="code hl_function" href="classVertex.html#acdcc221127f2db7b58a83ad7832fa493">setCovariance</a>   ((std::vector&lt;float&gt;)lc_vertex-&gt;getCovMatrix());</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="comment">//std::cout&lt;&lt;lc_vertex-&gt;getVertexParameterNames[0]&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    vertex-&gt;<a class="code hl_function" href="classVertex.html#a9d98a59d4453e8b71e36dff35da0ea8d">setType</a>         (lc_vertex-&gt;getAlgorithmType());</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    vertex-&gt;<a class="code hl_function" href="classVertex.html#a1a189ebe733bd13292d9f3b7cece97c2">setPos</a>          (lc_vertex-&gt;getPosition(),<span class="keyword">false</span>);</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    <span class="keywordflow">return</span> vertex;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>}</div>
</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="foldopen" id="foldopen00056" data-start="{" data-end="}">
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno"><a class="line" href="namespaceutils.html#a7f0793ae3975d895fb1306504c017110">   56</a></span><a class="code hl_class" href="classParticle.html">Particle</a>* <a class="code hl_function" href="namespaceutils.html#a7f0793ae3975d895fb1306504c017110">utils::buildParticle</a>(EVENT::ReconstructedParticle* lc_particle,</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>        std::string trackstate_location,</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>        EVENT::LCCollection* gbl_kink_data,</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>        EVENT::LCCollection* track_data)</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span> </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>{ </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="keywordflow">if</span> (!lc_particle) </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <a class="code hl_class" href="classParticle.html">Particle</a>* part = <span class="keyword">new</span> <a class="code hl_class" href="classParticle.html">Particle</a>();</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="comment">// Set the charge of the HpsParticle    </span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    part-&gt;<a class="code hl_function" href="classParticle.html#a8b3ca2d37e7a5399465649fb5fb49096">setCharge</a>(lc_particle-&gt;getCharge());</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <span class="comment">// Set the HpsParticle type</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    part-&gt;<a class="code hl_function" href="classParticle.html#a96c2b792855a6d73ae08e9f56d46a9ad">setType</a>(lc_particle-&gt;getType());</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="comment">// Set the energy of the HpsParticle</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    part-&gt;<a class="code hl_function" href="classParticle.html#aa89352316465c459725ccb5610b19dd9">setEnergy</a>(lc_particle-&gt;getEnergy());</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <span class="comment">// Set the momentum of the HpsParticle</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    part-&gt;<a class="code hl_function" href="classParticle.html#a9a246cac55a414742052bc8f46218c6e">setMomentum</a>(lc_particle-&gt;getMomentum());</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    <span class="comment">// Set the mass of the HpsParticle</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    part-&gt;<a class="code hl_function" href="classParticle.html#a50065a7bcb4b384286dfc32e0d06d3b7">setMass</a>(lc_particle-&gt;getMass());</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="comment">// Set the goodness of PID for the HpsParticle</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    part-&gt;<a class="code hl_function" href="classParticle.html#a4ec278fd10816831508c72e35d461e17">setGoodnessOfPID</a>(lc_particle-&gt;getGoodnessOfPID());</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="comment">// Set the PDG ID for the HpsParticle</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    part-&gt;<a class="code hl_function" href="classParticle.html#a4f0e9db32ad4b89b376a4b6a20cf0fcf">setPDG</a>(lc_particle-&gt;getParticleIDUsed()-&gt;getPDG());</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <span class="comment">// Set the Track for the HpsParticle</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    <span class="keywordflow">if</span> (lc_particle-&gt;getTracks().size()&gt;0)</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    {</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        <a class="code hl_class" href="classTrack.html">Track</a> * trkPtr = <a class="code hl_function" href="namespaceutils.html#a331cab836b576d7a988d81e008242528">utils::buildTrack</a>(lc_particle-&gt;getTracks()[0],trackstate_location, gbl_kink_data, track_data);</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>        part-&gt;<a class="code hl_function" href="classParticle.html#aa2dd28c594c2b4ff2fc590c053067a47">setTrack</a>(trkPtr);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <span class="keyword">delete</span> trkPtr;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    }</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="comment">// Set the Track for the HpsParticle</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    <span class="keywordflow">if</span> (lc_particle-&gt;getClusters().size() &gt; 0)</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    {</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        <a class="code hl_class" href="classCalCluster.html">CalCluster</a> * clusBuf = <a class="code hl_function" href="namespaceutils.html#a2d01ad798936250108f868400e1e3051">utils::buildCalCluster</a>(lc_particle-&gt;getClusters()[0]);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>        part-&gt;<a class="code hl_function" href="classParticle.html#ab83ad18659c25efdb72bd9c7c6f11189">setCluster</a>(clusBuf);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>        <span class="keyword">delete</span> clusBuf;</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    }</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <span class="keywordflow">return</span> part;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>}</div>
</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="foldopen" id="foldopen00107" data-start="{" data-end="}">
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="namespaceutils.html#a2d01ad798936250108f868400e1e3051">  107</a></span><a class="code hl_class" href="classCalCluster.html">CalCluster</a>* <a class="code hl_function" href="namespaceutils.html#a2d01ad798936250108f868400e1e3051">utils::buildCalCluster</a>(EVENT::Cluster* lc_cluster) </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>{ </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <span class="keywordflow">if</span> (!lc_cluster) </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <a class="code hl_class" href="classCalCluster.html">CalCluster</a>* cluster = <span class="keyword">new</span> <a class="code hl_class" href="classCalCluster.html">CalCluster</a>();</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    <span class="comment">// Set the cluster position</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    cluster-&gt;<a class="code hl_function" href="classCalCluster.html#a22f0c3dd9d115832baf9e9ccecbee37f">setPosition</a>(lc_cluster-&gt;getPosition());</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    <span class="comment">// Set the cluster energy</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    cluster-&gt;<a class="code hl_function" href="classCalCluster.html#aa89352316465c459725ccb5610b19dd9">setEnergy</a>(lc_cluster-&gt;getEnergy());</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="comment">// Get the ecal hits used to create the cluster</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    EVENT::CalorimeterHitVec lc_hits = lc_cluster-&gt;getCalorimeterHits();</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    <span class="comment">// Loop over all of the Ecal hits and add them to the Ecal cluster.  The</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    <span class="comment">// seed hit is set to be the hit with the highest energy.  The cluster time</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <span class="comment">// is set to be the hit time of the seed hit.</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="keywordtype">double</span> senergy = 0;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    <span class="keywordtype">double</span> stime = 0;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ihit = 0; ihit &lt; (int) lc_hits.size(); ++ihit) {</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        <span class="comment">// Get an Ecal hit</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>        EVENT::CalorimeterHit* lc_hit  = lc_hits[ihit];</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>        <span class="keywordflow">if</span> (senergy &lt; lc_hit-&gt;getEnergy()) {</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>            senergy = lc_hit-&gt;getEnergy();</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>            stime = lc_hit-&gt;getTime();</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>        }</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    }</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <span class="comment">// Set the time of the cluster</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    cluster-&gt;<a class="code hl_function" href="classCalCluster.html#acb0ffd73929350f517aeba27c9463e7f">setTime</a>(stime);</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span> </div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="keywordflow">return</span> cluster;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>}</div>
</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="foldopen" id="foldopen00143" data-start="{" data-end="}">
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno"><a class="line" href="namespaceutils.html#ac358ecc5a6e709ba4b0923fb312283d4">  143</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="namespaceutils.html#ac358ecc5a6e709ba4b0923fb312283d4">utils::IsSameTrack</a>(<a class="code hl_class" href="classTrack.html">Track</a>* trk1, <a class="code hl_class" href="classTrack.html">Track</a>* trk2) {</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    <span class="keywordtype">double</span> tol = 1e-6;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="keywordflow">if</span> (fabs(trk1-&gt;<a class="code hl_function" href="classTrack.html#a872032bb26c1b5a2103ec9ee34a3408b">getD0</a>()        - trk2-&gt;<a class="code hl_function" href="classTrack.html#a872032bb26c1b5a2103ec9ee34a3408b">getD0</a>())        &gt; tol ||</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>            fabs(trk1-&gt;<a class="code hl_function" href="classTrack.html#a3f251561299bdaf6e3acefef6c7bf6af">getPhi</a>()       - trk2-&gt;<a class="code hl_function" href="classTrack.html#a3f251561299bdaf6e3acefef6c7bf6af">getPhi</a>())       &gt; tol ||</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>            fabs(trk1-&gt;<a class="code hl_function" href="classTrack.html#a671056cd2b40700574324838f7a99143">getOmega</a>()     - trk2-&gt;<a class="code hl_function" href="classTrack.html#a671056cd2b40700574324838f7a99143">getOmega</a>())     &gt; tol ||</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>            fabs(trk1-&gt;<a class="code hl_function" href="classTrack.html#a9dc9df56c8f1b2a740e645058348aa40">getTanLambda</a>() - trk2-&gt;<a class="code hl_function" href="classTrack.html#a9dc9df56c8f1b2a740e645058348aa40">getTanLambda</a>()) &gt; tol ||</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>            fabs(trk1-&gt;<a class="code hl_function" href="classTrack.html#ac657325cfc2596e354e5262a9c264526">getZ0</a>()        - trk2-&gt;<a class="code hl_function" href="classTrack.html#ac657325cfc2596e354e5262a9c264526">getZ0</a>())        &gt; tol ||</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>            fabs(trk1-&gt;<a class="code hl_function" href="classTrack.html#a4f0ac38a52ef74d7167b02e514d2232d">getChi2Ndf</a>()   - trk2-&gt;<a class="code hl_function" href="classTrack.html#a4f0ac38a52ef74d7167b02e514d2232d">getChi2Ndf</a>())   &gt; tol </div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>       ) </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>}</div>
</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="foldopen" id="foldopen00158" data-start="{" data-end="}">
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno"><a class="line" href="namespaceutils.html#a331cab836b576d7a988d81e008242528">  158</a></span><a class="code hl_class" href="classTrack.html">Track</a>* <a class="code hl_function" href="namespaceutils.html#a331cab836b576d7a988d81e008242528">utils::buildTrack</a>(EVENT::Track* lc_track,</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        std::string trackstate_location,</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>        EVENT::LCCollection* gbl_kink_data,</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>        EVENT::LCCollection* track_data) {</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <span class="keywordflow">if</span> (!lc_track)</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>     <span class="comment">//TrackState Location map</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>     std::map&lt;std::string, int&gt; trackstateLocationMap_ = {</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        {<span class="stringliteral">&quot;&quot;</span>, EVENT::TrackState::AtIP},</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>        {<span class="stringliteral">&quot;AtTarget&quot;</span>, EVENT::TrackState::LastLocation}</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>     };</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    <span class="keywordtype">int</span> loc;</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    <span class="keyword">auto</span> it = trackstateLocationMap_.find(trackstate_location);</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    <span class="keywordflow">if</span> (it != trackstateLocationMap_.end()){</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>        loc = it-&gt;second;</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    }</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;[utilities]::ERROR Track State Location &quot;</span> &lt;&lt; trackstate_location &lt;&lt; <span class="stringliteral">&quot; Doesn&#39;t Exist!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Check map in utilities::buildTrack for defined locations&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    }</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    <a class="code hl_class" href="classTrack.html">Track</a>* track = <span class="keyword">new</span> <a class="code hl_class" href="classTrack.html">Track</a>();</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="comment">//If using track AtIP, get params from lc_track</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="keywordflow">if</span> (loc == trackstateLocationMap_[<span class="stringliteral">&quot;&quot;</span>]){</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        <span class="comment">// Set the track parameters</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        track-&gt;setTrackParameters(lc_track-&gt;getD0(), </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>                lc_track-&gt;getPhi(), </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>                lc_track-&gt;getOmega(), </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                lc_track-&gt;getTanLambda(), </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>                lc_track-&gt;getZ0());</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <span class="comment">// Set the track covariance matrix</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        track-&gt;setCov(<span class="keyword">static_cast&lt;</span>std::vector&lt;float&gt; <span class="keyword">&gt;</span> (lc_track-&gt;getCovMatrix()));</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    }</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="comment">//If other TrackState specified, get track params from track state</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        <span class="comment">// If track state doesn&#39;t exist, no track returned</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        <span class="keyword">const</span> EVENT::TrackState* ts = lc_track-&gt;getTrackState(loc);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        <span class="keywordflow">if</span> (ts == <span class="keyword">nullptr</span>){</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>            <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        }</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        <span class="comment">// Set the track parameters using trackstate</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        track-&gt;setTrackParameters(ts-&gt;getD0(), </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>                ts-&gt;getPhi(), </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>                ts-&gt;getOmega(), </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>                ts-&gt;getTanLambda(), </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>                ts-&gt;getZ0());</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        <span class="keywordtype">double</span> position[3] = {</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>            ts-&gt;getReferencePoint()[1],  </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>            ts-&gt;getReferencePoint()[2],  </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            ts-&gt;getReferencePoint()[0]</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>        };</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>        track-&gt;setCov(<span class="keyword">static_cast&lt;</span>std::vector&lt;float&gt; <span class="keyword">&gt;</span> (ts-&gt;getCovMatrix()));</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        track-&gt;setPosition(position);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    }</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    <span class="comment">// Set the track id</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    track-&gt;setID(lc_track-&gt;id());</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <span class="comment">// Set the track type</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    track-&gt;setType(lc_track-&gt;getType()); </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <span class="comment">// Set the track fit chi^2</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    track-&gt;setChi2(lc_track-&gt;getChi2());</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <span class="comment">// Set the track ndf </span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    track-&gt;setNdf(lc_track-&gt;getNdf());</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="comment">// Set the position of the extrapolated track at the ECal face.  The</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <span class="comment">// extrapolation uses the full 3D field map.</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    <span class="keyword">const</span> EVENT::TrackState* track_state </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        = lc_track-&gt;getTrackState(EVENT::TrackState::AtCalorimeter); </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <span class="keywordflow">if</span> (track_state) {</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        <span class="keywordtype">double</span> position_at_ecal[3] = { </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            track_state-&gt;getReferencePoint()[1],  </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            track_state-&gt;getReferencePoint()[2],  </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>            track_state-&gt;getReferencePoint()[0]</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>        };</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        track-&gt;setPositionAtEcal(position_at_ecal); </div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    }</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span> </div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <span class="keywordflow">if</span> (gbl_kink_data) {</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>        <span class="comment">// Instantiate an LCRelation navigator which will allow faster access </span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        <span class="comment">// to GBLKinkData object</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        std::shared_ptr&lt;UTIL::LCRelationNavigator&gt; gbl_kink_data_nav = std::make_shared&lt;UTIL::LCRelationNavigator&gt;(gbl_kink_data);</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        <span class="comment">// Get the list of GBLKinkData associated with the LCIO Track</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>        EVENT::LCObjectVec gbl_kink_data_list </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>            = gbl_kink_data_nav-&gt;getRelatedFromObjects(lc_track);</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span> </div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>        <span class="comment">// The container of GBLKinkData objects should only contain a </span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        <span class="comment">// single object. If not, throw an exception</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        <span class="keywordflow">if</span> (gbl_kink_data_list.size() == 1) {</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span> </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>            <span class="comment">/*</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span><span class="comment">               std::cout&lt;&lt;&quot;[ Utilities ]: The collection &quot; </span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span><span class="comment">               + std::string(Collections::KINK_DATA)</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span><span class="comment">               + &quot; has the wrong data structure for this track&quot;&lt;&lt;std::endl; </span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="comment">               */</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>            <span class="comment">// Get the list GBLKinkData GenericObject associated with the LCIO Track</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>            IMPL::LCGenericObjectImpl* gbl_kink_datum </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>                = <span class="keyword">static_cast&lt;</span>IMPL::LCGenericObjectImpl*<span class="keyword">&gt;</span>(gbl_kink_data_list.at(0));</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>            <span class="comment">// Set the lambda and phi kink values</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ikink = 0; ikink &lt; gbl_kink_datum-&gt;getNDouble(); ++ikink) { </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>                track-&gt;setLambdaKink(ikink, gbl_kink_datum-&gt;getFloatVal(ikink));</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>                track-&gt;setPhiKink(ikink, gbl_kink_datum-&gt;getDoubleVal(ikink));</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>            }</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        }<span class="comment">//gbl_kink_data has right structure</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    } <span class="comment">// add gbl kink data</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    <span class="keywordflow">if</span> (track_data) { </div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        <span class="comment">// Instantiate an LCRelation navigator which will allow faster access</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        <span class="comment">// to TrackData objects  </span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        std::shared_ptr&lt;UTIL::LCRelationNavigator&gt; track_data_nav = std::make_shared&lt;UTIL::LCRelationNavigator&gt;(track_data);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        <span class="comment">// Get the list of TrackData associated with the LCIO Track</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        EVENT::LCObjectVec track_data_list = track_data_nav-&gt;getRelatedFromObjects(lc_track);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <span class="comment">// The container of TrackData objects should only contain a single</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        <span class="comment">//  object.  If not, throw an exception.</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        <span class="keywordflow">if</span> (track_data_list.size() == 1) { </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>            <span class="comment">// Get the TrackData GenericObject associated with the LCIO Track</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>            IMPL::LCGenericObjectImpl* track_datum = <span class="keyword">static_cast&lt;</span>IMPL::LCGenericObjectImpl*<span class="keyword">&gt;</span>(track_data_list.at(0));</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>            <span class="comment">// Check that the TrackData data structure is correct.  If it&#39;s</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>            <span class="comment">// not, throw a runtime exception.   </span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>            <span class="keywordflow">if</span> (track_datum-&gt;getNDouble() &gt; 14 || track_datum-&gt;getNFloat() &gt; 8 || track_datum-&gt;getNInt() != 1) {</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>                <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;[ TrackingProcessor ]: The collection &quot;</span> </div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>                        + std::string(<a class="code hl_variable" href="namespaceCollections.html#ae402e358f3b61b9fab89667a956b5253">Collections::TRACK_DATA</a>)</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>                        + <span class="stringliteral">&quot; has the wrong structure.&quot;</span>);</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>            }</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span> </div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>            <span class="comment">// Set the SvtTrack isolation values</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iso_index = 0; iso_index &lt; track_datum-&gt;getNDouble(); ++iso_index) { </div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>                track-&gt;setIsolation(iso_index, track_datum-&gt;getDoubleVal(iso_index));</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>            }</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>            <span class="comment">// Set the SvtTrack time</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>            track-&gt;setTrackTime(track_datum-&gt;getFloatVal(0));</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>            <span class="comment">// Set the Track momentum</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>            <span class="keywordflow">if</span> (track_datum-&gt;getNFloat()&gt;3)</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>              track-&gt;setMomentum(track_datum-&gt;getFloatVal(1),track_datum-&gt;getFloatVal(2),track_datum-&gt;getFloatVal(3));</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>            <span class="comment">// Set the volume (top/bottom) in which the SvtTrack resides</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>            track-&gt;setTrackVolume(track_datum-&gt;getIntVal(0));</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span> </div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>            <span class="comment">// Set the BfieldY for track state</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            <span class="keywordtype">double</span> bfieldY = -999.9;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>            <span class="keywordflow">if</span>(track_datum-&gt;getNFloat() &gt; 4){</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>                <span class="keywordflow">if</span> (loc == trackstateLocationMap_[<span class="stringliteral">&quot;&quot;</span>])</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>                    bfieldY = track_datum-&gt;getFloatVal(4);</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>                <span class="keywordflow">if</span> (loc == trackstateLocationMap_[<span class="stringliteral">&quot;AtTarget&quot;</span>]){</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>                    bfieldY = track_datum-&gt;getFloatVal(5);</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>                }</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>                <span class="keywordflow">if</span> (loc == trackstateLocationMap_[<span class="stringliteral">&quot;AtCalorimeter&quot;</span>])</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>                    bfieldY = track_datum-&gt;getFloatVal(6);</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>                <span class="comment">//Bfield needs factor of -1, not sure why... &lt;-TODO investigate</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>                track-&gt;setMomentum(-bfieldY);</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>            }</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>        }</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    } <span class="comment">//add track data  </span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="keywordflow">return</span> track;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>}</div>
</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="foldopen" id="foldopen00340" data-start="{" data-end="}">
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno"><a class="line" href="namespaceutils.html#afd800cb48040eb2458c898be282a731c">  340</a></span><a class="code hl_class" href="classRawSvtHit.html">RawSvtHit</a>* <a class="code hl_function" href="namespaceutils.html#afd800cb48040eb2458c898be282a731c">utils::buildRawHit</a>(EVENT::TrackerRawData* rawTracker_hit,</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        EVENT::LCCollection* raw_svt_hit_fits) {</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>    EVENT::long64 value =</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        EVENT::long64(rawTracker_hit-&gt;getCellID0() &amp; 0xffffffff) |</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>        ( EVENT::long64(rawTracker_hit-&gt;getCellID1() ) &lt;&lt; 32       );</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    decoder.setValue(value);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    <a class="code hl_class" href="classRawSvtHit.html">RawSvtHit</a>* rawHit = <span class="keyword">new</span> <a class="code hl_class" href="classRawSvtHit.html">RawSvtHit</a>();</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#a2c26993ecb697acfd52b60ff2c2624b3">setSystem</a>(decoder[<span class="stringliteral">&quot;system&quot;</span>]);</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#a15184e2d6fe8e166f5bedb6b5c436616">setBarrel</a>(decoder[<span class="stringliteral">&quot;barrel&quot;</span>]);</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#afbd2fbd594c8ee140b028f505631f682">setLayer</a>(decoder[<span class="stringliteral">&quot;layer&quot;</span>]);</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#affd2ff44d4a988d312672fef9a9f6f72">setModule</a>(decoder[<span class="stringliteral">&quot;module&quot;</span>]);</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#a8b6926403a4ea14c3b14a47af0adac78">setSensor</a>(decoder[<span class="stringliteral">&quot;sensor&quot;</span>]);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#a8fbf2f10efd0cf427a2d4b1ae92def4b">setSide</a>(decoder[<span class="stringliteral">&quot;side&quot;</span>]);</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#a8889167c257cff23dc1fb688471de7fd">setStrip</a>(decoder[<span class="stringliteral">&quot;strip&quot;</span>]);</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span> </div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    <span class="comment">// Extract ADC values for this hit</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    <span class="keywordtype">int</span> hit_adcs[6] = { </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        (int)rawTracker_hit-&gt;getADCValues().at(0), </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>        (int)rawTracker_hit-&gt;getADCValues().at(1), </div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        (int)rawTracker_hit-&gt;getADCValues().at(2), </div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        (int)rawTracker_hit-&gt;getADCValues().at(3), </div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        (int)rawTracker_hit-&gt;getADCValues().at(4), </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        (int)rawTracker_hit-&gt;getADCValues().at(5)};</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span> </div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#aef52f0e9464bb90383adba818fbfe7be">setADCs</a>(hit_adcs);</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    <span class="keywordflow">if</span> (raw_svt_hit_fits) {</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        std::shared_ptr&lt;UTIL::LCRelationNavigator&gt; rawTracker_hit_fits_nav = std::make_shared&lt;UTIL::LCRelationNavigator&gt;(raw_svt_hit_fits);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span> </div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>        <span class="comment">// Get the list of fit params associated with the raw tracker hit</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>        EVENT::LCObjectVec rawTracker_hit_fits_list</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>            = rawTracker_hit_fits_nav-&gt;getRelatedToObjects(rawTracker_hit);</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        <span class="comment">// Get the list SVTFittedRawTrackerHit GenericObject associated with the SVTRawTrackerHit</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        IMPL::LCGenericObjectImpl* hit_fit_param</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>            = <span class="keyword">static_cast&lt;</span>IMPL::LCGenericObjectImpl*<span class="keyword">&gt;</span>(rawTracker_hit_fits_list.at(0));</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        <span class="keywordtype">double</span> fit_params[5] = { </div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>            (double)hit_fit_param-&gt;getDoubleVal(0), </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>            (double)hit_fit_param-&gt;getDoubleVal(1), </div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>            (double)hit_fit_param-&gt;getDoubleVal(2), </div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>            (double)hit_fit_param-&gt;getDoubleVal(3), </div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>            (double)hit_fit_param-&gt;getDoubleVal(4)</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>        };</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>        rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#a338400c9c1f8653b6f76b9566f1cee79">setFit</a>(fit_params, 0);</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>        <span class="keywordflow">if</span>(rawTracker_hit_fits_list.size()&gt;1)</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        {</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>            hit_fit_param = <span class="keyword">static_cast&lt;</span>IMPL::LCGenericObjectImpl*<span class="keyword">&gt;</span>(rawTracker_hit_fits_list.at(1));</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>            fit_params[0] = (double)hit_fit_param-&gt;getDoubleVal(0); </div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>            fit_params[1] = (double)hit_fit_param-&gt;getDoubleVal(1); </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>            fit_params[2] = (double)hit_fit_param-&gt;getDoubleVal(2); </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>            fit_params[3] = (double)hit_fit_param-&gt;getDoubleVal(3); </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>            fit_params[4] = (double)hit_fit_param-&gt;getDoubleVal(4);</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>            rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#a338400c9c1f8653b6f76b9566f1cee79">setFit</a>(fit_params, 1);</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>        }</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#af98897331f04479059afcac073d15360">setFitN</a>(rawTracker_hit_fits_list.size());</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    }<span class="comment">//raw svt hit fits</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    <span class="keywordflow">return</span> rawHit;</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>}<span class="comment">//build raw hit</span></div>
</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span> </div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span><span class="comment">//type = 0 RotatedHelicalTrackHit type = 1 SiCluster</span></div>
<div class="foldopen" id="foldopen00406" data-start="{" data-end="}">
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno"><a class="line" href="namespaceutils.html#a6bd5c589b49d0a2b2404965d82f7fe51">  406</a></span><a class="code hl_class" href="classTrackerHit.html">TrackerHit</a>* <a class="code hl_function" href="namespaceutils.html#a6bd5c589b49d0a2b2404965d82f7fe51">utils::buildTrackerHit</a>(IMPL::TrackerHitImpl* lc_tracker_hit, <span class="keywordtype">bool</span> rotate, <span class="keywordtype">int</span> type) { </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span> </div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    <span class="keywordflow">if</span> (!lc_tracker_hit)</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    <a class="code hl_class" href="classTrackerHit.html">TrackerHit</a>* tracker_hit = <span class="keyword">new</span> <a class="code hl_class" href="classTrackerHit.html">TrackerHit</a>();</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    <span class="comment">// Get the position of the LCIO TrackerHit and set the position of </span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    <span class="comment">// the TrackerHit</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <span class="keywordtype">double</span> hit_position[3] = { </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>        lc_tracker_hit-&gt;getPosition()[0],  <span class="comment">//lcio x</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        lc_tracker_hit-&gt;getPosition()[1],  <span class="comment">//lcio y</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>        lc_tracker_hit-&gt;getPosition()[2]   <span class="comment">//lcio z</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    };</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#ad48e43b6f028fcbbb9ad7e7f29b38c31">setPosition</a>(hit_position, rotate, type);</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span> </div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    <span class="comment">// Set the covariance matrix of the SvtHit</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>    tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a2f109bf8d5ff2fb4cd2693d7fe31bb70">setCovarianceMatrix</a>(lc_tracker_hit-&gt;getCovMatrix());</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    <span class="comment">// Set the time of the SvtHit</span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#acb0ffd73929350f517aeba27c9463e7f">setTime</a>(lc_tracker_hit-&gt;getTime());</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    <span class="comment">// Set the charge of the SvtHit</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#aa0e4b074a508860d2898a0e2ff127d66">setCharge</a>(lc_tracker_hit-&gt;getEDep());</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span> </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    <span class="comment">// Set the LCIO id</span></div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a5f000855db408e735c6bc7ac6c39289c">setID</a>(lc_tracker_hit-&gt;id());</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span> </div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    <span class="keywordflow">return</span> tracker_hit;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span> </div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>}</div>
</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span><span class="comment">//type 0 rotatedHelicalHit  type 1 SiClusterHit</span></div>
<div class="foldopen" id="foldopen00440" data-start="{" data-end="}">
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno"><a class="line" href="namespaceutils.html#a0d15b32d30266551f22e870e6613f109">  440</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="namespaceutils.html#a0d15b32d30266551f22e870e6613f109">utils::addRawInfoTo3dHit</a>(<a class="code hl_class" href="classTrackerHit.html">TrackerHit</a>* tracker_hit, </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>        IMPL::TrackerHitImpl* lc_tracker_hit,</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>        EVENT::LCCollection* raw_svt_fits, std::vector&lt;RawSvtHit*&gt;* rawHits,<span class="keywordtype">int</span> type, <span class="keywordtype">bool</span> storeRawHit) {</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span> </div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <span class="keywordflow">if</span> (!tracker_hit || !lc_tracker_hit)</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span> </div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>    <span class="keywordtype">float</span> rawcharge = 0;</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    <span class="comment">//0 top 1 bottom</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    <span class="keywordtype">int</span> volume = -1;</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <span class="comment">//1-6(7) for rotated  0-13 for SiCluster</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="keywordtype">int</span> layer = -1;</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span> </div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    <span class="comment">// Get decoders to read cellids</span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    UTIL::BitField64 decoder(<span class="stringliteral">&quot;system:6,barrel:3,layer:4,module:12,sensor:1,side:32:-2,strip:12&quot;</span>);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <span class="comment">//Get the Raw content of the tracker hits</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    EVENT::LCObjectVec lc_rawHits             = lc_tracker_hit-&gt;getRawHits();  </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    std::vector&lt;int&gt; rawhit_strips;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> irh = 0 ; irh &lt; lc_rawHits.size(); ++irh) {</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        <span class="comment">// Get a raw hit from the list of hits</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>        EVENT::TrackerRawData* rawTracker_hit</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>            = <span class="keyword">static_cast&lt;</span>EVENT::TrackerRawData*<span class="keyword">&gt;</span>(lc_rawHits.at(irh));</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span> </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        <span class="comment">//Decode the cellid</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>        EVENT::long64 value = EVENT::long64( rawTracker_hit-&gt;getCellID0() &amp; 0xffffffff ) |</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>            ( EVENT::long64( rawTracker_hit-&gt;getCellID1() ) &lt;&lt; 32 ) ;</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        decoder.setValue(value);</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span> </div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        <span class="comment">//Get rawhit strip number</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>        <span class="keywordtype">int</span> stripnumber = decoder[<span class="stringliteral">&quot;strip&quot;</span>];</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>        rawhit_strips.push_back(stripnumber);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span> </div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        <span class="comment">//TODO useless to build all of it?</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        <a class="code hl_class" href="classRawSvtHit.html">RawSvtHit</a>* rawHit = <a class="code hl_function" href="namespaceutils.html#afd800cb48040eb2458c898be282a731c">buildRawHit</a>(rawTracker_hit,raw_svt_fits); </div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        rawcharge += rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#a9708d56d4159897347acc2bfcdce744d">getAmp</a>(0);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        <span class="keywordtype">int</span> currentHitVolume = rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#aefd72f7f5df118b603e0f3020f537a5a">getModule</a>() % 2 ? 1 : 0;</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        <span class="keywordtype">int</span> currentHitLayer  = (rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#a5b4df54b0e268839998175628116d79d">getLayer</a>() - 1 ) / 2;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        <span class="keywordflow">if</span> (type == 1) </div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            currentHitLayer = rawHit-&gt;<a class="code hl_function" href="classRawSvtHit.html#a5b4df54b0e268839998175628116d79d">getLayer</a>() - 1;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>        <span class="keywordflow">if</span> (volume == -1 )</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>            volume = currentHitVolume;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>            <span class="keywordflow">if</span> ( currentHitVolume != volume)</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>                std::cout&lt;&lt;<span class="stringliteral">&quot;[ ERROR ] : utils::addRawInfoTo3dHit raw hits with inconsistent volume found&quot;</span> &lt;&lt;std::endl;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>        }</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span> </div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        <span class="keywordflow">if</span> (layer == -1 )</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>            layer = currentHitLayer;</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>            <span class="keywordflow">if</span> (currentHitLayer != layer)</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>                std::cout&lt;&lt;<span class="stringliteral">&quot;[ ERROR ] : utils::addRawInfoTo3dHit raw hits with inconsistent layer found&quot;</span> &lt;&lt;std::endl;</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        }</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>        <span class="keywordflow">if</span>(storeRawHit){</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>            tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a2df57089ab769b31361900ffffb483a2">addRawHit</a>(rawHit);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>            <span class="keywordflow">if</span> (rawHits)</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>                rawHits-&gt;push_back(rawHit);</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>        }</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>            <span class="keyword">delete</span> rawHit;</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    }</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span> </div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>    tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a8e6e66284ccad34ec77830cf93e421a5">setRawCharge</a>(rawcharge);</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a1c9289fa499243af8164eb1d851784a1">setVolume</a>(volume);</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a14249dd02874bf12134f0d5241912490">setLayer</a>(layer);</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>    tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a7ac3f940950e7982b3cce292c72e1a36">setRawHitStripNumbers</a>(rawhit_strips);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>}</div>
</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span> </div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span><span class="comment">//TODO-improve shared finding algorithm </span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span> </div>
<div class="foldopen" id="foldopen00515" data-start="{" data-end="}">
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno"><a class="line" href="namespaceutils.html#a5e1646b6a827eb4b57b130766d574583">  515</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="namespaceutils.html#a5e1646b6a827eb4b57b130766d574583">utils::isUsedByTrack</a>(IMPL::TrackerHitImpl* lc_tracker_hit,</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        EVENT::Track* lc_track) {</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    EVENT::TrackerHitVec trk_lc_tracker_hits = lc_track-&gt;getTrackerHits();</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> trk_lc_tracker_hit : trk_lc_tracker_hits) {</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>        <span class="comment">//std::cout&lt;&lt;lc_tracker_hit-&gt;id()&lt;&lt;&quot; &quot; &lt;&lt;trk_lc_tracker_hit-&gt;id()&lt;&lt;std::endl;</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>        <span class="keywordflow">if</span> (lc_tracker_hit -&gt; <span class="keywordtype">id</span>() == trk_lc_tracker_hit -&gt; id())</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>    }</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>}</div>
</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span> </div>
<div class="foldopen" id="foldopen00528" data-start="{" data-end="}">
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno"><a class="line" href="namespaceutils.html#a379858785e5e2d3d2e2b60921b5ee84b">  528</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="namespaceutils.html#a5e1646b6a827eb4b57b130766d574583">utils::isUsedByTrack</a>(<a class="code hl_class" href="classTrackerHit.html">TrackerHit</a>* tracker_hit,</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        EVENT::Track* lc_track) {</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span> </div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    EVENT::TrackerHitVec trk_lc_tracker_hits = lc_track-&gt;getTrackerHits();</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span> </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> trk_lc_tracker_hit : trk_lc_tracker_hits) {</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        <span class="keywordflow">if</span> (tracker_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a9c9659a6c6ba66b4107ba59c95a24241">getID</a>() ==  trk_lc_tracker_hit-&gt;id())</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>    }</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>}</div>
</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span> </div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span> </div>
<div class="foldopen" id="foldopen00541" data-start="{" data-end="}">
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno"><a class="line" href="namespaceutils.html#a7e5c97f6c3d48e86b50baaefeb659369">  541</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="namespaceutils.html#a7e5c97f6c3d48e86b50baaefeb659369">utils::getParticlesFromVertex</a>(<a class="code hl_class" href="classVertex.html">Vertex</a>* vtx, <a class="code hl_class" href="classParticle.html">Particle</a>* ele, <a class="code hl_class" href="classParticle.html">Particle</a>* pos) {</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span> </div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ipart = 0; ipart &lt; vtx-&gt;getParticles().GetEntries(); ++ipart) {</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>        <span class="keywordtype">int</span> pdg_id = ((<a class="code hl_class" href="classParticle.html">Particle</a>*)vtx-&gt;getParticles().At(ipart))-&gt;getPDG();</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        <span class="keywordflow">if</span> (pdg_id == 11) {</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>            ele = (<a class="code hl_class" href="classParticle.html">Particle</a>*)vtx-&gt;getParticles().At(ipart);</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        }</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pdg_id == -11) {</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>            pos = (<a class="code hl_class" href="classParticle.html">Particle</a>*)vtx-&gt;getParticles().At(ipart);</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>        }</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span> </div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>            std::cout&lt;&lt;<span class="stringliteral">&quot;Utilities::Wrong particle ID &quot;</span>&lt;&lt; pdg_id &lt;&lt;<span class="stringliteral">&quot;associated to vertex. Skip.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>        }</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>    }</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span> </div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    <span class="keywordflow">if</span> (!ele || !pos) {</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>        std::cout&lt;&lt;<span class="stringliteral">&quot;Utilities::Vertex formed without ele/pos. Skip.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>    }</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>}</div>
</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span> </div>
<div class="foldopen" id="foldopen00566" data-start="{" data-end="}">
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno"><a class="line" href="namespaceutils.html#a738247811cec3af04d9b6a7868aa8eb4">  566</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="namespaceutils.html#a738247811cec3af04d9b6a7868aa8eb4">utils::getKalmanTrackL1Isolations</a>(<a class="code hl_class" href="classTrack.html">Track</a>* track, std::vector&lt;TrackerHit*&gt;* siClusters){</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    <span class="keywordtype">double</span> L1_axial_iso = 999999.9;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    <span class="keywordtype">double</span> L1_stereo_iso = 999999.9;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    <span class="comment">//Loop over hits on track</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; track-&gt;getSvtHits().GetEntries(); i++){</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        <a class="code hl_class" href="classTrackerHit.html">TrackerHit</a>* track_hit = (<a class="code hl_class" href="classTrackerHit.html">TrackerHit</a>*)track-&gt;getSvtHits().At(i);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>        <span class="comment">//Track hit info</span></div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <span class="keywordtype">int</span> trackhit_id = track_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a9c9659a6c6ba66b4107ba59c95a24241">getID</a>();</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>        <span class="keywordtype">int</span> trackhit_layer = track_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a17a9ca6d361f5e7cdc116c35d699e61f">getLayer</a>();</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>        <span class="keywordtype">int</span> trackhit_volume = track_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#aac9746ddc550ec176b0957affafbdbe7">getVolume</a>();</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        <span class="keywordtype">double</span> trackhit_y = track_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a037dbf33c23e4f394e56a71b8cb4e8ea">getGlobalY</a>();</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        <span class="keywordtype">double</span> trackhit_charge = track_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#ac5d16fb092048cfea6230708bfe6d2f0">getRawCharge</a>();</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        <span class="keywordtype">double</span> trackhit_time = track_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#afbffc04e39811037c7b7c79f29af16f5">getTime</a>();</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span> </div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        <span class="comment">//Only look at L1</span></div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        <span class="keywordflow">if</span>(trackhit_layer &gt; 1)</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        <span class="comment">//Get rawhit strip information</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        std::vector&lt;int&gt; trackhit_rawhits = track_hit-&gt;<a class="code hl_function" href="classTrackerHit.html#a6b049fe81a135e2247c4eeffc615b86f">getRawHitStripNumbers</a>();</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        <span class="keywordflow">if</span>(trackhit_rawhits.size() &lt; 1)</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        <span class="keywordtype">int</span> trackhit_maxstrip = *max_element(trackhit_rawhits.begin(), trackhit_rawhits.end());</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>        <span class="keywordtype">int</span> trackhit_minstrip = *min_element(trackhit_rawhits.begin(), trackhit_rawhits.end());</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span> </div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>        <span class="comment">//Isolation only calculated for axial sensors (sensitive to global y)</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>        <span class="keywordtype">bool</span> isAxial = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>        <span class="comment">//Axial/Stereo Top/Bot mapping</span></div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>        <span class="keywordflow">if</span>(trackhit_volume == 1){</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            <span class="keywordflow">if</span>(trackhit_layer%2 == 1)</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>                isAxial = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        }</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        <span class="keywordflow">if</span>(trackhit_volume == 0){</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>            <span class="keywordflow">if</span>(trackhit_layer%2 == 0)</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>                isAxial = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        }</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span> </div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        <span class="comment">//Loop over all SiClusters in event</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>        <span class="comment">//Find closest/best alternative SiCluster to track hit </span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>        <a class="code hl_class" href="classTrackerHit.html">TrackerHit</a>* closest_althit = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>        <span class="keywordtype">double</span> isohit_dy = 999999.9;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>        <span class="keywordtype">double</span> closest_dcharge = 99999.9;</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>        <span class="keywordtype">double</span> closest_dt = 999999.9;</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>        <span class="keywordtype">double</span> isohit_y = 999999.9;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span> </div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>        <span class="keywordflow">if</span> ( siClusters == <span class="keyword">nullptr</span> )</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>            <span class="keywordflow">return</span> isohit_dy;</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; siClusters-&gt;size(); j++){</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>            <a class="code hl_class" href="classTrackerHit.html">TrackerHit</a>* althit = siClusters-&gt;at(j);</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>            <span class="keywordtype">int</span> althit_id = althit-&gt;<a class="code hl_function" href="classTrackerHit.html#a9c9659a6c6ba66b4107ba59c95a24241">getID</a>();</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>            <span class="keywordtype">int</span> althit_volume = althit-&gt;<a class="code hl_function" href="classTrackerHit.html#aac9746ddc550ec176b0957affafbdbe7">getVolume</a>();</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>            <span class="keywordtype">int</span> althit_layer = althit-&gt;<a class="code hl_function" href="classTrackerHit.html#a17a9ca6d361f5e7cdc116c35d699e61f">getLayer</a>();</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>            <span class="keywordtype">double</span> althit_y = althit-&gt;<a class="code hl_function" href="classTrackerHit.html#a037dbf33c23e4f394e56a71b8cb4e8ea">getGlobalY</a>();</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>            <span class="keywordtype">double</span> althit_charge = althit-&gt;<a class="code hl_function" href="classTrackerHit.html#ac5d16fb092048cfea6230708bfe6d2f0">getRawCharge</a>();</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>            <span class="keywordtype">double</span> althit_time = althit-&gt;<a class="code hl_function" href="classTrackerHit.html#afbffc04e39811037c7b7c79f29af16f5">getTime</a>();</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span> </div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>            <span class="comment">//Skip if SiCluster not on same layer as track hit</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>            <span class="keywordflow">if</span> (althit_layer != trackhit_layer)</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span> </div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>            <span class="comment">//Skip if volume doesn&#39;t match</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>            <span class="keywordflow">if</span>(althit_volume != trackhit_volume)</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span> </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>            <span class="comment">//Skip same hit</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>            <span class="keywordflow">if</span> (althit_id == trackhit_id)</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span> </div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>            <span class="comment">//Only look at hits that are further from beam-axis in Global Y</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>            <span class="keywordflow">if</span> ( (trackhit_volume == 0 &amp;&amp; althit_y &lt; trackhit_y) ||</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>                    (trackhit_volume == 1 &amp;&amp; althit_y &gt; trackhit_y))</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>            <span class="comment">//Require alternative hits to be within +-30ns (based on SiClustersOnTrack t distr)</span></div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>            <span class="keywordflow">if</span>(std::abs(althit_time) &gt; 30.0)</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span> </div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>            <span class="comment">//Skip adjacent rawhits</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>            std::vector&lt;int&gt; althit_rawhits = althit-&gt;<a class="code hl_function" href="classTrackerHit.html#a6b049fe81a135e2247c4eeffc615b86f">getRawHitStripNumbers</a>();</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>            <span class="keywordtype">int</span> althit_maxstrip = *max_element(althit_rawhits.begin(), althit_rawhits.end());</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>            <span class="keywordtype">int</span> althit_minstrip = *min_element(althit_rawhits.begin(), althit_rawhits.end());</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>            <span class="keywordflow">if</span>(trackhit_minstrip - althit_maxstrip &lt;= 1 &amp;&amp; althit_minstrip - trackhit_maxstrip &lt;= 1)</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>            <span class="comment">//Pick closest alternative hit</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>            <span class="keywordflow">if</span> (std::abs(trackhit_y - althit_y) &lt; isohit_dy){</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>                isohit_dy = std::abs(trackhit_y-althit_y);</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>                closest_althit = althit;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>                closest_dcharge = trackhit_charge - althit_charge;</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>                closest_dt = trackhit_time - althit_time;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>                isohit_y = althit_y;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>            }</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        }</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span> </div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>        <span class="keywordflow">if</span>(isAxial)</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>            L1_axial_iso = isohit_dy;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            L1_stereo_iso = isohit_dy;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span> </div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>    }</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>    <span class="keywordflow">if</span>(L1_axial_iso &lt; L1_stereo_iso){</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>        <span class="keywordflow">return</span> L1_axial_iso;</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    }</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>        <span class="keywordflow">return</span> L1_stereo_iso;</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>}</div>
</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span> </div>
<div class="foldopen" id="foldopen00675" data-start="{" data-end="}">
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno"><a class="line" href="namespaceutils.html#ab32ee0dd27142e56bd20ad7d6c5ee592">  675</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="namespaceutils.html#ab32ee0dd27142e56bd20ad7d6c5ee592">utils::get2016KFMCTruthHitCodes</a>(<a class="code hl_class" href="classTrack.html">Track</a>* ele_trk, <a class="code hl_class" href="classTrack.html">Track</a>* pos_trk, <span class="keywordtype">int</span>&amp; L1L2hitCode, <span class="keywordtype">int</span>&amp; L1hitCode, <span class="keywordtype">int</span>&amp; L2hitCode){</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>    <span class="comment">//Count the number of hits per part on the ele track</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>    std::map&lt;int, int&gt; nHits4part_ele;</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i =0; i &lt; ele_trk-&gt;<a class="code hl_function" href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">getMcpHits</a>().size(); i++)</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>    {</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>        <span class="keywordtype">int</span> partID = ele_trk-&gt;<a class="code hl_function" href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">getMcpHits</a>().at(i).second;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>        <span class="keywordflow">if</span> ( nHits4part_ele.find(partID) == nHits4part_ele.end() )</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>        {</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>            <span class="comment">// not found</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>            nHits4part_ele[partID] = 1;</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>        }</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>        {</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>            <span class="comment">// found</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>            nHits4part_ele[partID]++;</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        }</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>    }</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span> </div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    <span class="comment">//Determine the MC part with the most hits on the track</span></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    <span class="keywordtype">int</span> maxNHits_ele = 0;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    <span class="keywordtype">int</span> maxID_ele = 0;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>    <span class="keywordflow">for</span> (std::map&lt;int,int&gt;::iterator it=nHits4part_ele.begin(); it!=nHits4part_ele.end(); ++it)</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    {</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>        <span class="keywordflow">if</span>(it-&gt;second &gt; maxNHits_ele)</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>        {</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>            maxNHits_ele = it-&gt;second;</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>            maxID_ele = it-&gt;first;</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>        }</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    }</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span> </div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>    <span class="comment">//Count the number of hits per part on the pos track</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>    std::map&lt;int, int&gt; nHits4part_pos;</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i =0; i &lt; pos_trk-&gt;<a class="code hl_function" href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">getMcpHits</a>().size(); i++)</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>    {</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>        <span class="keywordtype">int</span> partID = pos_trk-&gt;<a class="code hl_function" href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">getMcpHits</a>().at(i).second;</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>        <span class="keywordflow">if</span> ( nHits4part_pos.find(partID) == nHits4part_pos.end() )</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>        {</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>            <span class="comment">// not found</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>            nHits4part_pos[partID] = 1;</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>        }</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>        {</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>            <span class="comment">// found</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>            nHits4part_pos[partID]++;</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>        }</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    }</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span> </div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    <span class="comment">//Determine the MC part with the most hits on the track</span></div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>    <span class="keywordtype">int</span> maxNHits_pos = 0;</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    <span class="keywordtype">int</span> maxID_pos = 0;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>    <span class="keywordflow">for</span> (std::map&lt;int,int&gt;::iterator it=nHits4part_pos.begin(); it!=nHits4part_pos.end(); ++it)</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    {</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>        <span class="keywordflow">if</span>(it-&gt;second &gt; maxNHits_pos)</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>        {</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>            maxNHits_pos = it-&gt;second;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>            maxID_pos = it-&gt;first;</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>        }</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>    }</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>    <span class="comment">//Determine Ele L1 and L2 truth information</span></div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    <span class="keywordtype">bool</span> ele_trueAxialL1 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    <span class="keywordtype">bool</span> ele_trueStereoL1 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>    <span class="keywordtype">bool</span> ele_trueAxialL2 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>    <span class="keywordtype">bool</span> ele_trueStereoL2 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>    <span class="keywordtype">bool</span> pos_trueAxialL1 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    <span class="keywordtype">bool</span> pos_trueStereoL1 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    <span class="keywordtype">bool</span> pos_trueAxialL2 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>    <span class="keywordtype">bool</span> pos_trueStereoL2 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span> </div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>    <span class="keywordflow">if</span>(ele_trk-&gt;<a class="code hl_function" href="classTrack.html#a0fe98cdce0b4402fb0173dcc7408a89d">isKalmanTrack</a>()){</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; ele_trk-&gt;<a class="code hl_function" href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">getMcpHits</a>().size(); i++){</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>            <span class="keywordtype">int</span> mcpid = ele_trk-&gt;<a class="code hl_function" href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">getMcpHits</a>().at(i).second;</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>            <span class="keywordtype">int</span> layer = ele_trk-&gt;<a class="code hl_function" href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">getMcpHits</a>().at(i).first;</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>            <span class="keywordtype">int</span> volume = -1;</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>            <span class="keywordflow">if</span>(ele_trk-&gt;<a class="code hl_function" href="classTrack.html#a1b85afd754a3524090061303d684b0f2">isTopTrack</a>() == 1)</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>                volume = 0;</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>                volume = 1;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span> </div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>            <span class="keywordtype">bool</span> isAxial = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>            <span class="keywordtype">bool</span> isStereo = <span class="keyword">false</span>; </div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>            <span class="keywordtype">bool</span> isL1 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>            <span class="keywordtype">bool</span> isL2 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>            <span class="keywordtype">bool</span> isGood = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span> </div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>            <span class="comment">//L1 and L2 only</span></div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>            <span class="keywordflow">if</span>(layer &lt; 2)</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>                isL1 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(layer &gt; 1 &amp;&amp; layer &lt; 4)</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>                isL2 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>            <span class="keywordflow">if</span>(volume == 1){</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>                <span class="keywordflow">if</span>(layer%2 == 1)</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>                    isAxial = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>                    isStereo = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>            }</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>            <span class="keywordflow">if</span>(volume == 0){</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>                <span class="keywordflow">if</span>(layer%2 == 0)</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>                    isAxial = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>                    isStereo = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>            }</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span> </div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>            <span class="keywordflow">if</span>(mcpid == maxID_ele)</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>                isGood = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span> </div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>            <span class="keywordflow">if</span>(isGood){</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>                <span class="keywordflow">if</span>(isAxial){</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>                    <span class="keywordflow">if</span>(isL1)</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>                        ele_trueAxialL1 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>                    <span class="keywordflow">if</span>(isL2)</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>                        ele_trueAxialL2 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>                }</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>                <span class="keywordflow">if</span>(isStereo){</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>                    <span class="keywordflow">if</span>(isL1)</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>                        ele_trueStereoL1 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>                    <span class="keywordflow">if</span>(isL2)</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>                        ele_trueStereoL2 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>                }</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>            }</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>        }</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>    }</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span> </div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>    <span class="keywordflow">if</span>(pos_trk-&gt;<a class="code hl_function" href="classTrack.html#a0fe98cdce0b4402fb0173dcc7408a89d">isKalmanTrack</a>()){</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; pos_trk-&gt;<a class="code hl_function" href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">getMcpHits</a>().size(); i++){</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>            <span class="keywordtype">int</span> mcpid = pos_trk-&gt;<a class="code hl_function" href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">getMcpHits</a>().at(i).second;</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>            <span class="keywordtype">int</span> layer = pos_trk-&gt;<a class="code hl_function" href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">getMcpHits</a>().at(i).first;</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>            <span class="keywordtype">int</span> volume = -1;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>            <span class="keywordflow">if</span>(pos_trk-&gt;<a class="code hl_function" href="classTrack.html#a1b85afd754a3524090061303d684b0f2">isTopTrack</a>() == 1)</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>                volume = 0;</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>                volume = 1;</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span> </div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>            <span class="keywordtype">bool</span> isAxial = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>            <span class="keywordtype">bool</span> isStereo = <span class="keyword">false</span>; </div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>            <span class="keywordtype">bool</span> isL1 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>            <span class="keywordtype">bool</span> isL2 = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>            <span class="keywordtype">bool</span> isGood = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span> </div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>            <span class="comment">//L1 and L2 only</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>            <span class="keywordflow">if</span>(layer &lt; 2)</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>                isL1 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(layer &gt; 1 &amp;&amp; layer &lt; 4)</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>                isL2 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span> </div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>            <span class="keywordflow">if</span>(volume == 1){</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>                <span class="keywordflow">if</span>(layer%2 == 1)</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>                    isAxial = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>                    isStereo = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>            }</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>            <span class="keywordflow">if</span>(volume == 0){</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>                <span class="keywordflow">if</span>(layer%2 == 0)</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>                    isAxial = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>                    isStereo = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>            }</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span> </div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>            <span class="keywordflow">if</span>(mcpid == maxID_pos)</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>                isGood = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span> </div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>            <span class="keywordflow">if</span>(isGood){</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>                <span class="keywordflow">if</span>(isAxial){</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>                    <span class="keywordflow">if</span>(isL1)</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>                        pos_trueAxialL1 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>                    <span class="keywordflow">if</span>(isL2)</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>                        pos_trueAxialL2 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>                }</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>                <span class="keywordflow">if</span>(isStereo){</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>                    <span class="keywordflow">if</span>(isL1)</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>                        pos_trueStereoL1 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>                    <span class="keywordflow">if</span>(isL2)</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>                        pos_trueStereoL2 = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>                }</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>            }</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>        }</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>    }</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span> </div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span> </div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>    <span class="comment">//Require both Axial and Stereo truth hits to be &#39;Good&#39; hit</span></div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>    <span class="keywordflow">if</span>(ele_trueAxialL1 &amp;&amp; ele_trueStereoL1) L1L2hitCode = L1L2hitCode | (0x1 &lt;&lt; 3);           </div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>    <span class="keywordflow">if</span>(pos_trueAxialL1 &amp;&amp; pos_trueStereoL1) L1L2hitCode = L1L2hitCode | (0x1 &lt;&lt; 2);           </div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>    <span class="keywordflow">if</span>(ele_trueAxialL2 &amp;&amp; ele_trueStereoL2) L1L2hitCode = L1L2hitCode | (0x1 &lt;&lt; 1);           </div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>    <span class="keywordflow">if</span>(pos_trueAxialL2 &amp;&amp; pos_trueStereoL2) L1L2hitCode = L1L2hitCode | (0x1 &lt;&lt; 0);           </div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>    </div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>    </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>    <span class="comment">//Set L1 axial/stereo hit code for ele and positron</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>    <span class="keywordflow">if</span>(ele_trueAxialL1) L1hitCode = L1hitCode | (0x1 &lt;&lt; 3);</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>    <span class="keywordflow">if</span>(ele_trueStereoL1) L1hitCode = L1hitCode | (0x1 &lt;&lt; 2);</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    <span class="keywordflow">if</span>(pos_trueAxialL1) L1hitCode = L1hitCode | (0x1 &lt;&lt; 1);</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>    <span class="keywordflow">if</span>(pos_trueStereoL1) L1hitCode = L1hitCode | (0x1 &lt;&lt; 0);</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span> </div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    <span class="comment">//Set L2 axial/stereo hit code for ele and positron</span></div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>    <span class="keywordflow">if</span>(ele_trueAxialL2) L2hitCode = L2hitCode | (0x1 &lt;&lt; 3);</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>    <span class="keywordflow">if</span>(ele_trueStereoL2) L2hitCode = L2hitCode | (0x1 &lt;&lt; 2);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>    <span class="keywordflow">if</span>(pos_trueAxialL2) L2hitCode = L2hitCode | (0x1 &lt;&lt; 1);</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>    <span class="keywordflow">if</span>(pos_trueStereoL2) L2hitCode = L2hitCode | (0x1 &lt;&lt; 0);</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>}</div>
</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span> </div>
<div class="foldopen" id="foldopen00879" data-start="{" data-end="}">
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno"><a class="line" href="namespaceutils.html#aa54b8be934579198d0bcfed387562ee0">  879</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="namespaceutils.html#aa54b8be934579198d0bcfed387562ee0">utils::v0_projection_to_target_significance</a>(<a class="code hl_typedef" href="BaseSelector_8h.html#ab701e3ac61a85b337ec5c1abaad6742d">json</a> v0proj_fits, <span class="keywordtype">int</span> run, <span class="keywordtype">double</span> &amp;vtx_proj_x, <span class="keywordtype">double</span> &amp;vtx_proj_y,</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>        <span class="keywordtype">double</span> &amp;vtx_proj_x_signif, <span class="keywordtype">double</span> &amp;vtx_proj_y_signif, <span class="keywordtype">double</span> vtx_x, <span class="keywordtype">double</span> vtx_y, <span class="keywordtype">double</span> vtx_z,</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>        <span class="keywordtype">double</span> vtx_px, <span class="keywordtype">double</span> vtx_py, <span class="keywordtype">double</span> vtx_pz){</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>    <span class="comment">//V0 Projection fit parameters are calculated externally by projecting vertices to the target z position,</span></div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>    <span class="comment">//and then fitting the 2D distribution vtx_x vs vtx_y with a rotated 2D Gaussian.</span></div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>    <span class="comment">//The fit parameters are defined along the rotated coordinate system.</span></div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>    <span class="comment">//Therefore, the vertex position must be rotated into this coordinate system before calculating significance.</span></div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>    <span class="comment">//The rotation angle corresponding to the fit is provided in the json file containing the rotated fit values.</span></div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>    </div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>    <span class="comment">//Read v0 projection fits from json file</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>    <span class="keywordtype">int</span> closest_run;</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> entry : v0proj_fits.items()){</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>        <span class="keywordtype">int</span> check_run = std::stoi(entry.key());</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>        <span class="keywordflow">if</span>(check_run &gt; run)</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>        <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>            closest_run = check_run;</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>        }</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>    }</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>    <span class="keywordtype">double</span> target_pos = v0proj_fits[std::to_string(closest_run)][<span class="stringliteral">&quot;target_position&quot;</span>];</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    <span class="keywordtype">double</span> rot_mean_x = v0proj_fits[std::to_string(closest_run)][<span class="stringliteral">&quot;rotated_mean_x&quot;</span>];</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>    <span class="keywordtype">double</span> rot_mean_y = v0proj_fits[std::to_string(closest_run)][<span class="stringliteral">&quot;rotated_mean_y&quot;</span>];</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>    <span class="keywordtype">double</span> rot_sigma_x = v0proj_fits[std::to_string(closest_run)][<span class="stringliteral">&quot;rotated_sigma_x&quot;</span>];</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>    <span class="keywordtype">double</span> rot_sigma_y = v0proj_fits[std::to_string(closest_run)][<span class="stringliteral">&quot;rotated_sigma_y&quot;</span>];</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>    <span class="keywordtype">double</span> rotation_angle = (double)v0proj_fits[std::to_string(closest_run)][<span class="stringliteral">&quot;rotation_angle_mrad&quot;</span>]/1000.0;</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span> </div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    <span class="comment">//project vertex to target position</span></div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>    vtx_proj_x = vtx_x - ((vtx_z - target_pos)*(vtx_px/vtx_pz));</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    vtx_proj_y = vtx_y - ((vtx_z - target_pos)*(vtx_py/vtx_pz));</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span> </div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>    <span class="comment">//Rotate projected vertex by angle corresponding to run number</span></div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>    <span class="keywordtype">double</span> rot_vtx_proj_x = vtx_proj_x*std::cos(rotation_angle) - vtx_proj_y*std::sin(rotation_angle);</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>    <span class="keywordtype">double</span> rot_vtx_proj_y = vtx_proj_x*std::sin(rotation_angle) + vtx_proj_y*std::cos(rotation_angle);</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span> </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>    <span class="comment">//Calculate significance</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>    vtx_proj_x_signif = (rot_vtx_proj_x - rot_mean_x)/rot_sigma_x;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>    vtx_proj_y_signif = (rot_vtx_proj_y - rot_mean_y)/rot_sigma_y;</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span> </div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>    <span class="keywordtype">double</span> significance = std::sqrt( vtx_proj_x_signif*vtx_proj_x_signif + vtx_proj_y_signif*vtx_proj_y_signif );</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span> </div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>    <span class="keywordflow">return</span> significance;</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>}</div>
</div>
<div class="ttc" id="aBaseSelector_8h_html_ab701e3ac61a85b337ec5c1abaad6742d"><div class="ttname"><a href="BaseSelector_8h.html#ab701e3ac61a85b337ec5c1abaad6742d">json</a></div><div class="ttdeci">nlohmann::json json</div><div class="ttdef"><b>Definition</b> <a href="BaseSelector_8h_source.html#l00014">BaseSelector.h:14</a></div></div>
<div class="ttc" id="aclassCalCluster_html"><div class="ttname"><a href="classCalCluster.html">CalCluster</a></div><div class="ttdef"><b>Definition</b> <a href="CalCluster_8h_source.html#l00023">CalCluster.h:23</a></div></div>
<div class="ttc" id="aclassCalCluster_html_a22f0c3dd9d115832baf9e9ccecbee37f"><div class="ttname"><a href="classCalCluster.html#a22f0c3dd9d115832baf9e9ccecbee37f">CalCluster::setPosition</a></div><div class="ttdeci">void setPosition(const float *position)</div><div class="ttdef"><b>Definition</b> <a href="CalCluster_8cxx_source.html#l00030">CalCluster.cxx:30</a></div></div>
<div class="ttc" id="aclassCalCluster_html_aa89352316465c459725ccb5610b19dd9"><div class="ttname"><a href="classCalCluster.html#aa89352316465c459725ccb5610b19dd9">CalCluster::setEnergy</a></div><div class="ttdeci">void setEnergy(const double energy)</div><div class="ttdef"><b>Definition</b> <a href="CalCluster_8h_source.html#l00070">CalCluster.h:70</a></div></div>
<div class="ttc" id="aclassCalCluster_html_acb0ffd73929350f517aeba27c9463e7f"><div class="ttname"><a href="classCalCluster.html#acb0ffd73929350f517aeba27c9463e7f">CalCluster::setTime</a></div><div class="ttdeci">void setTime(const double time)</div><div class="ttdef"><b>Definition</b> <a href="CalCluster_8h_source.html#l00080">CalCluster.h:80</a></div></div>
<div class="ttc" id="aclassParticle_html"><div class="ttname"><a href="classParticle.html">Particle</a></div><div class="ttdef"><b>Definition</b> <a href="Particle_8h_source.html#l00024">Particle.h:24</a></div></div>
<div class="ttc" id="aclassParticle_html_a4ec278fd10816831508c72e35d461e17"><div class="ttname"><a href="classParticle.html#a4ec278fd10816831508c72e35d461e17">Particle::setGoodnessOfPID</a></div><div class="ttdeci">void setGoodnessOfPID(const double goodness_pid)</div><div class="ttdef"><b>Definition</b> <a href="Particle_8h_source.html#l00084">Particle.h:84</a></div></div>
<div class="ttc" id="aclassParticle_html_a4f0e9db32ad4b89b376a4b6a20cf0fcf"><div class="ttname"><a href="classParticle.html#a4f0e9db32ad4b89b376a4b6a20cf0fcf">Particle::setPDG</a></div><div class="ttdeci">void setPDG(const int pdg)</div><div class="ttdef"><b>Definition</b> <a href="Particle_8h_source.html#l00098">Particle.h:98</a></div></div>
<div class="ttc" id="aclassParticle_html_a50065a7bcb4b384286dfc32e0d06d3b7"><div class="ttname"><a href="classParticle.html#a50065a7bcb4b384286dfc32e0d06d3b7">Particle::setMass</a></div><div class="ttdeci">void setMass(const double mass)</div><div class="ttdef"><b>Definition</b> <a href="Particle_8h_source.html#l00112">Particle.h:112</a></div></div>
<div class="ttc" id="aclassParticle_html_a8b3ca2d37e7a5399465649fb5fb49096"><div class="ttname"><a href="classParticle.html#a8b3ca2d37e7a5399465649fb5fb49096">Particle::setCharge</a></div><div class="ttdeci">void setCharge(const int charge)</div><div class="ttdef"><b>Definition</b> <a href="Particle_8h_source.html#l00077">Particle.h:77</a></div></div>
<div class="ttc" id="aclassParticle_html_a96c2b792855a6d73ae08e9f56d46a9ad"><div class="ttname"><a href="classParticle.html#a96c2b792855a6d73ae08e9f56d46a9ad">Particle::setType</a></div><div class="ttdeci">void setType(const int type)</div><div class="ttdef"><b>Definition</b> <a href="Particle_8h_source.html#l00091">Particle.h:91</a></div></div>
<div class="ttc" id="aclassParticle_html_a9a246cac55a414742052bc8f46218c6e"><div class="ttname"><a href="classParticle.html#a9a246cac55a414742052bc8f46218c6e">Particle::setMomentum</a></div><div class="ttdeci">void setMomentum(const double *momentum)</div><div class="ttdef"><b>Definition</b> <a href="Particle_8cxx_source.html#l00023">Particle.cxx:23</a></div></div>
<div class="ttc" id="aclassParticle_html_aa2dd28c594c2b4ff2fc590c053067a47"><div class="ttname"><a href="classParticle.html#aa2dd28c594c2b4ff2fc590c053067a47">Particle::setTrack</a></div><div class="ttdeci">void setTrack(Track *track)</div><div class="ttdef"><b>Definition</b> <a href="Particle_8h_source.html#l00042">Particle.h:42</a></div></div>
<div class="ttc" id="aclassParticle_html_aa89352316465c459725ccb5610b19dd9"><div class="ttname"><a href="classParticle.html#aa89352316465c459725ccb5610b19dd9">Particle::setEnergy</a></div><div class="ttdeci">void setEnergy(const double energy)</div><div class="ttdef"><b>Definition</b> <a href="Particle_8h_source.html#l00105">Particle.h:105</a></div></div>
<div class="ttc" id="aclassParticle_html_ab83ad18659c25efdb72bd9c7c6f11189"><div class="ttname"><a href="classParticle.html#ab83ad18659c25efdb72bd9c7c6f11189">Particle::setCluster</a></div><div class="ttdeci">void setCluster(CalCluster *cluster)</div><div class="ttdef"><b>Definition</b> <a href="Particle_8h_source.html#l00056">Particle.h:56</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html"><div class="ttname"><a href="classRawSvtHit.html">RawSvtHit</a></div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8h_source.html#l00021">RawSvtHit.h:21</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_a15184e2d6fe8e166f5bedb6b5c436616"><div class="ttname"><a href="classRawSvtHit.html#a15184e2d6fe8e166f5bedb6b5c436616">RawSvtHit::setBarrel</a></div><div class="ttdeci">void setBarrel(int barrel)</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00048">RawSvtHit.cxx:48</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_a2c26993ecb697acfd52b60ff2c2624b3"><div class="ttname"><a href="classRawSvtHit.html#a2c26993ecb697acfd52b60ff2c2624b3">RawSvtHit::setSystem</a></div><div class="ttdeci">void setSystem(int system)</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00044">RawSvtHit.cxx:44</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_a338400c9c1f8653b6f76b9566f1cee79"><div class="ttname"><a href="classRawSvtHit.html#a338400c9c1f8653b6f76b9566f1cee79">RawSvtHit::setFit</a></div><div class="ttdeci">void setFit(double fit[5], int fitI)</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00027">RawSvtHit.cxx:27</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_a5b4df54b0e268839998175628116d79d"><div class="ttname"><a href="classRawSvtHit.html#a5b4df54b0e268839998175628116d79d">RawSvtHit::getLayer</a></div><div class="ttdeci">int getLayer()</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00088">RawSvtHit.cxx:88</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_a8889167c257cff23dc1fb688471de7fd"><div class="ttname"><a href="classRawSvtHit.html#a8889167c257cff23dc1fb688471de7fd">RawSvtHit::setStrip</a></div><div class="ttdeci">void setStrip(int strip)</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00068">RawSvtHit.cxx:68</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_a8b6926403a4ea14c3b14a47af0adac78"><div class="ttname"><a href="classRawSvtHit.html#a8b6926403a4ea14c3b14a47af0adac78">RawSvtHit::setSensor</a></div><div class="ttdeci">void setSensor(int sensor)</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00060">RawSvtHit.cxx:60</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_a8fbf2f10efd0cf427a2d4b1ae92def4b"><div class="ttname"><a href="classRawSvtHit.html#a8fbf2f10efd0cf427a2d4b1ae92def4b">RawSvtHit::setSide</a></div><div class="ttdeci">void setSide(int side)</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00064">RawSvtHit.cxx:64</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_a9708d56d4159897347acc2bfcdce744d"><div class="ttname"><a href="classRawSvtHit.html#a9708d56d4159897347acc2bfcdce744d">RawSvtHit::getAmp</a></div><div class="ttdeci">double getAmp(int fitI)</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8h_source.html#l00101">RawSvtHit.h:101</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_aef52f0e9464bb90383adba818fbfe7be"><div class="ttname"><a href="classRawSvtHit.html#aef52f0e9464bb90383adba818fbfe7be">RawSvtHit::setADCs</a></div><div class="ttdeci">void setADCs(int adcs[6])</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00035">RawSvtHit.cxx:35</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_aefd72f7f5df118b603e0f3020f537a5a"><div class="ttname"><a href="classRawSvtHit.html#aefd72f7f5df118b603e0f3020f537a5a">RawSvtHit::getModule</a></div><div class="ttdeci">int getModule()</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00092">RawSvtHit.cxx:92</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_af98897331f04479059afcac073d15360"><div class="ttname"><a href="classRawSvtHit.html#af98897331f04479059afcac073d15360">RawSvtHit::setFitN</a></div><div class="ttdeci">void setFitN(int fitN)</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00023">RawSvtHit.cxx:23</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_afbd2fbd594c8ee140b028f505631f682"><div class="ttname"><a href="classRawSvtHit.html#afbd2fbd594c8ee140b028f505631f682">RawSvtHit::setLayer</a></div><div class="ttdeci">void setLayer(int layer)</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00052">RawSvtHit.cxx:52</a></div></div>
<div class="ttc" id="aclassRawSvtHit_html_affd2ff44d4a988d312672fef9a9f6f72"><div class="ttname"><a href="classRawSvtHit.html#affd2ff44d4a988d312672fef9a9f6f72">RawSvtHit::setModule</a></div><div class="ttdeci">void setModule(int module)</div><div class="ttdef"><b>Definition</b> <a href="RawSvtHit_8cxx_source.html#l00056">RawSvtHit.cxx:56</a></div></div>
<div class="ttc" id="aclassTrack_html"><div class="ttname"><a href="classTrack.html">Track</a></div><div class="ttdef"><b>Definition</b> <a href="Track_8h_source.html#l00032">Track.h:32</a></div></div>
<div class="ttc" id="aclassTrack_html_a0fe98cdce0b4402fb0173dcc7408a89d"><div class="ttname"><a href="classTrack.html#a0fe98cdce0b4402fb0173dcc7408a89d">Track::isKalmanTrack</a></div><div class="ttdeci">bool isKalmanTrack() const</div><div class="ttdef"><b>Definition</b> <a href="Track_8h_source.html#l00231">Track.h:231</a></div></div>
<div class="ttc" id="aclassTrack_html_a1b85afd754a3524090061303d684b0f2"><div class="ttname"><a href="classTrack.html#a1b85afd754a3524090061303d684b0f2">Track::isTopTrack</a></div><div class="ttdeci">bool isTopTrack() const</div><div class="ttdef"><b>Definition</b> <a href="Track_8h_source.html#l00330">Track.h:330</a></div></div>
<div class="ttc" id="aclassTrack_html_a3f251561299bdaf6e3acefef6c7bf6af"><div class="ttname"><a href="classTrack.html#a3f251561299bdaf6e3acefef6c7bf6af">Track::getPhi</a></div><div class="ttdeci">double getPhi() const</div><div class="ttdef"><b>Definition</b> <a href="Track_8h_source.html#l00088">Track.h:88</a></div></div>
<div class="ttc" id="aclassTrack_html_a4f0ac38a52ef74d7167b02e514d2232d"><div class="ttname"><a href="classTrack.html#a4f0ac38a52ef74d7167b02e514d2232d">Track::getChi2Ndf</a></div><div class="ttdeci">double getChi2Ndf() const</div><div class="ttdef"><b>Definition</b> <a href="Track_8h_source.html#l00126">Track.h:126</a></div></div>
<div class="ttc" id="aclassTrack_html_a671056cd2b40700574324838f7a99143"><div class="ttname"><a href="classTrack.html#a671056cd2b40700574324838f7a99143">Track::getOmega</a></div><div class="ttdeci">double getOmega() const</div><div class="ttdef"><b>Definition</b> <a href="Track_8h_source.html#l00090">Track.h:90</a></div></div>
<div class="ttc" id="aclassTrack_html_a872032bb26c1b5a2103ec9ee34a3408b"><div class="ttname"><a href="classTrack.html#a872032bb26c1b5a2103ec9ee34a3408b">Track::getD0</a></div><div class="ttdeci">double getD0() const</div><div class="ttdef"><b>Definition</b> <a href="Track_8h_source.html#l00087">Track.h:87</a></div></div>
<div class="ttc" id="aclassTrack_html_a9dc9df56c8f1b2a740e645058348aa40"><div class="ttname"><a href="classTrack.html#a9dc9df56c8f1b2a740e645058348aa40">Track::getTanLambda</a></div><div class="ttdeci">double getTanLambda() const</div><div class="ttdef"><b>Definition</b> <a href="Track_8h_source.html#l00091">Track.h:91</a></div></div>
<div class="ttc" id="aclassTrack_html_ac2c2416bd82ed72acd53a1e5eee37d7a"><div class="ttname"><a href="classTrack.html#ac2c2416bd82ed72acd53a1e5eee37d7a">Track::getMcpHits</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int, int &gt; &gt; getMcpHits()</div><div class="ttdef"><b>Definition</b> <a href="Track_8h_source.html#l00103">Track.h:103</a></div></div>
<div class="ttc" id="aclassTrack_html_ac657325cfc2596e354e5262a9c264526"><div class="ttname"><a href="classTrack.html#ac657325cfc2596e354e5262a9c264526">Track::getZ0</a></div><div class="ttdeci">double getZ0() const</div><div class="ttdef"><b>Definition</b> <a href="Track_8h_source.html#l00092">Track.h:92</a></div></div>
<div class="ttc" id="aclassTrackerHit_html"><div class="ttname"><a href="classTrackerHit.html">TrackerHit</a></div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00022">TrackerHit.h:22</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a037dbf33c23e4f394e56a71b8cb4e8ea"><div class="ttname"><a href="classTrackerHit.html#a037dbf33c23e4f394e56a71b8cb4e8ea">TrackerHit::getGlobalY</a></div><div class="ttdeci">double getGlobalY() const</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00053">TrackerHit.h:53</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a14249dd02874bf12134f0d5241912490"><div class="ttname"><a href="classTrackerHit.html#a14249dd02874bf12134f0d5241912490">TrackerHit::setLayer</a></div><div class="ttdeci">void setLayer(const int layer)</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00106">TrackerHit.h:106</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a17a9ca6d361f5e7cdc116c35d699e61f"><div class="ttname"><a href="classTrackerHit.html#a17a9ca6d361f5e7cdc116c35d699e61f">TrackerHit::getLayer</a></div><div class="ttdeci">int getLayer() const</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00109">TrackerHit.h:109</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a1c9289fa499243af8164eb1d851784a1"><div class="ttname"><a href="classTrackerHit.html#a1c9289fa499243af8164eb1d851784a1">TrackerHit::setVolume</a></div><div class="ttdeci">void setVolume(const int volume)</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00100">TrackerHit.h:100</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a2df57089ab769b31361900ffffb483a2"><div class="ttname"><a href="classTrackerHit.html#a2df57089ab769b31361900ffffb483a2">TrackerHit::addRawHit</a></div><div class="ttdeci">void addRawHit(TObject *rawhit)</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00115">TrackerHit.h:115</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a2f109bf8d5ff2fb4cd2693d7fe31bb70"><div class="ttname"><a href="classTrackerHit.html#a2f109bf8d5ff2fb4cd2693d7fe31bb70">TrackerHit::setCovarianceMatrix</a></div><div class="ttdeci">void setCovarianceMatrix(std::vector&lt; float &gt; cov)</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8cxx_source.html#l00070">TrackerHit.cxx:70</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a5f000855db408e735c6bc7ac6c39289c"><div class="ttname"><a href="classTrackerHit.html#a5f000855db408e735c6bc7ac6c39289c">TrackerHit::setID</a></div><div class="ttdeci">void setID(const int id)</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00122">TrackerHit.h:122</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a6b049fe81a135e2247c4eeffc615b86f"><div class="ttname"><a href="classTrackerHit.html#a6b049fe81a135e2247c4eeffc615b86f">TrackerHit::getRawHitStripNumbers</a></div><div class="ttdeci">std::vector&lt; int &gt; getRawHitStripNumbers()</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00130">TrackerHit.h:130</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a7ac3f940950e7982b3cce292c72e1a36"><div class="ttname"><a href="classTrackerHit.html#a7ac3f940950e7982b3cce292c72e1a36">TrackerHit::setRawHitStripNumbers</a></div><div class="ttdeci">void setRawHitStripNumbers(std::vector&lt; int &gt; rawhit_strips)</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00133">TrackerHit.h:133</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a8e6e66284ccad34ec77830cf93e421a5"><div class="ttname"><a href="classTrackerHit.html#a8e6e66284ccad34ec77830cf93e421a5">TrackerHit::setRawCharge</a></div><div class="ttdeci">void setRawCharge(const double rawcharge)</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00095">TrackerHit.h:95</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_a9c9659a6c6ba66b4107ba59c95a24241"><div class="ttname"><a href="classTrackerHit.html#a9c9659a6c6ba66b4107ba59c95a24241">TrackerHit::getID</a></div><div class="ttdeci">int getID() const</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00124">TrackerHit.h:124</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_aa0e4b074a508860d2898a0e2ff127d66"><div class="ttname"><a href="classTrackerHit.html#aa0e4b074a508860d2898a0e2ff127d66">TrackerHit::setCharge</a></div><div class="ttdeci">void setCharge(const double charge)</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00090">TrackerHit.h:90</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_aac9746ddc550ec176b0957affafbdbe7"><div class="ttname"><a href="classTrackerHit.html#aac9746ddc550ec176b0957affafbdbe7">TrackerHit::getVolume</a></div><div class="ttdeci">int getVolume()</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00103">TrackerHit.h:103</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_ac5d16fb092048cfea6230708bfe6d2f0"><div class="ttname"><a href="classTrackerHit.html#ac5d16fb092048cfea6230708bfe6d2f0">TrackerHit::getRawCharge</a></div><div class="ttdeci">double getRawCharge() const</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00098">TrackerHit.h:98</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_acb0ffd73929350f517aeba27c9463e7f"><div class="ttname"><a href="classTrackerHit.html#acb0ffd73929350f517aeba27c9463e7f">TrackerHit::setTime</a></div><div class="ttdeci">void setTime(const double time)</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00073">TrackerHit.h:73</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_ad48e43b6f028fcbbb9ad7e7f29b38c31"><div class="ttname"><a href="classTrackerHit.html#ad48e43b6f028fcbbb9ad7e7f29b38c31">TrackerHit::setPosition</a></div><div class="ttdeci">void setPosition(const double *position, bool rotate=false, int type=0)</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8cxx_source.html#l00023">TrackerHit.cxx:23</a></div></div>
<div class="ttc" id="aclassTrackerHit_html_afbffc04e39811037c7b7c79f29af16f5"><div class="ttname"><a href="classTrackerHit.html#afbffc04e39811037c7b7c79f29af16f5">TrackerHit::getTime</a></div><div class="ttdeci">double getTime() const</div><div class="ttdef"><b>Definition</b> <a href="TrackerHit_8h_source.html#l00083">TrackerHit.h:83</a></div></div>
<div class="ttc" id="aclassVertex_html"><div class="ttname"><a href="classVertex.html">Vertex</a></div><div class="ttdef"><b>Definition</b> <a href="Vertex_8h_source.html#l00022">Vertex.h:22</a></div></div>
<div class="ttc" id="aclassVertex_html_a1a189ebe733bd13292d9f3b7cece97c2"><div class="ttname"><a href="classVertex.html#a1a189ebe733bd13292d9f3b7cece97c2">Vertex::setPos</a></div><div class="ttdeci">void setPos(const float *pos, bool rotate=false)</div><div class="ttdef"><b>Definition</b> <a href="Vertex_8cxx_source.html#l00039">Vertex.cxx:39</a></div></div>
<div class="ttc" id="aclassVertex_html_a38718cd3b3eaea72e89eed3915035c95"><div class="ttname"><a href="classVertex.html#a38718cd3b3eaea72e89eed3915035c95">Vertex::setVtxParameters</a></div><div class="ttdeci">void setVtxParameters(const std::vector&lt; float &gt; &amp;parameters)</div><div class="ttdef"><b>Definition</b> <a href="Vertex_8cxx_source.html#l00081">Vertex.cxx:81</a></div></div>
<div class="ttc" id="aclassVertex_html_a5f000855db408e735c6bc7ac6c39289c"><div class="ttname"><a href="classVertex.html#a5f000855db408e735c6bc7ac6c39289c">Vertex::setID</a></div><div class="ttdeci">void setID(const int id)</div><div class="ttdef"><b>Definition</b> <a href="Vertex_8h_source.html#l00083">Vertex.h:83</a></div></div>
<div class="ttc" id="aclassVertex_html_a9d98a59d4453e8b71e36dff35da0ea8d"><div class="ttname"><a href="classVertex.html#a9d98a59d4453e8b71e36dff35da0ea8d">Vertex::setType</a></div><div class="ttdeci">void setType(const std::string &amp;type)</div><div class="ttdef"><b>Definition</b> <a href="Vertex_8h_source.html#l00080">Vertex.h:80</a></div></div>
<div class="ttc" id="aclassVertex_html_aa5fdb14072b54286239e89d73a49c073"><div class="ttname"><a href="classVertex.html#aa5fdb14072b54286239e89d73a49c073">Vertex::setProbability</a></div><div class="ttdeci">void setProbability(const float probability)</div><div class="ttdef"><b>Definition</b> <a href="Vertex_8h_source.html#l00092">Vertex.h:92</a></div></div>
<div class="ttc" id="aclassVertex_html_acdcc221127f2db7b58a83ad7832fa493"><div class="ttname"><a href="classVertex.html#acdcc221127f2db7b58a83ad7832fa493">Vertex::setCovariance</a></div><div class="ttdeci">void setCovariance(const std::vector&lt; float &gt; &amp;vec)</div><div class="ttdef"><b>Definition</b> <a href="Vertex_8cxx_source.html#l00035">Vertex.cxx:35</a></div></div>
<div class="ttc" id="aclassVertex_html_add635266c1cc210bb98622624a1e873f"><div class="ttname"><a href="classVertex.html#add635266c1cc210bb98622624a1e873f">Vertex::setChi2</a></div><div class="ttdeci">void setChi2(const double chi2)</div><div class="ttdef"><b>Definition</b> <a href="Vertex_8h_source.html#l00045">Vertex.h:45</a></div></div>
<div class="ttc" id="anamespaceCollections_html_ae402e358f3b61b9fab89667a956b5253"><div class="ttname"><a href="namespaceCollections.html#ae402e358f3b61b9fab89667a956b5253">Collections::TRACK_DATA</a></div><div class="ttdeci">constexpr const char * TRACK_DATA</div><div class="ttdef"><b>Definition</b> <a href="Collections_8h_source.html#l00041">Collections.h:41</a></div></div>
<div class="ttc" id="anamespaceutils_html_a0d15b32d30266551f22e870e6613f109"><div class="ttname"><a href="namespaceutils.html#a0d15b32d30266551f22e870e6613f109">utils::addRawInfoTo3dHit</a></div><div class="ttdeci">bool addRawInfoTo3dHit(TrackerHit *tracker_hit, IMPL::TrackerHitImpl *lc_tracker_hit, EVENT::LCCollection *raw_svt_fits, std::vector&lt; RawSvtHit * &gt; *rawHits=nullptr, int type=0, bool storeRawHit=true)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00440">utilities.cxx:440</a></div></div>
<div class="ttc" id="anamespaceutils_html_a2d01ad798936250108f868400e1e3051"><div class="ttname"><a href="namespaceutils.html#a2d01ad798936250108f868400e1e3051">utils::buildCalCluster</a></div><div class="ttdeci">CalCluster * buildCalCluster(EVENT::Cluster *lc_cluster)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00107">utilities.cxx:107</a></div></div>
<div class="ttc" id="anamespaceutils_html_a331cab836b576d7a988d81e008242528"><div class="ttname"><a href="namespaceutils.html#a331cab836b576d7a988d81e008242528">utils::buildTrack</a></div><div class="ttdeci">Track * buildTrack(EVENT::Track *lc_track, std::string trackstate_location, EVENT::LCCollection *gbl_kink_data, EVENT::LCCollection *track_data)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00158">utilities.cxx:158</a></div></div>
<div class="ttc" id="anamespaceutils_html_a38245351b04f5e711d627819b932fbd4"><div class="ttname"><a href="namespaceutils.html#a38245351b04f5e711d627819b932fbd4">utils::buildVertex</a></div><div class="ttdeci">Vertex * buildVertex(EVENT::Vertex *lc_vertex)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00031">utilities.cxx:31</a></div></div>
<div class="ttc" id="anamespaceutils_html_a3fa61a8f1fe762d57473f3193181a256"><div class="ttname"><a href="namespaceutils.html#a3fa61a8f1fe762d57473f3193181a256">utils::hasCollection</a></div><div class="ttdeci">bool hasCollection(EVENT::LCEvent *lc_event, const std::string &amp;collection)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00018">utilities.cxx:18</a></div></div>
<div class="ttc" id="anamespaceutils_html_a5e1646b6a827eb4b57b130766d574583"><div class="ttname"><a href="namespaceutils.html#a5e1646b6a827eb4b57b130766d574583">utils::isUsedByTrack</a></div><div class="ttdeci">bool isUsedByTrack(IMPL::TrackerHitImpl *lc_tracker_hit, EVENT::Track *lc_track)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00515">utilities.cxx:515</a></div></div>
<div class="ttc" id="anamespaceutils_html_a6bd5c589b49d0a2b2404965d82f7fe51"><div class="ttname"><a href="namespaceutils.html#a6bd5c589b49d0a2b2404965d82f7fe51">utils::buildTrackerHit</a></div><div class="ttdeci">TrackerHit * buildTrackerHit(IMPL::TrackerHitImpl *lc_trackerHit, bool rotate=true, int type=0)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00406">utilities.cxx:406</a></div></div>
<div class="ttc" id="anamespaceutils_html_a738247811cec3af04d9b6a7868aa8eb4"><div class="ttname"><a href="namespaceutils.html#a738247811cec3af04d9b6a7868aa8eb4">utils::getKalmanTrackL1Isolations</a></div><div class="ttdeci">double getKalmanTrackL1Isolations(Track *track, std::vector&lt; TrackerHit * &gt; *siClusters)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00566">utilities.cxx:566</a></div></div>
<div class="ttc" id="anamespaceutils_html_a7e5c97f6c3d48e86b50baaefeb659369"><div class="ttname"><a href="namespaceutils.html#a7e5c97f6c3d48e86b50baaefeb659369">utils::getParticlesFromVertex</a></div><div class="ttdeci">bool getParticlesFromVertex(Vertex *vtx, Particle *ele, Particle *pos)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00541">utilities.cxx:541</a></div></div>
<div class="ttc" id="anamespaceutils_html_a7f0793ae3975d895fb1306504c017110"><div class="ttname"><a href="namespaceutils.html#a7f0793ae3975d895fb1306504c017110">utils::buildParticle</a></div><div class="ttdeci">Particle * buildParticle(EVENT::ReconstructedParticle *lc_particle, std::string trackstate_location, EVENT::LCCollection *gbl_kink_data, EVENT::LCCollection *track_data)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00056">utilities.cxx:56</a></div></div>
<div class="ttc" id="anamespaceutils_html_aa54b8be934579198d0bcfed387562ee0"><div class="ttname"><a href="namespaceutils.html#aa54b8be934579198d0bcfed387562ee0">utils::v0_projection_to_target_significance</a></div><div class="ttdeci">double v0_projection_to_target_significance(json v0proj_fits, int run, double &amp;vtx_proj_x, double &amp;vtx_proj_y, double &amp;vtx_proj_x_signif, double &amp;vtx_proj_y_signif, double vtx_x, double vtx_y, double vtx_z, double vtx_px, double vtx_py, double vtx_pz)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00879">utilities.cxx:879</a></div></div>
<div class="ttc" id="anamespaceutils_html_ab32ee0dd27142e56bd20ad7d6c5ee592"><div class="ttname"><a href="namespaceutils.html#ab32ee0dd27142e56bd20ad7d6c5ee592">utils::get2016KFMCTruthHitCodes</a></div><div class="ttdeci">void get2016KFMCTruthHitCodes(Track *ele_trk, Track *pos_trk, int &amp;L1L2hitCode, int &amp;L1hitCode, int &amp;L2hitCode)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00675">utilities.cxx:675</a></div></div>
<div class="ttc" id="anamespaceutils_html_ac358ecc5a6e709ba4b0923fb312283d4"><div class="ttname"><a href="namespaceutils.html#ac358ecc5a6e709ba4b0923fb312283d4">utils::IsSameTrack</a></div><div class="ttdeci">bool IsSameTrack(Track *trk1, Track *trk2)</div><div class="ttdoc">description</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00143">utilities.cxx:143</a></div></div>
<div class="ttc" id="anamespaceutils_html_afd800cb48040eb2458c898be282a731c"><div class="ttname"><a href="namespaceutils.html#afd800cb48040eb2458c898be282a731c">utils::buildRawHit</a></div><div class="ttdeci">RawSvtHit * buildRawHit(EVENT::TrackerRawData *rawTracker_hit, EVENT::LCCollection *raw_svt_hit_fits)</div><div class="ttdef"><b>Definition</b> <a href="utilities_8cxx_source.html#l00340">utilities.cxx:340</a></div></div>
<div class="ttc" id="autilities_8h_html"><div class="ttname"><a href="utilities_8h.html">utilities.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
